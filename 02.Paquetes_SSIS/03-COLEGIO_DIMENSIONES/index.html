
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../02-TRANSVERSAL_FACT/">
      
      
        <link rel="next" href="../04-COLEGIO_FACT/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>03. COLEGIO_DIMENSIONES - COMFENALCO</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="23abf7" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#colegio_dimensiones" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="COMFENALCO" class="md-header__button md-logo" aria-label="COMFENALCO" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            COMFENALCO
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              03. COLEGIO_DIMENSIONES
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="COMFENALCO" class="md-nav__button md-logo" aria-label="COMFENALCO" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    COMFENALCO
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    00. INICIO
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            00. INICIO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    INTRODUCCIÓN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../instalacion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    INSTALACIÓN Y CONFIGURACIÓN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Conexiones_BD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CONEXIÓN A BASE DE DATOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../buenaspracticas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BUENAS PRÁCTICAS
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    01. SCRIPTS SQL
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            01. SCRIPTS SQL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.scripts/00.Inicio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introducción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.scripts/00.Eliminar_todo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    00. Eliminar Todo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.scripts/01.Transversal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01. Transversal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.scripts/02.Cedesarrollo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    02. Cedesarrollo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.scripts/03.Proteccion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    03. Proteccion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.scripts/04.Colegio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    04. Colegio
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    02. ESTRUCTURA SHAREPOINT
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            02. ESTRUCTURA SHAREPOINT
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04.sharepoint/estructura_sharepoint/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Estructura carpeta Sharepoint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04.sharepoint/estructura_archivos_actualizacion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Estructura Archivos Actualizacion
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    03. BI COMFENALCO
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            03. BI COMFENALCO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00.params/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduccion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00-SCRAPING/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    00. WEB SCRAPING
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01.TRANSVERSAL_DIMENSIONES/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01. TRANSVERSAL_DIMENSIONES
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-TRANSVERSAL_FACT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    02. TRANSVERSAL_FACT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    03. COLEGIO_DIMENSIONES
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    03. COLEGIO_DIMENSIONES
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#proposito-del-paquete" class="md-nav__link">
    <span class="md-ellipsis">
      Propósito del Paquete
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#descripcion-del-paquete" class="md-nav__link">
    <span class="md-ellipsis">
      Descripción del Paquete
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tablas-y-columnas-clave" class="md-nav__link">
    <span class="md-ellipsis">
      Tablas y Columnas Clave
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diagramas" class="md-nav__link">
    <span class="md-ellipsis">
      Diagramas
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Diagramas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-diagrama-de-flujo-de-datos" class="md-nav__link">
    <span class="md-ellipsis">
      1. Diagrama de Flujo de Datos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-diagrama-er-para-tablas-de-dimensiones" class="md-nav__link">
    <span class="md-ellipsis">
      2. Diagrama ER para Tablas de Dimensiones
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#componentes-clave-del-paquete" class="md-nav__link">
    <span class="md-ellipsis">
      Componentes Clave del Paquete
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Componentes Clave del Paquete">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#componente-poblar-dim_anio_academico" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Poblar DIM_ANIO_ACADEMICO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-dim_plan_curricular" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar DIM_PLAN_CURRICULAR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-truncar-tabla-temporal" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Truncar Tabla Temporal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-consulta-sap" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Consulta SAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-actualizar-dim_acudientes" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Actualizar DIM_ACUDIENTES
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-descargar_am-edf-153" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Descargar_AM-EDF-153
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-dim_libros" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar DIM_LIBROS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-validar-si-existe-tabla-para-guardar" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Validar si existe tabla para guardar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-crear-procedimiento-anual" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Crear procedimiento anual
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-COLEGIO_FACT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    04. COLEGIO_FACT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-CEDESARROLLO_DIMENSIONES/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    05. CEDESARROLLO_DIMENSIONES
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-CEDESARROLLO_FACT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    06. CEDESARROLLO_FACT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-PROTECCION_DIMENSIONES/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    07. PROTECCION_DIMENSIONES
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-PROTECCION_FACT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    08. PROTECCION_FACT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09-ETLS_CUBO/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    09. ETLS_CUBO
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    04. COMFENALCO EDUCACION
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            04. COMFENALCO EDUCACION
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    01 SCRIPTS
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            01 SCRIPTS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_00.Introduccion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introducción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2" id="__nav_5_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    01. Q10
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2">
            <span class="md-nav__icon md-icon"></span>
            01. Q10
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_1" id="__nav_5_1_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    0.1. Educación Tecnica
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_1">
            <span class="md-nav__icon md-icon"></span>
            0.1. Educación Tecnica
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/01.Docentes_Cedesarrollo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.1. Docentes Cedesarrollo.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/02.Disenio_curricular/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.2. Diseño Curricular.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/03.Listado_matriculas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.3. Listado Matrículas.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/04.Ingresos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.4. Ingresos.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/05.Historico_notas_Cedesarrollo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.5. Histórico notas.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/06.Egresados_graduados_Cedesarrollo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.6. Egresados.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/07.Desertores/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.7. Desertores.py
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2_2" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_2" id="__nav_5_1_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    0.2. Educación Continua
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_2">
            <span class="md-nav__icon md-icon"></span>
            0.2. Educación Continua
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.educacioncontinua/01.Docentes_desarrollo_empresarial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.1. Docentes Desarrollo Empresarial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.educacioncontinua/02.Preinscritos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.2. Preinscritos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.educacioncontinua/03.Listado_matriculas_emp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.3. Listado Matrículas Empresarial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.educacioncontinua/04.Consolidado_inasistencias/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.4. Consolidado Inasistencias
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.educacioncontinua/05.Estudiantes_inasistencias/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.5. Estudiantes Inasistencias
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.educacioncontinua/06.Egresados_graduados_empresarial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.6. Egresados Graduados Empresarial
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2_3" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_3" id="__nav_5_1_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Sharepoint
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_3">
            <span class="md-nav__icon md-icon"></span>
            Sharepoint
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_01_procesar_docentes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cede_01 procesar_docentes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_02_procesar_Dise%C3%B1o_Curricular/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cede_02 procesar_Diseño_Curricular
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_03_procesar_listado_matriculas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cede_03 procesar_listado_matriculas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_04_procesar_cede_Ingresos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cede_04 procesar_Ingresos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_05_cede_Historico_Notas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cede_05 cede_Historico_Notas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_06_cede_Egresados_Graduados/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cede_06 cede_Egresados_Graduados
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_07_Cancelados_Desertores/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cede_07 Cancelados Desertores
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/emp_01_Docentes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    emp_01 Docentes Empresarial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/emp_02_listado_matriculas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    emp_02 Listado Matrículas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/emp_03_preinscritos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    emp_03 Preinscritos Empresarial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/emp_04_egresados_Graduados/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    emp_04 Egresados Graduados
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/emp_05_Estudiantes_inasistencias/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    emp_05 Estudiantes Inasistencias
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/emp_06_consolidado_Inasistencias/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    emp_06 Consolidado Inasistencias
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3" >
        
          
          <label class="md-nav__link" for="__nav_5_1_3" id="__nav_5_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    02. C4C
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3">
            <span class="md-nav__icon md-icon"></span>
            02. C4C
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_02.C4C/01.C4C_webscraping_v4_Actualizable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.1. Webscraping Actualizable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_02.C4C/02.C4C_webscraping_v4_Historico/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.2. Webscraping Histórico
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_4" >
        
          
          <label class="md-nav__link" for="__nav_5_1_4" id="__nav_5_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Utils
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_4">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/Funciones/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Funciones.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/download/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Download.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/Funciones_DM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Funciones_DM.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/c4c_from_sharepoint/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    c4c_from_sharepoint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/dim_Estudiantes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dim_Estudiantes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/dim_periodo_academico/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dim_periodo_academico
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/fact_facturacion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fact_facturacion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/fact_graduados/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fact_graduados
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/fact_cotizacion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fact_cotizacion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/fact_listado_matriculas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fact_listado_matriculas
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    05. CUBO
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            05. CUBO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03.Cubo/00.Introduccion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introducción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03.Cubo/01.Origen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01. ORIGEN Y MEDIDAS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03.Cubo/02.Tablas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    02. TABLAS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03.Cubo/03.ETL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    03. ETL
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    06. POWER BI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            06. POWER BI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05.Power_BI/00.Introduccion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introducción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05.Power_BI/01.Dashboard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01. DASHBOARD
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#proposito-del-paquete" class="md-nav__link">
    <span class="md-ellipsis">
      Propósito del Paquete
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#descripcion-del-paquete" class="md-nav__link">
    <span class="md-ellipsis">
      Descripción del Paquete
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tablas-y-columnas-clave" class="md-nav__link">
    <span class="md-ellipsis">
      Tablas y Columnas Clave
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diagramas" class="md-nav__link">
    <span class="md-ellipsis">
      Diagramas
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Diagramas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-diagrama-de-flujo-de-datos" class="md-nav__link">
    <span class="md-ellipsis">
      1. Diagrama de Flujo de Datos
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-diagrama-er-para-tablas-de-dimensiones" class="md-nav__link">
    <span class="md-ellipsis">
      2. Diagrama ER para Tablas de Dimensiones
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#componentes-clave-del-paquete" class="md-nav__link">
    <span class="md-ellipsis">
      Componentes Clave del Paquete
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Componentes Clave del Paquete">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#componente-poblar-dim_anio_academico" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Poblar DIM_ANIO_ACADEMICO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-dim_plan_curricular" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar DIM_PLAN_CURRICULAR
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-truncar-tabla-temporal" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Truncar Tabla Temporal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-consulta-sap" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Consulta SAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-actualizar-dim_acudientes" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Actualizar DIM_ACUDIENTES
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-descargar_am-edf-153" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Descargar_AM-EDF-153
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-dim_libros" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar DIM_LIBROS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-validar-si-existe-tabla-para-guardar" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Validar si existe tabla para guardar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-crear-procedimiento-anual" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Crear procedimiento anual
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<!-- markdownlint-disable -->

<h1 id="colegio_dimensiones">COLEGIO_DIMENSIONES<a class="headerlink" href="#colegio_dimensiones" title="Permanent link">&para;</a></h1>
<p>El paquete SSIS <strong>"03-COLEGIO_DIMENSIONES"</strong> está diseñado para procesar, transformar y cargar información relacionada con dimensiones clave del ámbito educativo, tales como años académicos, planes curriculares, población matriculada y libros. Este paquete asegura un flujo de trabajo robusto y automatizado que consolida datos provenientes de múltiples fuentes, garantizando su calidad e integridad en el Data Warehouse <code>DWH_COMFENALCO</code>.</p>
<hr />
<h2 id="proposito-del-paquete">Propósito del Paquete<a class="headerlink" href="#proposito-del-paquete" title="Permanent link">&para;</a></h2>
<p>El propósito principal del paquete es estructurar y centralizar datos educativos críticos, asegurando su disponibilidad y consistencia para análisis estratégicos y toma de decisiones operativas.</p>
<hr />
<h2 id="descripcion-del-paquete">Descripción del Paquete<a class="headerlink" href="#descripcion-del-paquete" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Extracción de Datos</strong>:</p>
<ul>
<li>Fuentes principales:<ul>
<li><strong>Bases de Datos</strong>:</li>
<li><code>FACT_ESTADO_MATRICULAS</code>, <code>DIM_PLAN_CURRICULAR</code>, <code>DIM_LIBROS</code>, <code>DIM_POBLACION_MATRICULA</code>.</li>
<li><strong>Archivos Excel</strong>:</li>
<li>Información sobre libros (<code>AM-EDF-153</code>).</li>
</ul>
</li>
<li>Herramientas utilizadas:<ul>
<li>Conexiones ADO.NET y OLE DB para extracción y carga.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Transformación de Datos</strong>:</p>
<ul>
<li><strong>Búsquedas (<code>Lookup</code>)</strong>:<ul>
<li>Garantiza la consistencia mediante validaciones en tablas maestras como <code>DIM_PLAN_CURRICULAR</code> y <code>DIM_LIBROS</code>.</li>
</ul>
</li>
<li><strong>Conversión de Datos (<code>Data Conversion</code>)</strong>:<ul>
<li>Asegura compatibilidad con tablas destino.</li>
</ul>
</li>
<li><strong>Columnas Derivadas (<code>Derived Column</code>)</strong>:<ul>
<li>Genera claves auxiliares y valores predeterminados.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Carga de Datos en el Data Warehouse</strong>:</p>
<ul>
<li>Tablas procesadas:<ul>
<li><code>DIM_ANIO_ACADEMICO</code></li>
<li><code>DIM_PLAN_CURRICULAR</code></li>
<li><code>DIM_LIBROS</code></li>
<li><code>DIM_POBLACION_MATRICULA</code></li>
</ul>
</li>
<li>Configuración:<ul>
<li>Inserciones masivas habilitadas para maximizar el rendimiento.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Automatización y Scripts</strong>:</p>
<ul>
<li>Uso de scripts Python para automatizar tareas de descarga y validación.</li>
</ul>
</li>
</ol>
<h2 id="tablas-y-columnas-clave">Tablas y Columnas Clave<a class="headerlink" href="#tablas-y-columnas-clave" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>DIM_ANIO_ACADEMICO</strong>:</p>
<ul>
<li><code>ANIO_ACADEMICO</code>: Años académicos únicos extraídos de <code>FACT_ESTADO_MATRICULAS</code>.</li>
</ul>
</li>
<li>
<p><strong>DIM_PLAN_CURRICULAR</strong>:</p>
<ul>
<li><code>COD_ASIGNATURA_SAP</code>, <code>ANIO_ACADEMICO</code>, <code>ASIGNATURA</code>, <code>PLAN_ESTUDIOS</code>.</li>
</ul>
</li>
<li>
<p><strong>DIM_LIBROS</strong>:</p>
<ul>
<li><code>CODIGO_BARRAS</code>, <code>ITEM</code>, <code>TITULO</code>, <code>AUTOR</code>.</li>
</ul>
</li>
<li>
<p><strong>DIM_POBLACION_MATRICULA</strong>:</p>
<ul>
<li><code>ID_POBLACION_MATRICULA</code>, <code>PARTNER</code>, <code>DOCUMENTO</code>, <code>NOMBRE_COMPLETO</code>.</li>
</ul>
</li>
</ol>
<h2 id="diagramas">Diagramas<a class="headerlink" href="#diagramas" title="Permanent link">&para;</a></h2>
<h3 id="1-diagrama-de-flujo-de-datos">1. <strong>Diagrama de Flujo de Datos</strong><a class="headerlink" href="#1-diagrama-de-flujo-de-datos" title="Permanent link">&para;</a></h3>
<pre class="mermaid"><code>sequenceDiagram
    participant FACT as FACT_ESTADO_MATRICULAS
    participant PLAN as DIM_PLAN_CURRICULAR
    participant LIBROS as DIM_LIBROS
    participant POBLACION as DIM_POBLACION_MATRICULA

    FACT -&gt;&gt; PLAN: Validación de años académicos
    PLAN -&gt;&gt; DIM_PLAN_CURRICULAR: Transformación y carga
    LIBROS -&gt;&gt; DIM_LIBROS: Datos transformados
    POBLACION -&gt;&gt; DIM_POBLACION_MATRICULA: Inserción de datos</code></pre>
<h3 id="2-diagrama-er-para-tablas-de-dimensiones">2. <strong>Diagrama ER para Tablas de Dimensiones</strong><a class="headerlink" href="#2-diagrama-er-para-tablas-de-dimensiones" title="Permanent link">&para;</a></h3>
<pre class="mermaid"><code>erDiagram
    DIM_ANIO_ACADEMICO {
        int ANIO_ACADEMICO
    }
    DIM_PLAN_CURRICULAR {
        string COD_ASIGNATURA_SAP
        int ANIO_ACADEMICO
        string ASIGNATURA
        string PLAN_ESTUDIOS
    }
    DIM_LIBROS {
        string CODIGO_BARRAS
        string ITEM
        string TITULO
        string AUTOR
    }
    DIM_POBLACION_MATRICULA {
        int ID_POBLACION_MATRICULA
        string PARTNER
        string DOCUMENTO
        string NOMBRE_COMPLETO
    }
    DIM_ANIO_ACADEMICO ||--|| DIM_PLAN_CURRICULAR : "Relaciona años académicos"
    DIM_PLAN_CURRICULAR ||--|| DIM_LIBROS : "Relación con libros"
    DIM_LIBROS ||--|| DIM_POBLACION_MATRICULA : "Asociación de datos"</code></pre>
<h2 id="componentes-clave-del-paquete">Componentes Clave del Paquete<a class="headerlink" href="#componentes-clave-del-paquete" title="Permanent link">&para;</a></h2>
<h3 id="componente-poblar-dim_anio_academico">Componente <strong><code>Poblar DIM_ANIO_ACADEMICO</code></strong><a class="headerlink" href="#componente-poblar-dim_anio_academico" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general">Descripción General<a class="headerlink" href="#descripcion-general" title="Permanent link">&para;</a></h4>
<p>El componente <code>Poblar DIM_ANIO_ACADEMICO</code> es una tarea de flujo de datos en un paquete SSIS que se encarga de procesar y cargar datos en la tabla <code>DIM_ANIO_ACADEMICO</code>. Este flujo incluye procesos de extracción, transformación y carga (ETL) para garantizar datos limpios y estructurados en el Data Warehouse.</p>
<hr />
<h4 id="componentes-del-flujo-de-datos">Componentes del Flujo de Datos<a class="headerlink" href="#componentes-del-flujo-de-datos" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Fuente de Datos ADO.NET (<code>FACT_ESTADO_MATRICULAS</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Extrae datos desde la tabla <code>FACT_ESTADO_MATRICULAS</code> en el esquema <code>Colegio</code> para generar un conjunto de años académicos únicos.</li>
<li><strong>Propiedades</strong>:<ul>
<li><strong>Consulta SQL</strong>:
    <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="k">DISTINCT</span><span class="w"> </span><span class="p">[</span><span class="n">CA20_ANO_ACADEMICO</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ANIO_ACADEMICO</span><span class="w"> </span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">FACT_ESTADO_MATRICULAS</span><span class="p">]</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="p">[</span><span class="n">CA20_ANO_ACADEMICO</span><span class="p">]</span><span class="w"> </span><span class="k">ASC</span>
</code></pre></div></li>
<li><strong>Tiempo de espera</strong>: <code>30 segundos</code>.</li>
<li><strong>Permitir conversión implícita de cadenas</strong>: <code>true</code>.</li>
</ul>
</li>
<li><strong>Conexión</strong>: <code>Project.ConnectionManagers[DWH_COMFENALCO]</code>.</li>
<li><strong>Columnas de Salida</strong>:<ul>
<li><code>ANIO_ACADEMICO</code> (Tipo: Numeric, Precisión: 4).</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Búsqueda (<code>Lookup</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Realiza una búsqueda en la tabla <code>DIM_ANIO_ACADEMICO</code> para determinar si un registro ya existe.</li>
<li><strong>Propiedades</strong>:<ul>
<li><strong>Consulta SQL</strong>:
    <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_ANIO_ACADEMICO</span><span class="p">]</span>
</code></pre></div></li>
<li><strong>Comportamiento para filas sin coincidencias</strong>: Enviar filas a la salida sin coincidencias.</li>
<li><strong>Porcentaje de caché para filas sin coincidencias</strong>: <code>0%</code>.</li>
</ul>
</li>
<li><strong>Conexión</strong>: <code>Project.ConnectionManagers[DWH_COMFENALCO_Destino_OLEDB]</code>.</li>
<li><strong>Columnas de Entrada</strong>:<ul>
<li><code>ANIO_ACADEMICO</code>.</li>
</ul>
</li>
<li><strong>Columnas de Salida</strong>:<ul>
<li><code>ANIO_ACADEMICO</code> (Coincidencias y sin coincidencias).</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>División Condicional (<code>Conditional Split</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Separa los registros en diferentes flujos de datos según la existencia de coincidencias en el paso de búsqueda.</li>
<li><strong>Condiciones</strong>:<ul>
<li><code>Agregar</code>: Filas donde <code>ANIO_ACADEMICO</code> es nulo (filas nuevas).</li>
<li><code>Ya incluido</code>: Filas donde <code>ANIO_ACADEMICO</code> ya existe.</li>
<li><code>Conditional Split Error Output</code>: Filas con errores o problemas.</li>
</ul>
</li>
<li><strong>Expresión de condición</strong>:
    <div class="highlight"><pre><span></span><code><span class="k">ISNULL</span><span class="p">(</span><span class="n">Lookup</span><span class="p">.</span><span class="n">ANIO_ACADEMICO</span><span class="p">)</span>
</code></pre></div></li>
</ul>
</li>
<li><strong>Destino de Datos ADO.NET (<code>DIM_ANIO_ACADEMICO</code>)</strong><ul>
<li><strong>Descripción</strong>: Carga los registros nuevos en la tabla <code>DIM_ANIO_ACADEMICO</code>.</li>
<li><strong>Propiedades</strong>:<ul>
<li><strong>Tabla de destino</strong>: <code>"Colegio"."DIM_ANIO_ACADEMICO"</code>.</li>
<li><strong>Tamaño del lote</strong>: <code>0</code> (por defecto).</li>
<li><strong>Tiempo de espera</strong>: <code>30 segundos</code>.</li>
<li><strong>Inserción masiva</strong>: Activada.</li>
</ul>
</li>
<li><strong>Conexión</strong>: <code>Project.ConnectionManagers[DWH_COMFENALCO_Destino]</code>.</li>
<li><strong>Columnas de Entrada</strong>:<ul>
<li><code>ANIO_ACADEMICO</code>.</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="componente-procesar-dim_plan_curricular">Componente <strong><code>Procesar DIM_PLAN_CURRICULAR</code></strong><a class="headerlink" href="#componente-procesar-dim_plan_curricular" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_1">Descripción General<a class="headerlink" href="#descripcion-general_1" title="Permanent link">&para;</a></h4>
<p>El componente <code>DIM_PLAN_CURRICULAR</code> es una tarea de flujo de datos en un paquete SSIS que procesa información relacionada con el plan curricular de asignaturas. Este flujo realiza operaciones de extracción, transformación y carga (ETL) para consolidar los datos desde un sistema fuente hacia una base de datos destino.</p>
<hr />
<h4 id="componentes-del-flujo-de-datos_1">Componentes del Flujo de Datos<a class="headerlink" href="#componentes-del-flujo-de-datos_1" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Fuente de Datos ADO.NET (<code>PLAN_CURRICULAR SAP</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Este componente extrae datos desde el sistema SAP ERP, relacionado con asignaturas y planes de estudio.</li>
<li><strong>Propiedades</strong>:<ul>
<li><strong>Consulta SQL</strong>:
  <div class="highlight"><pre><span></span><code><span class="k">WITH</span><span class="w"> </span><span class="n">Curriculum</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="k">SELECT</span>
<span class="w">    </span><span class="n">objid</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ID_PLAN_ESTUDIOS</span><span class="p">,</span>
<span class="w">    </span><span class="k">CASE</span>
<span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">objid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;02000000&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;PREESCOLAR&#39;</span>
<span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">objid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;02000001&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;PRIMARIA&#39;</span>
<span class="w">        </span><span class="k">WHEN</span><span class="w"> </span><span class="n">objid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;02000003&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;BASICA/MEDIA SECUNDARIA&#39;</span>
<span class="w">        </span><span class="k">ELSE</span><span class="w"> </span><span class="s1">&#39;OTROS&#39;</span>
<span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PLAN_ESTUDIOS</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">HRP1000</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">plvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;01&#39;</span><span class="w"> </span><span class="c1">-- Plan activos</span>
<span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">Otype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;SC&#39;</span><span class="w"> </span><span class="c1">-- Plan de estudios</span>
<span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="n">langu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;S&#39;</span><span class="w"> </span><span class="c1">-- Español</span>
<span class="p">),</span>
<span class="n">Subjects</span><span class="w"> </span><span class="k">as</span><span class="p">(</span>
<span class="k">SELECT</span>
<span class="w">  </span><span class="n">a</span><span class="p">.</span><span class="n">objid</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">OBJETO_SAP_ASIGNATURA</span><span class="p">,</span>
<span class="w">  </span><span class="n">a</span><span class="p">.</span><span class="n">sobid</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ID_PLAN_ESTUDIOS</span><span class="p">,</span>
<span class="w">  </span><span class="n">b</span><span class="p">.</span><span class="n">peryr</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ANIO_ACADEMICO</span>
<span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">HRP1001</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">a</span>
<span class="w"> </span><span class="k">INNER</span><span class="w"> </span><span class="k">join</span>
<span class="w">  </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">HRP1739</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">On</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">otype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">otype</span><span class="w"> </span><span class="k">AND</span><span class="w">  </span><span class="n">A</span><span class="p">.</span><span class="n">objid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">objid</span>
<span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">plvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;01&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="c1">--“Plan activo</span>
<span class="w">  </span><span class="n">A</span><span class="p">.</span><span class="n">otype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;SM&#39;</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="c1">--“Estudios</span>
<span class="w">  </span><span class="n">a</span><span class="p">.</span><span class="n">sclas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;SC&#39;</span><span class="w"> </span><span class="k">and</span>
<span class="w">  </span><span class="c1">--a.sobid = PE and --(Parámetros)</span>
<span class="w">  </span><span class="n">b</span><span class="p">.</span><span class="n">peryr</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="c1">--(Parámetro</span>
<span class="w">  </span><span class="n">b</span><span class="p">.</span><span class="n">perid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;001&#39;</span><span class="c1">-- “Per. Comfenalco</span>
<span class="p">),</span>
<span class="n">CurriculumDetails</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="k">Select</span>
<span class="w">  </span><span class="n">aclevelvar</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PROGRAMA_PLAN_ESTUDIOS</span>
<span class="w"> </span><span class="k">From</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">HRP1730</span>
<span class="w"> </span><span class="k">Where</span><span class="w"> </span><span class="n">plvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;01&#39;</span>
<span class="p">),</span>
<span class="n">SubjectDetails</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w"> </span><span class="k">SELECT</span>
<span class="w">  </span><span class="n">objid</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">OBJETO_SAP_ASIGNATURA</span><span class="p">,</span>
<span class="w">  </span><span class="n">short</span><span class="p">,</span>
<span class="w">  </span><span class="n">stext</span><span class="p">,</span>
<span class="w">  </span><span class="c1">--*,</span>
<span class="w">  </span><span class="k">CASE</span>
<span class="w">    </span><span class="k">WHEN</span><span class="w"> </span><span class="k">SUBSTRING</span><span class="p">(</span><span class="n">SHORT</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;01&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;02&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;03&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;04&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;05&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;06&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;07&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;08&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;09&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;10&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;11&#39;</span><span class="p">,</span><span class="s1">&#39;JD&#39;</span><span class="p">,</span><span class="s1">&#39;PJ&#39;</span><span class="p">,</span><span class="s1">&#39;TR&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="w">        </span><span class="k">CASE</span><span class="w"> </span><span class="k">SUBSTRING</span><span class="p">(</span><span class="n">SHORT</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;01&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;02&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">2</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;03&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">3</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;04&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">4</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;05&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">5</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;06&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">6</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;07&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">10</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;08&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">11</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;09&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">12</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;10&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">13</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;11&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">14</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;JD&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">7</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;PJ&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">8</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;TR&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">9</span>
<span class="w">        </span><span class="k">END</span>
<span class="w">    </span><span class="k">ELSE</span><span class="w"> </span><span class="s1">&#39;-1&#39;</span>
<span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ID_CURSO</span><span class="p">,</span>
<span class="k">CASE</span>
<span class="w">    </span><span class="k">WHEN</span><span class="w"> </span><span class="k">SUBSTRING</span><span class="p">(</span><span class="n">SHORT</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;01&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;02&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;03&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;04&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;05&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;06&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;07&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;08&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;09&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;10&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;11&#39;</span><span class="p">,</span><span class="s1">&#39;JD&#39;</span><span class="p">,</span><span class="s1">&#39;PJ&#39;</span><span class="p">,</span><span class="s1">&#39;TR&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="w">        </span><span class="k">CASE</span><span class="w"> </span><span class="k">SUBSTRING</span><span class="p">(</span><span class="n">SHORT</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;01&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;PRIMERO&#39;</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;02&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;SEGUNDO&#39;</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;03&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;TERCERO&#39;</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;04&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;CUARTO&#39;</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;05&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;QUINTO&#39;</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;06&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;SEXTO&#39;</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;07&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;SEPTIMO&#39;</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;08&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;OCTAVO&#39;</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;09&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;NOVENO&#39;</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;10&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;DECIMO&#39;</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;11&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;ONCE&#39;</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;JD&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;PREJARDÍN&#39;</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;PJ&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;JARDÍN&#39;</span>
<span class="w">            </span><span class="k">WHEN</span><span class="w"> </span><span class="s1">&#39;TR&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;TRANSICIÓN&#39;</span>
<span class="w">        </span><span class="k">END</span>
<span class="w">    </span><span class="k">ELSE</span><span class="w"> </span><span class="s1">&#39;TRANSVERSAL&#39;</span>
<span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">CURSO</span>
<span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">hrp1000</span>
<span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">otype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;SM&#39;</span>
<span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">plvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;01&#39;</span>
<span class="p">)</span>
<span class="k">SELECT</span>
<span class="n">sd</span><span class="p">.</span><span class="n">short</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">COD_ASIGNATURA_SAP</span><span class="p">,</span>
<span class="n">s</span><span class="p">.</span><span class="n">ANIO_ACADEMICO</span><span class="p">,</span>
<span class="n">s</span><span class="p">.</span><span class="n">OBJETO_SAP_ASIGNATURA</span><span class="p">,</span>
<span class="n">sd</span><span class="p">.</span><span class="n">stext</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ASIGNATURA</span><span class="p">,</span>
<span class="n">sd</span><span class="p">.</span><span class="n">ID_CURSO</span><span class="p">,</span>
<span class="c1">--sd.CURSO,</span>
<span class="n">s</span><span class="p">.</span><span class="n">ID_PLAN_ESTUDIOS</span><span class="p">,</span>
<span class="k">c</span><span class="p">.</span><span class="n">PLAN_ESTUDIOS</span><span class="p">,</span>
<span class="n">sd</span><span class="p">.</span><span class="n">short</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">ANIO_ACADEMICO</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ID_ASIGNATURA_AUXILIAR</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">Subjects</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">s</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">Curriculum</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">c</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">ID_PLAN_ESTUDIOS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">c</span><span class="p">.</span><span class="n">ID_PLAN_ESTUDIOS</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">SubjectDetails</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">sd</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">OBJETO_SAP_ASIGNATURA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sd</span><span class="p">.</span><span class="n">OBJETO_SAP_ASIGNATURA</span>
<span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">ANIO_ACADEMICO</span><span class="p">,</span><span class="n">sd</span><span class="p">.</span><span class="n">short</span>
</code></pre></div></li>
<li><strong>Tiempo de espera</strong>: <code>30 segundos</code>.</li>
</ul>
</li>
<li><strong>Conexión</strong>: <code>Project.ConnectionManagers[SAP_ERP]</code>.</li>
<li><strong>Columnas de Salida</strong>:<ul>
<li><code>COD_ASIGNATURA_SAP</code></li>
<li><code>ANIO_ACADEMICO</code></li>
<li><code>OBJETO_SAP_ASIGNATURA</code></li>
<li><code>ASIGNATURA</code></li>
<li><code>ID_CURSO</code></li>
<li><code>ID_PLAN_ESTUDIOS</code></li>
<li><code>PLAN_ESTUDIOS</code></li>
<li><code>ID_ASIGNATURA_AUXILIAR</code>.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Transformación de Datos (<code>Data Conversion</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Convierte los tipos de datos de las columnas de entrada para garantizar la compatibilidad con las transformaciones posteriores.</li>
<li><strong>Columnas Convertidas</strong>:<ul>
<li><code>COD_ASIGNATURA_SAP</code> → <code>Copy of COD_ASIGNATURA_SAP</code></li>
<li><code>ANIO_ACADEMICO</code> → <code>Copy of ANIO_ACADEMICO</code></li>
<li><code>OBJETO_SAP_ASIGNATURA</code> → <code>Copy of OBJETO_SAP_ASIGNATURA</code></li>
<li><code>ASIGNATURA</code> → <code>Copy of ASIGNATURA</code></li>
<li><code>ID_CURSO</code> → <code>Copy of ID_CURSO</code></li>
<li><code>ID_PLAN_ESTUDIOS</code> → <code>Copy of ID_PLAN_ESTUDIOS</code></li>
<li><code>PLAN_ESTUDIOS</code> → <code>Copy of PLAN_ESTUDIOS</code></li>
<li><code>ID_ASIGNATURA_AUXILIAR</code> → <code>Copy of ID_ASIGNATURA_AUXILIAR</code>.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Búsqueda (<code>Lookup</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Realiza una comparación de los datos con la tabla <code>DIM_PLAN_CURRICULAR</code> para enriquecer los datos en el flujo de trabajo.</li>
<li><strong>Propiedades</strong>:<ul>
<li><strong>Consulta SQL</strong>:
  <div class="highlight"><pre><span></span><code><span class="k">SELECT</span>
<span class="w">    </span><span class="p">[</span><span class="n">ID_ASIGNATURA</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">COD_ASIGNATURA_SAP</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">ANIO_ACADEMICO</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">COD_ASIGNATURA_SAP</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">CAST</span><span class="p">([</span><span class="n">ANIO_ACADEMICO</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">NVARCHAR</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ID_ASIGNATURA_AUXILIAR</span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_PLAN_CURRICULAR</span><span class="p">]</span>
</code></pre></div></li>
<li><strong>Comportamiento para filas sin coincidencias</strong>: Enviar a la salida "No Match Output".</li>
</ul>
</li>
<li><strong>Conexión</strong>: <code>Project.ConnectionManagers[DWH_COMFENALCO_Destino_OLEDB]</code>.</li>
<li><strong>Columnas de Entrada</strong>:<ul>
<li><code>Copy of ID_ASIGNATURA_AUXILIAR</code>.</li>
</ul>
</li>
<li><strong>Columnas de Salida</strong>:<ul>
<li><code>ID_ASIGNATURA</code></li>
<li><code>COD_ASIGNATURA_SAP</code></li>
<li><code>ANIO_ACADEMICO</code></li>
<li><code>ID_ASIGNATURA_AUXILIAR</code>.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Destino de Datos ADO.NET (<code>DIM_PLAN_CURRICULAR</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Carga los datos transformados en la tabla <code>DIM_PLAN_CURRICULAR</code> dentro del esquema <code>Colegio</code> en el Data Warehouse.</li>
<li><strong>Propiedades</strong>:<ul>
<li><strong>Tabla de Destino</strong>: <code>"Colegio"."DIM_PLAN_CURRICULAR"</code>.</li>
<li><strong>Tamaño del Lote</strong>: <code>0</code>.</li>
<li><strong>Tiempo de Espera</strong>: <code>30 segundos</code>.</li>
<li><strong>Inserción Masiva</strong>: Activado (<code>UseBulkInsertWhenPossible</code>).</li>
</ul>
</li>
<li><strong>Conexión</strong>: <code>Project.ConnectionManagers[DWH_COMFENALCO_Destino]</code>.</li>
<li><strong>Columnas de Entrada</strong>:<ul>
<li><code>COD_ASIGNATURA_SAP</code></li>
<li><code>ANIO_ACADEMICO</code></li>
<li><code>OBJETO_SAP_ASIGNATURA</code></li>
<li><code>ASIGNATURA</code></li>
<li><code>ID_CURSO</code></li>
<li><code>ID_PLAN_ESTUDIOS</code></li>
<li><code>PLAN_ESTUDIOS</code>.</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="diagrama-de-secuencia">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant AdoNetSource as PLAN_CURRICULAR SAP
    participant DataConversion as Data Conversion
    participant Lookup as Lookup
    participant AdoNetDestination as DIM_PLAN_CURRICULAR

    AdoNetSource -&gt;&gt; DataConversion: Salida de origen de ADO NET
    DataConversion -&gt;&gt; Lookup: Data Conversion Output
    Lookup -&gt;&gt; AdoNetDestination: Lookup No Match Output</code></pre>
<h3 id="componente-truncar-tabla-temporal">Componente <strong><code>Truncar Tabla Temporal</code></strong><a class="headerlink" href="#componente-truncar-tabla-temporal" title="Permanent link">&para;</a></h3>
<p>Este componente es una tarea de ejecución de SQL (Execute SQL Task) en el paquete SSIS, diseñada para limpiar la tabla temporal utilizada en el proceso ETL del módulo de Acudientes. Su función principal es eliminar todos los registros de la tabla <code>[STAGE_AREA].[Transversal].[TMP_ACUDIENTES_SAP]</code> antes de iniciar la carga de nuevos datos.</p>
<hr />
<h5 id="proposito-del-componente">Propósito del Componente<a class="headerlink" href="#proposito-del-componente" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p><strong>Limpieza de Datos:</strong><br />
  El objetivo principal es vaciar la tabla temporal para eliminar registros residuales de ejecuciones anteriores, garantizando que la nueva carga de datos se realice sobre una tabla limpia.</p>
</li>
<li>
<p><strong>Garantizar la Integridad:</strong><br />
  Al eliminar todos los datos anteriores, se evita la mezcla de información vieja y nueva, lo que contribuye a mantener la precisión y consistencia en el proceso ETL.</p>
</li>
</ul>
<hr />
<h5 id="descripcion-tecnica">Descripción Técnica<a class="headerlink" href="#descripcion-tecnica" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p><strong>Tipo de Tarea:</strong><br />
  Execute SQL Task.</p>
</li>
<li>
<p><strong>Propiedades Clave:</strong></p>
<ul>
<li><strong>SQL Statement:</strong><br />
  <div class="highlight"><pre><span></span><code><span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">STAGE_AREA</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">TMP_ACUDIENTES_SAP</span><span class="p">]</span>
</code></pre></div></li>
<li><strong>Conexión:</strong><br />
  Se utiliza una conexión preconfigurada identificada por el GUID <code>{5972EC76-2533-4771-BB68-A92E1CDD645D}</code>, que apunta a la base de datos de destino.</li>
</ul>
</li>
<li>
<p><strong>Datos del Objeto:</strong></p>
</li>
<li><strong>Conexión Utilizada:</strong><br />
<code>{5972EC76-2533-4771-BB68-A92E1CDD645D}</code></li>
<li><strong>Sentencia SQL (código):</strong><br />
    <div class="highlight"><pre><span></span><code><span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">STAGE_AREA</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">TMP_ACUDIENTES_SAP</span><span class="p">]</span>
</code></pre></div></li>
</ul>
<hr />
<h5 id="flujo-de-ejecucion">Flujo de Ejecución<a class="headerlink" href="#flujo-de-ejecucion" title="Permanent link">&para;</a></h5>
<ol>
<li>
<p><strong>Inicio de la Tarea:</strong><br />
   Al iniciar el paquete SSIS, se ejecuta la tarea de SQL correspondiente.</p>
</li>
<li>
<p><strong>Ejecución de la Sentencia SQL:</strong><br />
   La sentencia <code>TRUNCATE TABLE [STAGE_AREA].[Transversal].[TMP_ACUDIENTES_SAP]</code> se envía a la base de datos mediante el administrador de conexiones configurado.</p>
</li>
<li>
<p><strong>Limpieza de la Tabla:</strong><br />
   La tabla temporal se vacía de forma rápida y eficiente, sin registrar individualmente cada eliminación, lo que mejora el rendimiento.</p>
</li>
<li>
<p><strong>Finalización de la Tarea:</strong><br />
   Una vez completada la operación, la tarea finaliza, permitiendo que el proceso ETL continúe con las etapas siguientes de carga y transformación.</p>
</li>
</ol>
<hr />
<h5 id="diagrama-de-secuencia_1">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia_1" title="Permanent link">&para;</a></h5>
<pre class="mermaid"><code>sequenceDiagram
    participant SQLTask as Truncar Tabla Temporal
    participant DB as Base de Datos

    SQLTask -&gt;&gt; DB: Ejecuta "TRUNCATE TABLE [STAGE_AREA].[Transversal].[TMP_ACUDIENTES_SAP]"
    DB --&gt;&gt; SQLTask: Confirmación de limpieza</code></pre>
<h3 id="componente-consulta-sap">Componente <strong><code>Consulta SAP</code></strong><a class="headerlink" href="#componente-consulta-sap" title="Permanent link">&para;</a></h3>
<p>Este componente es una tarea de flujo de datos (Data Flow Task) dentro del paquete SSIS, diseñada para extraer y consolidar datos provenientes del sistema SAP. Utiliza una consulta SQL compleja (con múltiples CTE) para obtener información detallada de los acudientes y estudiantes, integrando datos de diversas tablas de SAP y enriqueciendo la información mediante cálculos y conversiones. La salida de este componente se utiliza para alimentar procesos de integración posteriores en el flujo ETL.</p>
<hr />
<h5 id="proposito-del-componente_1">Propósito del Componente<a class="headerlink" href="#proposito-del-componente_1" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p><strong>Extracción de Datos desde SAP:</strong><br />
  Recuperar información relevante de acudientes y estudiantes a partir de múltiples fuentes de datos en el sistema SAP. Esto incluye datos personales, detalles de contactos (teléfonos, direcciones y correos electrónicos) y claves de identificación para su posterior vinculación en el proceso ETL.</p>
</li>
<li>
<p><strong>Consolidación y Enriquecimiento:</strong><br />
  Unir y transformar datos mediante CTEs para combinar información de tablas como HRP1001, BUT000, y otras, integrando además datos de contactos recientes (teléfonos, direcciones y emails) y claves de estudiantes. Esto permite obtener un dataset completo que relaciona la información de acudientes con la de estudiantes y sus datos asociados.</p>
</li>
</ul>
<hr />
<h5 id="descripcion-tecnica_1">Descripción Técnica<a class="headerlink" href="#descripcion-tecnica_1" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p><strong>Tipo de Tarea:</strong><br />
  Data Flow Task (Pipeline).</p>
</li>
<li>
<p><strong>Propiedades Clave:</strong></p>
<ul>
<li><strong>SQL Command:</strong><br />
  Se utiliza una instrucción SQL avanzada que emplea Common Table Expressions (CTE) para:</li>
<li><strong>PartnerDetails:</strong> Extraer detalles del acudiente, incluyendo datos personales, estado civil, profesión y fecha de nacimiento.  </li>
<li><strong>RecentPhones, RecentAddresses y RecentEmails:</strong> Obtener la información de contacto más reciente para cada acudiente.  </li>
<li><strong>StudentKeys:</strong> Relacionar el acudiente con el estudiante mediante claves SAP.</li>
</ul>
<p>La consulta finaliza uniendo estos conjuntos de datos para producir un resultado consolidado con campos tales como:
  - <code>BP_ACUDIENTE</code>, <code>OBJETO_SAP_ESTUDIANTE</code>, <code>BP_ESTUDIANTE</code>, <code>NUMERO_MATRICULA</code>
  - <code>TIPO_DOCUMENTO</code>, <code>NUMERO_DOCUMENTO</code>
  - <code>PRIMER_APELLIDO</code>, <code>SEGUNDO_APELLIDO</code>, <code>PRIMER_NOMBRE</code>, <code>SEGUNDO_NOMBRE</code>
  - <code>GENERO</code>, <code>ESTADO_CIVIL</code>, <code>PROFESION</code>, <code>FECHA_NACIMIENTO</code>
  - <code>PARENTESCO</code>, <code>RESPONSABLE_JURIDICO</code>
  - <code>TELEFONO</code>, <code>PAIS</code>, <code>CIUDAD</code>, <code>DIRECCION</code>, <code>CORREO</code></p>
</li>
<li>
<p><strong>Datos del Objeto:</strong></p>
<ul>
<li><strong>Conexión Utilizada:</strong><br />
  Se conecta al sistema SAP a través del administrador de conexiones configurado con el identificador de conexión <code>{3A7D3F89-902D-4694-893E-02F1E08B0F72}</code> y el nombre de conexión <code>SAP_ERP</code>.</li>
<li><strong>Modo de Acceso:</strong><br />
  Utiliza el proveedor de datos .NET (DataReaderSourceAdapter) para ejecutar la consulta y extraer el conjunto de resultados.</li>
</ul>
</li>
</ul>
<hr />
<h5 id="flujo-de-ejecucion_1">Flujo de Ejecución<a class="headerlink" href="#flujo-de-ejecucion_1" title="Permanent link">&para;</a></h5>
<ol>
<li>
<p><strong>Inicio de la Tarea:</strong><br />
   El componente inicia la ejecución de la consulta SQL definida en la propiedad <code>SqlCommand</code>.</p>
</li>
<li>
<p><strong>Extracción y Transformación:</strong><br />
   La consulta se ejecuta contra el sistema SAP y, mediante el uso de CTEs, extrae y transforma los datos, uniendo información de diferentes orígenes (detalles del acudiente, datos de contacto y claves de estudiante).</p>
</li>
<li>
<p><strong>Salida de Datos:</strong><br />
   El conjunto de resultados, con las columnas transformadas y consolidadas, se expone en la salida del componente ("Salida de origen de ADO NET"), que posteriormente alimenta otros procesos o destinos dentro del flujo ETL.</p>
</li>
</ol>
<hr />
<h5 id="diagrama-de-secuencia_2">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia_2" title="Permanent link">&para;</a></h5>
<pre class="mermaid"><code>sequenceDiagram
    participant SAPData as Componente ACUDIENTES SAP
    participant SAP as Sistema SAP (ERP)
    participant Dest as Destino de datos (TMP_ACUDIENTES_SAP)

    SAPData -&gt;&gt; SAP: Ejecuta consulta SQL consolidada
    SAP --&gt;&gt; SAPData: Retorna conjunto de resultados con datos de acudientes y estudiantes
    SAPData -&gt;&gt; Dest: Transfiere datos transformados para carga posterior</code></pre>
<h3 id="componente-actualizar-dim_acudientes">Componente <strong><code>Actualizar DIM_ACUDIENTES</code></strong><a class="headerlink" href="#componente-actualizar-dim_acudientes" title="Permanent link">&para;</a></h3>
<p>Este componente es una tarea de flujo de datos (Data Flow Task) dentro del paquete SSIS, diseñada para actualizar la dimensión de acudientes en el ámbito Colegio. Su función principal es leer los datos consolidados en la tabla temporal de staging (<code>TMP_ACUDIENTES_SAP</code>), compararlos con la dimensión existente (<code>DIM_ACUDIENTES</code>) y cargar únicamente los registros nuevos o actualizados en la tabla de destino. Esto garantiza la integridad y actualización de la información de acudientes en el Data Warehouse.</p>
<hr />
<h5 id="proposito-del-componente_2">Propósito del Componente<a class="headerlink" href="#proposito-del-componente_2" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p><strong>Integración de Datos de Acudientes:</strong><br />
  Actualizar la dimensión <code>DIM_ACUDIENTES</code> en el esquema Colegio, asegurándose de que sólo se inserten los registros nuevos o modificados que no estén ya presentes en la dimensión. Esto permite mantener una base de datos actualizada y libre de duplicidades.</p>
</li>
<li>
<p><strong>Validación y Consolidación de la Información:</strong><br />
  El proceso realiza una comparación entre los datos provenientes de la tabla temporal en staging y la dimensión existente para filtrar registros ya cargados, permitiendo la actualización sólo de la información faltante o modificada.</p>
</li>
</ul>
<hr />
<h5 id="descripcion-tecnica_2">Descripción Técnica<a class="headerlink" href="#descripcion-tecnica_2" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p><strong>Tipo de Tarea:</strong><br />
  Data Flow Task.</p>
</li>
<li>
<p><strong>Propiedades Clave:</strong></p>
<ul>
<li><strong>Destino de ADO NET:</strong><br />
  Se utiliza un componente de destino ADO.NET para cargar los registros en la tabla de destino.</li>
<li><strong>TableOrViewName:</strong><br />
    La tabla destino se define mediante la expresión:
    <div class="highlight"><pre><span></span><code>&quot;Colegio&quot;.&quot;DIM_ACUDIENTES&quot;
</code></pre></div></li>
<li><strong>BatchSize:</strong><br />
    Se configura a <code>0</code>, utilizando el tamaño del búfer interno de SSIS.</li>
<li><strong>CommandTimeout:</strong><br />
    Establecido en <code>30</code> segundos.</li>
<li><strong>UseBulkInsertWhenPossible:</strong><br />
    Activado para mejorar el rendimiento durante la inserción masiva de datos.</li>
</ul>
</li>
<li>
<p><strong>Conexión:</strong><br />
    La tarea se conecta a la base de datos destino mediante el administrador de conexiones configurado con el identificador <code>{C2A27DDB-56C2-4889-8A4B-7AA7124DFFD7}</code> y el nombre de conexión <code>DWH_COMFENALCO_Destino</code>.</p>
</li>
<li>
<p><strong>Origen de Datos:</strong><br />
    El componente extrae los datos desde la tabla temporal <code>[STAGE_AREA].[Transversal].[TMP_ACUDIENTES_SAP]</code> mediante un origen ADO.NET. La consulta de origen realiza un LEFT JOIN con la dimensión existente <code>[Colegio].[DIM_ACUDIENTES]</code> y un INNER JOIN con <code>[DIM_POBLACION_MATRICULA]</code> para asegurar que:</p>
<ul>
<li>Se seleccionen únicamente los registros en los que no existe coincidencia en <code>DIM_ACUDIENTES</code> (es decir, los registros nuevos).</li>
<li>Se asegure que el campo <code>ID_POBLACION_MATRICULA</code> tenga un valor válido.</li>
</ul>
</li>
<li>
<p><strong>Flujo de Datos:</strong><br />
  Los datos fluyen desde el origen (la consulta en la tabla temporal) hacia el destino de ADO.NET, garantizando que sólo se carguen los registros que aún no han sido incorporados en la dimensión.</p>
</li>
</ul>
<hr />
<h5 id="flujo-de-ejecucion_2">Flujo de Ejecución<a class="headerlink" href="#flujo-de-ejecucion_2" title="Permanent link">&para;</a></h5>
<ol>
<li>
<p><strong>Extracción de Datos:</strong><br />
   El componente de origen ADO.NET ejecuta la consulta SQL para leer los datos desde <code>[STAGE_AREA].[Transversal].[TMP_ACUDIENTES_SAP]</code> que cumplen las condiciones de actualización.</p>
</li>
<li>
<p><strong>Validación de Registros:</strong><br />
   Se realiza un cruce implícito (mediante la consulta SQL) que descarta los registros cuyo <code>BP_ESTUDIANTE</code> ya existe en la dimensión <code>[Colegio].[DIM_ACUDIENTES]</code> y que garantiza que <code>ID_POBLACION_MATRICULA</code> sea válido.</p>
</li>
<li>
<p><strong>Carga de Datos:</strong><br />
   Los registros que cumplen con las condiciones (nuevos o no encontrados en la dimensión) se cargan en la tabla <code>"Colegio"."DIM_ACUDIENTES"</code> utilizando la opción de Bulk Insert para optimizar el rendimiento.</p>
</li>
</ol>
<hr />
<h5 id="diagrama-de-secuencia_3">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia_3" title="Permanent link">&para;</a></h5>
<pre class="mermaid"><code>sequenceDiagram
    participant Origen as Origen de ADO NET (TMP_ACUDIENTES_SAP)
    participant Transform as Proceso de Validación y Filtrado
    participant Dest as Destino de ADO NET (DIM_ACUDIENTES)

    Origen -&gt;&gt; Transform: Extrae datos desde TMP_ACUDIENTES_SAP
    Transform -&gt;&gt; Transform: Compara registros con DIM_ACUDIENTES y DIM_POBLACION_MATRICULA
    Transform -&gt;&gt; Dest: Envía registros nuevos para inserción
    Dest -&gt;&gt; Dest: Inserta datos en "Colegio"."DIM_ACUDIENTES"</code></pre>
<h3 id="componente-descargar_am-edf-153">Componente <strong><code>Descargar_AM-EDF-153</code></strong><a class="headerlink" href="#componente-descargar_am-edf-153" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_2">Descripción General<a class="headerlink" href="#descripcion-general_2" title="Permanent link">&para;</a></h4>
<p>El componente <code>Descargar_AM-EDF-153</code> es una tarea de ejecución de proceso en un paquete SSIS que se encarga de ejecutar un script Python para conectar a SharePoint y descargar archivos manuales relacionados con el proyecto. Esta tarea utiliza la funcionalidad <code>Execute Process</code> de SSIS para garantizar una integración fluida con sistemas externos.</p>
<h4 id="detalles-del-componente">Detalles del Componente<a class="headerlink" href="#detalles-del-componente" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Identificador del Componente</strong>:</p>
<ul>
<li><strong>DTSID</strong>: <code>{dc092a95-1b4b-442c-9f34-b34054bbb72d}</code></li>
</ul>
</li>
<li>
<p><strong>Tipo de Componente</strong>:</p>
<ul>
<li><code>Microsoft.ExecuteProcess</code></li>
</ul>
</li>
<li>
<p><strong>Descripción</strong>:</p>
<ul>
<li>Tarea diseñada para ejecutar un proceso externo, en este caso, un script Python que se conecta a SharePoint y descarga los archivos requeridos.</li>
</ul>
</li>
<li>
<p><strong>Propiedades</strong>:</p>
<ul>
<li><strong>Executable</strong>: 
    <div class="highlight"><pre><span></span><code>\COMFENALCO_EDUCACION\01.Scripts\Utils\env\Scripts\python.exe
</code></pre></div></li>
<li><strong>WorkingDirectory</strong>: 
    <div class="highlight"><pre><span></span><code>\COMFENALCO_EDUCACION\01.Scripts\03.Archivos_Manuales\04.Colegio
</code></pre></div></li>
<li><strong>Arguments</strong>: 
    <div class="highlight"><pre><span></span><code>01.SharePoint_Connection_AM-EDF-153.py
</code></pre></div></li>
</ul>
</li>
</ol>
<p><strong>Propiedades Avanzadas</strong></p>
<ol>
<li>
<p><strong>Configuraciones de Expresión</strong>:</p>
<ul>
<li><strong>Executable</strong>: 
    <div class="highlight"><pre><span></span><code>@[$Project::Working_Directory]+ &quot;COMFENALCO_EDUCACION\\01.Scripts\\Utils\\env\\Scripts\\python.exe&quot;
</code></pre></div></li>
<li><strong>WorkingDirectory</strong>: 
    <div class="highlight"><pre><span></span><code>@[$Project::Working_Directory] +&quot;COMFENALCO_EDUCACION\\01.Scripts\\03.Archivos_Manuales\\04.Colegio&quot;
</code></pre></div></li>
</ul>
</li>
<li>
<p><strong>Detalles del Proceso</strong>:</p>
<ul>
<li><strong>Ejecutable</strong>:<ul>
<li>Ubicación del script de Python a ejecutar.</li>
</ul>
</li>
<li><strong>Argumentos</strong>:<ul>
<li>Nombre del archivo de script: <code>01.SharePoint_Connection_AM-EDF-153.py</code>.</li>
</ul>
</li>
<li><strong>Directorio de Trabajo</strong>:<ul>
<li>Ruta donde se encuentra el script y los archivos necesarios para su ejecución.</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr />
<h4 id="diagrama-de-secuencia_4">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia_4" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant SSIS as Tarea SSIS
    participant Python as Script de Python
    participant SharePoint as Servidor SharePoint

    SSIS-&gt;&gt;Python: Ejecutar `01.SharePoint_Connection_AM-EDF-153.py`
    Python-&gt;&gt;SharePoint: Conectar a SharePoint
    SharePoint--&gt;&gt;Python: Confirmar conexión
    Python-&gt;&gt;SharePoint: Descargar archivos
    SharePoint--&gt;&gt;Python: Retornar archivos descargados
    Python--&gt;&gt;SSIS: Confirmar finalización del proceso</code></pre>
<hr />
<h3 id="componente-procesar-dim_libros">Componente <strong><code>Procesar DIM_LIBROS</code></strong><a class="headerlink" href="#componente-procesar-dim_libros" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_3">Descripción General<a class="headerlink" href="#descripcion-general_3" title="Permanent link">&para;</a></h4>
<p>El componente <code>Procesar DIM_LIBROS</code> es una tarea de flujo de datos en un paquete SSIS que realiza operaciones ETL (Extracción, Transformación y Carga) sobre información de libros. Los datos son extraídos desde un archivo de Excel, transformados mediante conversiones y columnas derivadas, y finalmente cargados en una base de datos destino. Adicionalmente, el flujo incluye una operación de búsqueda (<code>Lookup</code>) para enriquecer los datos.</p>
<hr />
<h4 id="componentes-del-flujo-de-datos_2">Componentes del Flujo de Datos<a class="headerlink" href="#componentes-del-flujo-de-datos_2" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Fuente de Datos Excel (<code>AM-EDF-153</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Extrae datos desde una hoja de cálculo Excel.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>OpenRowset</code>: <code>Sheet1$</code></li>
<li><code>AccessMode</code>: <code>0</code> (Modo de acceso directo)</li>
<li><code>CommandTimeout</code>: <code>0</code> (Sin límite de tiempo)</li>
</ul>
</li>
<li><strong>Conexiones</strong>:<ul>
<li><code>OleDbConnection</code>: Conexión a Excel referenciada por el administrador de conexiones <code>Excel_Connection_Dim_Libros</code>.</li>
</ul>
</li>
<li><strong>Columnas de Salida</strong>:
    <code>CODIGO_BARRAS</code>, <code>ITEM</code>, <code>AUTOR</code>, <code>TITULO</code>.</li>
</ul>
</li>
<li>
<p><strong>Conversión de Datos (<code>Data Conversion</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Convierte las columnas de datos para garantizar compatibilidad con los componentes posteriores.</li>
<li><strong>Columnas de Entrada</strong>:
    <code>CODIGO_BARRAS</code>, <code>ITEM</code>, <code>AUTOR</code>, <code>TITULO</code>.</li>
<li><strong>Columnas de Salida</strong>:
    <code>Copy of CODIGO_BARRAS</code>, <code>Copy of ITEM</code>, <code>Copy of AUTOR</code>, <code>Copy of TITULO</code>.</li>
</ul>
</li>
<li>
<p><strong>Columna Derivada (<code>ID_LIBRO_AUXILIAR</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Crea una nueva columna <code>ID_LIBRO_AUXILIAR</code> combinando <code>CODIGO_BARRAS</code> e <code>ITEM</code>.</li>
<li><strong>Expresión Derivada</strong>: 
    <div class="highlight"><pre><span></span><code>CODIGO_BARRAS + &quot;_&quot; + ITEM
</code></pre></div></li>
</ul>
</li>
<li>
<p><strong>Búsqueda (<code>Lookup</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Realiza una búsqueda en la tabla <code>DIM_LIBROS</code> para enriquecer los datos con información adicional.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>SqlCommand</code>: 
  <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="p">[</span><span class="n">ID_LIBRO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">CODIGO_BARRAS</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="p">[</span><span class="n">ITEM</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ID_LIBRO_AUXILIAR</span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_LIBROS</span><span class="p">]</span>
</code></pre></div></li>
</ul>
</li>
<li><strong>Columnas de Salida</strong>:
    <code>ID_LIBRO</code>, <code>ID_LIBRO_AUXILIAR</code>.</li>
</ul>
</li>
<li>
<p><strong>Destino de Datos ADO.NET (<code>DIM_LIBROS</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Carga los datos procesados en la tabla <code>DIM_LIBROS</code> en la base de datos destino.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>TableOrViewName</code>: <code>"Colegio"."DIM_LIBROS"</code></li>
<li><code>BatchSize</code>: <code>0</code> (Predeterminado)</li>
<li><code>CommandTimeout</code>: <code>30</code></li>
</ul>
</li>
<li><strong>Columnas de Entrada</strong>:
    <code>Copy of CODIGO_BARRAS</code>, <code>Copy of ITEM</code>, <code>Copy of AUTOR</code>, <code>Copy of TITULO</code>.</li>
</ul>
</li>
</ol>
<hr />
<h4 id="diagrama-de-secuencia_5">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia_5" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant ExcelSource as AM-EDF-153 (Fuente Excel)
    participant DataConversion as Data Conversion
    participant DerivedColumn as ID_LIBRO_AUXILIAR
    participant Lookup as Lookup
    participant AdoNetDestination as DIM_LIBROS (Destino)

    ExcelSource-&gt;&gt;DataConversion: Salida de datos Excel
    DataConversion-&gt;&gt;DerivedColumn: Salida de datos convertidos
    DerivedColumn-&gt;&gt;Lookup: Salida de columna derivada
    Lookup-&gt;&gt;AdoNetDestination: Salida de búsqueda no coincidente</code></pre>
<h3 id="componente-validar-si-existe-tabla-para-guardar">Componente <strong><code>Validar si existe tabla para guardar</code></strong><a class="headerlink" href="#componente-validar-si-existe-tabla-para-guardar" title="Permanent link">&para;</a></h3>
<p>Este componente es una tarea de ejecución de SQL (Execute SQL Task) dentro del paquete SSIS "Procedimiento y Tabla para FACT_RETIROS". Su función es verificar si existe una tabla denominada <strong>RESULTS</strong> en el esquema actual y, en caso de que no exista, crearla. Esto asegura que, antes de iniciar el proceso de carga de datos para FACT_RETIROS, exista la estructura necesaria para almacenar los resultados.</p>
<hr />
<h5 id="proposito-del-componente_3">Propósito del Componente<a class="headerlink" href="#proposito-del-componente_3" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p><strong>Verificación y Creación de Estructura:</strong><br />
  Asegurarse de que la tabla <strong>RESULTS</strong> esté presente en el entorno, creando la tabla si no existe, para evitar errores en fases posteriores del proceso ETL.</p>
</li>
<li>
<p><strong>Preparación del Entorno de Carga:</strong><br />
  Automatizar la validación y provisión de la infraestructura de datos necesaria para la integración y almacenamiento de la información de FACT_RETIROS.</p>
</li>
</ul>
<hr />
<h5 id="descripcion-tecnica_3">Descripción Técnica<a class="headerlink" href="#descripcion-tecnica_3" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p><strong>Tipo de Tarea:</strong><br />
  Execute SQL Task.</p>
</li>
<li>
<p><strong>Propiedades Clave:</strong></p>
<ul>
<li><strong>SqlStatementSource:</strong><br />
  El componente ejecuta la siguiente sentencia SQL para validar y crear la tabla en caso de ausencia:
  <div class="highlight"><pre><span></span><code><span class="c1">-- Verificar si la tabla &#39;RESULTS&#39; existe y crearla si no es así</span>
<span class="k">DO</span>
<span class="k">BEGIN</span>
<span class="w">    </span><span class="k">DECLARE</span><span class="w"> </span><span class="n">table_count</span><span class="w"> </span><span class="nb">INT</span><span class="p">;</span>

<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">table_count</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">TABLES</span>
<span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="k">TABLE_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;RESULTS&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">SCHEMA_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CURRENT_SCHEMA</span><span class="p">;</span>

<span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="n">table_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">THEN</span>
<span class="w">        </span><span class="k">EXEC</span><span class="w"> </span><span class="s1">&#39;CREATE TABLE RESULTS (</span>
<span class="s1">                OBJETO_SAP_ESTUDIANTE VARCHAR(20),</span>
<span class="s1">                NUMERO_MATRICULA VARCHAR(20),</span>
<span class="s1">                PARTNER_ESTUDIANTE VARCHAR(20),</span>
<span class="s1">                ANIO_ACADEMICO VARCHAR(20),</span>
<span class="s1">                APELLIDOS VARCHAR(50),</span>
<span class="s1">                NOMBRES VARCHAR(50),</span>
<span class="s1">                CURSO VARCHAR(20),</span>
<span class="s1">                GRADO VARCHAR(20),</span>
<span class="s1">                FECHA_RETIRO_SAP DATE,</span>
<span class="s1">                FECHA_VALIDO_DESDE DATE,</span>
<span class="s1">                FECHA_VALIDO_HASTA DATE</span>
<span class="s1">              );&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">IF</span><span class="p">;</span>
<span class="k">END</span><span class="p">;</span>
</code></pre></div></li>
<li><strong>Conexión:</strong><br />
  Utiliza una conexión preconfigurada (identificada mediante el GUID <code>{3A7D3F89-902D-4694-893E-02F1E08B0F72}</code>) que apunta al servidor de base de datos adecuado para ejecutar la sentencia SQL.</li>
</ul>
</li>
</ul>
<hr />
<h5 id="flujo-de-ejecucion_3">Flujo de Ejecución<a class="headerlink" href="#flujo-de-ejecucion_3" title="Permanent link">&para;</a></h5>
<ol>
<li>
<p><strong>Inicio de la Tarea:</strong><br />
   Al iniciar el paquete, se ejecuta la tarea de SQL para validar la existencia de la tabla <strong>RESULTS</strong>.</p>
</li>
<li>
<p><strong>Verificación en la Base de Datos:</strong><br />
   La tarea consulta el sistema de tablas para contar cuántas tablas con el nombre <strong>RESULTS</strong> existen en el esquema actual.</p>
</li>
<li>
<p><strong>Creación Condicional:</strong><br />
   Si el resultado es 0 (es decir, la tabla no existe), se ejecuta el comando SQL para crear la tabla con las columnas especificadas.</p>
</li>
<li>
<p><strong>Finalización de la Tarea:</strong><br />
   Tras la verificación (y creación, de ser necesaria), la tarea finaliza, permitiendo que el flujo ETL continúe con los siguientes pasos.</p>
</li>
</ol>
<hr />
<h5 id="diagrama-de-secuencia_6">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia_6" title="Permanent link">&para;</a></h5>
<pre class="mermaid"><code>sequenceDiagram
    participant SSIS as SSIS Package
    participant SQLTask as Execute SQL Task
    participant DB as Base de Datos

    SSIS -&gt;&gt; SQLTask: Inicia "Validar si existe tabla para guardar"
    SQLTask -&gt;&gt; DB: Ejecuta SQL para verificar existencia de "RESULTS"
    DB --&gt;&gt; SQLTask: Devuelve el conteo de tablas
    SQLTask -&gt;&gt; DB: Si no existe, ejecuta comando CREATE TABLE
    DB --&gt;&gt; SQLTask: Confirma creación (o existencia) de la tabla
    SQLTask -&gt;&gt; SSIS: Finaliza la tarea</code></pre>
<h3 id="componente-crear-procedimiento-anual">Componente <strong><code>Crear procedimiento anual</code></strong><a class="headerlink" href="#componente-crear-procedimiento-anual" title="Permanent link">&para;</a></h3>
<p>Este componente es una tarea de ejecución de SQL (Execute SQL Task) dentro del paquete SSIS "Procedimiento y Tabla para FACT_RETIROS". Su función es verificar si existe el procedimiento almacenado <strong>GetRetirosByYear</strong> en el esquema actual y, de no existir, crearlo. Este procedimiento se utiliza para obtener los retiros filtrados por año, lo cual es fundamental para el proceso ETL relacionado con FACT_RETIROS.</p>
<hr />
<h5 id="proposito-del-componente_4">Propósito del Componente<a class="headerlink" href="#proposito-del-componente_4" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p><strong>Verificación y Creación de Procedimiento:</strong><br />
  Se asegura que el procedimiento <strong>GetRetirosByYear</strong> esté definido en la base de datos antes de proceder con las operaciones de carga y procesamiento de datos de retiros.</p>
</li>
<li>
<p><strong>Preparación del Entorno ETL:</strong><br />
  Automatiza la creación del procedimiento almacenado en caso de ausencia, lo que evita fallos en etapas posteriores del flujo ETL.</p>
</li>
</ul>
<hr />
<h5 id="descripcion-tecnica_4">Descripción Técnica<a class="headerlink" href="#descripcion-tecnica_4" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p><strong>Tipo de Tarea:</strong><br />
  Execute SQL Task.</p>
</li>
<li>
<p><strong>Propiedades Clave:</strong></p>
<ul>
<li><strong>SqlStatementSource:</strong><br />
  El componente ejecuta la siguiente sentencia SQL para verificar y crear el procedimiento:
  <div class="highlight"><pre><span></span><code><span class="c1">-- Verificar si el procedimiento &#39;GetRetirosByYear&#39; existe y crearlo si no es así</span>
<span class="k">DO</span>
<span class="k">BEGIN</span>
<span class="w">    </span><span class="k">DECLARE</span><span class="w"> </span><span class="n">proc_count</span><span class="w"> </span><span class="nb">INT</span><span class="p">;</span>

<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">proc_count</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">PROCEDURES</span>
<span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">PROCEDURE_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;GETRETIROSBYYEAR&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">SCHEMA_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CURRENT_SCHEMA</span><span class="p">;</span>

<span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="n">proc_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">THEN</span>
<span class="w">        </span><span class="k">EXEC</span><span class="w"> </span><span class="s1">&#39;CREATE PROCEDURE GetRetirosByYear (IN P_YEAR INT)</span>
<span class="s1">               LANGUAGE SQLSCRIPT</span>
<span class="s1">               AS</span>
<span class="s1">               BEGIN</span>
<span class="s1">                   DECLARE valid_from_date NVARCHAR(8); </span>
<span class="s1">                   valid_from_date := CONCAT(P_YEAR, &#39;&#39;0101&#39;&#39;);</span>
<span class="s1">                   INSERT INTO RESULTS</span>
<span class="s1">                   SELECT </span>
<span class="s1">                       DISTINCT </span>
<span class="s1">                       h.objid AS OBJETO_SAP_ESTUDIANTE,</span>
<span class="s1">                       p.short AS NUMERO_MATRICULA,</span>
<span class="s1">                       b.PARTNER AS PARTNER_ESTUDIANTE,</span>
<span class="s1">                       o.ayear AS ANIO_ACADEMICO,</span>
<span class="s1">                       h.nachn AS APELLIDOS,</span>
<span class="s1">                       h.vorna AS NOMBRES,</span>
<span class="s1">                       i.prcl AS ID_CURSO,</span>
<span class="s1">                       j.matrikel AS GRADO,</span>
<span class="s1">                       m.END_KEY_DATE AS FECHA_RETIRO_SAP,</span>
<span class="s1">                       i.mc_valid_from AS FECHA_VALIDO_DESDE,</span>
<span class="s1">                       i.mc_valid_to AS FECHA_VALIDO_HASTA</span>
<span class="s1">                   FROM SAPABAP1.hrp1702 AS h</span>
<span class="s1">                   INNER JOIN SAPABAP1.hrp1000 AS p ON h.plvar = p.plvar AND h.otype = p.otype AND h.objid = p.objid AND h.endda = p.endda</span>
<span class="s1">                   INNER JOIN SAPABAP1.hrp1705 AS j ON h.plvar = j.plvar AND h.otype = j.otype AND h.objid = j.objid AND h.endda = j.endda</span>
<span class="s1">                   INNER JOIN SAPABAP1.hrp1737 AS k ON j.plvar = k.plvar AND j.otype = k.otype AND j.objid = k.objid AND j.endda = k.endda</span>
<span class="s1">                   INNER JOIN SAPABAP1.hrt1737 AS i ON k.tabnr = i.tabnr</span>
<span class="s1">                   INNER JOIN SAPABAP1.hrp1001 AS l ON l.plvar = h.plvar AND l.otype = h.otype AND l.objid = h.objid AND l.endda = h.endda</span>
<span class="s1">                   INNER JOIN SAPABAP1.hrp1001 AS n ON n.plvar = l.plvar AND n.otype = l.sclas AND n.objid = l.sobid AND n.endda = l.endda</span>
<span class="s1">                   INNER JOIN SAPABAP1.hrp1769 AS m ON m.plvar = n.plvar AND m.otype = n.otype AND m.objid = n.objid</span>
<span class="s1">                   INNER JOIN SAPABAP1.hrp1771 AS o ON o.plvar = n.plvar AND o.otype = n.otype AND o.objid = n.objid</span>
<span class="s1">                   INNER JOIN SAPABAP1.CMACBPST as b On p.objid = b.stobjid</span>
<span class="s1">                   WHERE</span>
<span class="s1">                       l.sclas = &#39;&#39;CS&#39;&#39; AND</span>
<span class="s1">                       n.sclas = &#39;&#39;SC&#39;&#39; AND</span>
<span class="s1">                       p.otype = &#39;&#39;ST&#39;&#39; AND</span>
<span class="s1">                       p.plvar = &#39;&#39;01&#39;&#39; AND</span>
<span class="s1">                       i.mc_valid_to &gt;= CURDATE() AND</span>
<span class="s1">                       i.prog_type = &#39;&#39;4&#39;&#39; AND</span>
<span class="s1">                       i.valid_from = valid_from_date AND</span>
<span class="s1">                       m.begda &lt;= CURDATE() AND</span>
<span class="s1">                       m.endda &lt;= CURDATE() AND</span>
<span class="s1">                       o.prs_state = &#39;&#39;A&#39;&#39; AND</span>
<span class="s1">                       o.ayear = P_YEAR AND</span>
<span class="s1">                       m.END_PROCESS = &#39;&#39;RW01&#39;&#39; AND</span>
<span class="s1">                       m.END_KEY_DATE &gt;= i.valid_from;</span>
<span class="s1">               END;&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">IF</span><span class="p">;</span>
<span class="k">END</span><span class="p">;</span>
</code></pre></div></li>
<li><strong>Conexión:</strong><br />
  Se utiliza una conexión preconfigurada (identificada mediante el GUID <code>{3A7D3F89-902D-4694-893E-02F1E08B0F72}</code>) que apunta al servidor de base de datos donde se encuentra el procedimiento.</li>
</ul>
</li>
</ul>
<hr />
<h5 id="flujo-de-ejecucion_4">Flujo de Ejecución<a class="headerlink" href="#flujo-de-ejecucion_4" title="Permanent link">&para;</a></h5>
<ol>
<li>
<p><strong>Inicio de la Tarea:</strong><br />
   El paquete SSIS inicia la tarea de SQL "Crear procedimiento anual".</p>
</li>
<li>
<p><strong>Verificación del Procedimiento:</strong><br />
   La tarea consulta el catálogo de procedimientos para determinar si <strong>GETRETIROSBYYEAR</strong> ya existe en el esquema actual.</p>
</li>
<li>
<p><strong>Creación Condicional:</strong>  </p>
<ul>
<li>Si el procedimiento no existe (conteo igual a 0), se ejecuta el comando SQL para crear el procedimiento almacenado con la definición especificada.</li>
<li>Si ya existe, no se realiza ninguna acción adicional.</li>
</ul>
</li>
<li>
<p><strong>Finalización de la Tarea:</strong><br />
   La tarea finaliza y el proceso ETL puede continuar con las siguientes etapas, sabiendo que la estructura necesaria para procesar los retiros está en su lugar.</p>
</li>
</ol>
<hr />
<h5 id="diagrama-de-secuencia_7">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia_7" title="Permanent link">&para;</a></h5>
<pre class="mermaid"><code>sequenceDiagram
    participant SSIS as SSIS Package
    participant SQLTask as Execute SQL Task
    participant DB as Base de Datos

    SSIS -&gt;&gt; SQLTask: Inicia "Crear procedimiento anual"
    SQLTask -&gt;&gt; DB: Ejecuta SQL para verificar existencia de 'GETRETIROSBYYEAR'
    DB --&gt;&gt; SQLTask: Devuelve conteo de procedimientos
    SQLTask -&gt;&gt; DB: Si no existe, ejecuta comando CREATE PROCEDURE
    DB --&gt;&gt; SQLTask: Confirma creación (o existencia) del procedimiento
    SQLTask -&gt;&gt; SSIS: Finaliza la tarea</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
        <script src="../../js/mkdocs_pagetree_plugin.js"></script>
      
        <script src="../../js/init_mermaid.js"></script>
      
    
  </body>
</html>