
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../03-COLEGIO_DIMENSIONES/">
      
      
        <link rel="next" href="../05-CEDESARROLLO_DIMENSIONES/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>04. COLEGIO_FACT - COMFENALCO</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="23abf7" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#colegio_fact" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="COMFENALCO" class="md-header__button md-logo" aria-label="COMFENALCO" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            COMFENALCO
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              04. COLEGIO_FACT
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="COMFENALCO" class="md-nav__button md-logo" aria-label="COMFENALCO" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    COMFENALCO
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    00. INICIO
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            00. INICIO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    INTRODUCCIÓN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../instalacion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    INSTALACIÓN Y CONFIGURACIÓN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Conexiones_BD/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CONEXIÓN A BASE DE DATOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../buenaspracticas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BUENAS PRÁCTICAS
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    01. SCRIPTS SQL
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            01. SCRIPTS SQL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.scripts/00.Inicio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introducción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.scripts/00.Eliminar_todo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    00. Eliminar Todo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.scripts/01.Transversal/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01. Transversal
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.scripts/02.Cedesarrollo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    02. Cedesarrollo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.scripts/03.Proteccion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    03. Proteccion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.scripts/04.Colegio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    04. Colegio
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    02. ESTRUCTURA SHAREPOINT
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            02. ESTRUCTURA SHAREPOINT
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04.sharepoint/estructura_sharepoint/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Estructura carpeta Sharepoint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04.sharepoint/estructura_archivos_actualizacion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Estructura Archivos Actualizacion
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    03. BI COMFENALCO
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            03. BI COMFENALCO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00.params/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduccion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00-SCRAPING/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    00. WEB SCRAPING
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01.TRANSVERSAL_DIMENSIONES/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01. TRANSVERSAL_DIMENSIONES
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-TRANSVERSAL_FACT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    02. TRANSVERSAL_FACT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-COLEGIO_DIMENSIONES/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    03. COLEGIO_DIMENSIONES
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    04. COLEGIO_FACT
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    04. COLEGIO_FACT
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#proposito-del-paquete" class="md-nav__link">
    <span class="md-ellipsis">
      Propósito del Paquete
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#descripcion-del-paquete" class="md-nav__link">
    <span class="md-ellipsis">
      Descripción del Paquete
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tablas-y-columnas-clave" class="md-nav__link">
    <span class="md-ellipsis">
      Tablas y Columnas Clave
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diagramas" class="md-nav__link">
    <span class="md-ellipsis">
      Diagramas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#componentes-clave-del-paquete" class="md-nav__link">
    <span class="md-ellipsis">
      Componentes Clave del Paquete
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Componentes Clave del Paquete">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#componente-ep-edf-01-fact_enfermeria" class="md-nav__link">
    <span class="md-ellipsis">
      Componente EP-EDF-01 FACT_ENFERMERIA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-ep-edf-02-fact_ausentismo_docente" class="md-nav__link">
    <span class="md-ellipsis">
      Componente EP-EDF-02 FACT_AUSENTISMO_DOCENTE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-ep-edf-03-fact_reemplazo_docente" class="md-nav__link">
    <span class="md-ellipsis">
      Componente EP-EDF-03 FACT_REEMPLAZO_DOCENTE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-ep-edf-04-fact_permiso_estudiante" class="md-nav__link">
    <span class="md-ellipsis">
      Componente EP-EDF-04 FACT_PERMISO_ESTUDIANTE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-ep-edf-05-fact_biblioteca" class="md-nav__link">
    <span class="md-ellipsis">
      Componente EP-EDF-05 FACT_BIBLIOTECA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-ep-edf-06-fact_biblioteca_virtual" class="md-nav__link">
    <span class="md-ellipsis">
      Componente EP-EDF-06 FACT_BIBLIOTECA_VIRTUAL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-ep-edf-07-fact_saber11_individual" class="md-nav__link">
    <span class="md-ellipsis">
      Componente EP-EDF-07 FACT_SABER11_INDIVIDUAL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_transporte" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_TRANSPORTE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_cupos_negados" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_CUPOS_NEGADOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-crear-procedimiento" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Crear Procedimiento
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-validar-si-existe-tabla-para-guardar" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Validar si existe tabla para guardar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-crear-tabla" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Crear Tabla
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-crear-procedimiento-anual" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Crear procedimiento anual
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-truncar-tabla" class="md-nav__link">
    <span class="md-ellipsis">
      Componente: Truncar tabla
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-calcular-retiros" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Calcular retiros
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_ausentismo_docente" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_AUSENTISMO_DOCENTE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_biblioteca" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_BIBLIOTECA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_biblioteca_virtual" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_BIBLIOTECA_VIRTUAL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_desempenho_docente" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_DESEMPENHO_DOCENTE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_enfermeria" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_ENFERMERIA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_legalizacion" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_LEGALIZACION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_permiso_estudiante" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_PERMISO_ESTUDIANTE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_psiorientacion" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_PSIORIENTACION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_reemplazo_docente" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_REEMPLAZO_DOCENTE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_reserva_espacios" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_RESERVA_ESPACIOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_saber11_colegios" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_SABER11_COLEGIOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_saber11_individual" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_SABER11_INDIVIDUAL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_servicio_social" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_SERVICIO_SOCIAL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-CEDESARROLLO_DIMENSIONES/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    05. CEDESARROLLO_DIMENSIONES
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-CEDESARROLLO_FACT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    06. CEDESARROLLO_FACT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-PROTECCION_DIMENSIONES/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    07. PROTECCION_DIMENSIONES
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-PROTECCION_FACT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    08. PROTECCION_FACT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09-ETLS_CUBO/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    09. ETLS_CUBO
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    04. COMFENALCO EDUCACION
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            04. COMFENALCO EDUCACION
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    01 SCRIPTS
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            01 SCRIPTS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_00.Introduccion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introducción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2" id="__nav_5_1_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    01. Q10
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2">
            <span class="md-nav__icon md-icon"></span>
            01. Q10
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_1" id="__nav_5_1_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    0.1. Educación Tecnica
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_1">
            <span class="md-nav__icon md-icon"></span>
            0.1. Educación Tecnica
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/01.Docentes_Cedesarrollo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.1. Docentes Cedesarrollo.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/02.Disenio_curricular/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.2. Diseño Curricular.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/03.Listado_matriculas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.3. Listado Matrículas.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/04.Ingresos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.4. Ingresos.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/05.Historico_notas_Cedesarrollo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.5. Histórico notas.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/06.Egresados_graduados_Cedesarrollo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.6. Egresados.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/07.Desertores/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.7. Desertores.py
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2_2" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_2" id="__nav_5_1_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    0.2. Educación Continua
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_2">
            <span class="md-nav__icon md-icon"></span>
            0.2. Educación Continua
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.educacioncontinua/01.Docentes_desarrollo_empresarial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.1. Docentes Desarrollo Empresarial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.educacioncontinua/02.Preinscritos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.2. Preinscritos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.educacioncontinua/03.Listado_matriculas_emp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.3. Listado Matrículas Empresarial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.educacioncontinua/04.Consolidado_inasistencias/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.4. Consolidado Inasistencias
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.educacioncontinua/05.Estudiantes_inasistencias/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.5. Estudiantes Inasistencias
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.educacioncontinua/06.Egresados_graduados_empresarial/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    0.6. Egresados Graduados Empresarial
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2_3" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_3" id="__nav_5_1_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Sharepoint
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_3">
            <span class="md-nav__icon md-icon"></span>
            Sharepoint
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_01_procesar_docentes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cede_01 procesar_docentes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_02_procesar_Dise%C3%B1o_Curricular/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cede_02 procesar_Diseño_Curricular
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_03_procesar_listado_matriculas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cede_03 procesar_listado_matriculas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_04_procesar_cede_Ingresos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cede_04 procesar_Ingresos
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_05_cede_Historico_Notas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cede_05 cede_Historico_Notas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_06_cede_Egresados_Graduados/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cede_06 cede_Egresados_Graduados
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_07_Cancelados_Desertores/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cede_07 Cancelados Desertores
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/emp_01_Docentes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    emp_01 Docentes Empresarial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/emp_02_listado_matriculas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    emp_02 Listado Matrículas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/emp_03_preinscritos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    emp_03 Preinscritos Empresarial
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/emp_04_egresados_Graduados/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    emp_04 Egresados Graduados
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/emp_05_Estudiantes_inasistencias/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    emp_05 Estudiantes Inasistencias
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/emp_06_consolidado_Inasistencias/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    emp_06 Consolidado Inasistencias
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3" >
        
          
          <label class="md-nav__link" for="__nav_5_1_3" id="__nav_5_1_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    02. C4C
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3">
            <span class="md-nav__icon md-icon"></span>
            02. C4C
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_02.C4C/01.C4C_webscraping_v4_Actualizable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.1. Webscraping Actualizable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_02.C4C/02.C4C_webscraping_v4_Historico/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    3.2. Webscraping Histórico
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_4" >
        
          
          <label class="md-nav__link" for="__nav_5_1_4" id="__nav_5_1_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Utils
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_4">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/Funciones/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Funciones.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/Funciones_DM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Funciones_DM.py
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/c4c_from_sharepoint/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    c4c_from_sharepoint
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/dim_Estudiantes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dim_Estudiantes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/dim_periodo_academico/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    dim_periodo_academico
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/fact_facturacion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fact_facturacion
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/fact_graduados/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fact_graduados
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/fact_listado_matriculas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fact_listado_matriculas
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    05. CUBO
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            05. CUBO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03.Cubo/00.Introduccion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introducción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03.Cubo/01.Origen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01. ORIGEN Y MEDIDAS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03.Cubo/02.Tablas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    02. TABLAS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03.Cubo/03.ETL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    03. ETL
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    06. POWER BI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            06. POWER BI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05.Power_BI/00.Introduccion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introducción
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05.Power_BI/01.Dashboard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01. DASHBOARD
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#proposito-del-paquete" class="md-nav__link">
    <span class="md-ellipsis">
      Propósito del Paquete
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#descripcion-del-paquete" class="md-nav__link">
    <span class="md-ellipsis">
      Descripción del Paquete
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tablas-y-columnas-clave" class="md-nav__link">
    <span class="md-ellipsis">
      Tablas y Columnas Clave
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diagramas" class="md-nav__link">
    <span class="md-ellipsis">
      Diagramas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#componentes-clave-del-paquete" class="md-nav__link">
    <span class="md-ellipsis">
      Componentes Clave del Paquete
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Componentes Clave del Paquete">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#componente-ep-edf-01-fact_enfermeria" class="md-nav__link">
    <span class="md-ellipsis">
      Componente EP-EDF-01 FACT_ENFERMERIA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-ep-edf-02-fact_ausentismo_docente" class="md-nav__link">
    <span class="md-ellipsis">
      Componente EP-EDF-02 FACT_AUSENTISMO_DOCENTE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-ep-edf-03-fact_reemplazo_docente" class="md-nav__link">
    <span class="md-ellipsis">
      Componente EP-EDF-03 FACT_REEMPLAZO_DOCENTE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-ep-edf-04-fact_permiso_estudiante" class="md-nav__link">
    <span class="md-ellipsis">
      Componente EP-EDF-04 FACT_PERMISO_ESTUDIANTE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-ep-edf-05-fact_biblioteca" class="md-nav__link">
    <span class="md-ellipsis">
      Componente EP-EDF-05 FACT_BIBLIOTECA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-ep-edf-06-fact_biblioteca_virtual" class="md-nav__link">
    <span class="md-ellipsis">
      Componente EP-EDF-06 FACT_BIBLIOTECA_VIRTUAL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-ep-edf-07-fact_saber11_individual" class="md-nav__link">
    <span class="md-ellipsis">
      Componente EP-EDF-07 FACT_SABER11_INDIVIDUAL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_transporte" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_TRANSPORTE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_cupos_negados" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_CUPOS_NEGADOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-crear-procedimiento" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Crear Procedimiento
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-validar-si-existe-tabla-para-guardar" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Validar si existe tabla para guardar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-crear-tabla" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Crear Tabla
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-crear-procedimiento-anual" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Crear procedimiento anual
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-truncar-tabla" class="md-nav__link">
    <span class="md-ellipsis">
      Componente: Truncar tabla
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-calcular-retiros" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Calcular retiros
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_ausentismo_docente" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_AUSENTISMO_DOCENTE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_biblioteca" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_BIBLIOTECA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_biblioteca_virtual" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_BIBLIOTECA_VIRTUAL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_desempenho_docente" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_DESEMPENHO_DOCENTE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_enfermeria" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_ENFERMERIA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_legalizacion" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_LEGALIZACION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_permiso_estudiante" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_PERMISO_ESTUDIANTE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_psiorientacion" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_PSIORIENTACION
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_reemplazo_docente" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_REEMPLAZO_DOCENTE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_reserva_espacios" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_RESERVA_ESPACIOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_saber11_colegios" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_SABER11_COLEGIOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_saber11_individual" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_SABER11_INDIVIDUAL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-fact_servicio_social" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar FACT_SERVICIO_SOCIAL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<!-- markdownlint-disable -->
<h1 id="colegio_fact">COLEGIO_FACT<a class="headerlink" href="#colegio_fact" title="Permanent link">&para;</a></h1>
<p>El paquete SSIS <strong>"04-COLEGIO_FACT"</strong> está diseñado para procesar, transformar y cargar datos críticos relacionados con operaciones educativas en diversas áreas como matrículas, transporte, biblioteca y evaluaciones. Este paquete asegura la integración efectiva de datos en el Data Warehouse <code>DWH_COMFENALCO</code>, garantizando su calidad y disponibilidad para análisis y reportes estratégicos.</p>
<hr />
<h2 id="proposito-del-paquete">Propósito del Paquete<a class="headerlink" href="#proposito-del-paquete" title="Permanent link">&para;</a></h2>
<p>El objetivo principal es consolidar información operativa y educativa para apoyar la toma de decisiones basada en datos. Esto incluye la transformación de datos de diversas fuentes, su validación y enriquecimiento antes de su carga en el Data Warehouse.</p>
<hr />
<h2 id="descripcion-del-paquete">Descripción del Paquete<a class="headerlink" href="#descripcion-del-paquete" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Extracción de Datos</strong>:</p>
<ul>
<li>Fuentes principales:<ul>
<li><strong>Bases de Datos SAP y SQL Server</strong>:</li>
<li><code>FACT_TRANSPORTE</code>, <code>FACT_CUPOS_NEGADOS</code>, <code>FACT_AUSENTISMO_DOCENTE</code>, <code>FACT_BIBLIOTECA</code>.</li>
<li><strong>Archivos Excel</strong>:</li>
<li>Información de permisos, ausentismo, y evaluaciones.</li>
</ul>
</li>
<li>Herramientas utilizadas:<ul>
<li>Conexiones ADO.NET y OLE DB para extracción y carga.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Transformación de Datos</strong>:</p>
<ul>
<li><strong>Validación de Datos (<code>Lookup</code>)</strong>:<ul>
<li>Comprobación en tablas maestras como <code>DIM_POBLACION_MATRICULA</code>, <code>DIM_CURSO</code>, y <code>DIM_LIBROS</code>.</li>
</ul>
</li>
<li><strong>Conversión de Tipos (<code>Data Conversion</code>)</strong>:<ul>
<li>Asegura compatibilidad con tablas destino.</li>
</ul>
</li>
<li><strong>Columnas Derivadas (<code>Derived Column</code>)</strong>:<ul>
<li>Cálculo de identificadores únicos y asignaciones condicionales.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Carga de Datos en el Data Warehouse</strong>:</p>
<ul>
<li>Tablas procesadas:<ul>
<li><code>FACT_TRANSPORTE</code></li>
<li><code>FACT_CUPOS_NEGADOS</code></li>
<li><code>FACT_BIBLIOTECA</code></li>
<li><code>FACT_PERMISO_ESTUDIANTE</code></li>
</ul>
</li>
<li>Configuración:<ul>
<li>Inserciones masivas habilitadas para maximizar el rendimiento.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Automatización y Scripts</strong>:</p>
<ul>
<li>Uso de scripts Python para automatización de descargas y validación de datos.</li>
</ul>
</li>
</ol>
<h2 id="tablas-y-columnas-clave">Tablas y Columnas Clave<a class="headerlink" href="#tablas-y-columnas-clave" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>FACT_TRANSPORTE</strong>:</p>
<ul>
<li><code>PARTNER_ESTUDIANTE</code>, <code>ID_FECHA</code>, <code>ANIO_ACADEMICO</code>, <code>CATEGORIA_SERVICIO</code>.</li>
</ul>
</li>
<li>
<p><strong>FACT_CUPOS_NEGADOS</strong>:</p>
<ul>
<li><code>PARTNER_ESTUDIANTE</code>, <code>ANIO_ACADEMICO</code>, <code>FECHA_ESTADO</code>.</li>
</ul>
</li>
<li>
<p><strong>FACT_BIBLIOTECA</strong>:</p>
<ul>
<li><code>ITEM_LIBRO</code>, <code>FECHA_PRESTAMO</code>, <code>FECHA_DEVOLUCION</code>, <code>BP_ESTUDIANTE</code>.</li>
</ul>
</li>
<li>
<p><strong>FACT_PERMISO_ESTUDIANTE</strong>:</p>
<ul>
<li><code>BP_ESTUDIANTE</code>, <code>FECHA_PERMISO</code>, <code>MOTIVO</code>.</li>
</ul>
</li>
</ol>
<h2 id="diagramas">Diagramas<a class="headerlink" href="#diagramas" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Diagrama de Flujo de Datos</strong></li>
</ol>
<pre class="mermaid"><code>sequenceDiagram
    participant SSIS as SSIS Package
    participant DB as Base de Datos
    participant Excel as Archivos Excel
    participant Python as Scripts Python
    participant DWH as Data Warehouse

    SSIS -&gt;&gt; DB: Extraer datos de SAP y SQL Server
    SSIS -&gt;&gt; Excel: Leer información operativa y educativa
    SSIS -&gt;&gt; Python: Automatizar descargas
    SSIS -&gt;&gt; DWH: Cargar datos procesados</code></pre>
<ol>
<li><strong>Diagrama ER para Tablas de Hechos</strong></li>
</ol>
<pre class="mermaid"><code>erDiagram
    FACT_TRANSPORTE {
        string PARTNER_ESTUDIANTE
        date FECHA_INICIO_SERVICIO
        int ANIO_ACADEMICO
        string CATEGORIA_SERVICIO
    }
    FACT_CUPOS_NEGADOS {
        string PARTNER_ESTUDIANTE
        int ANIO_ACADEMICO
        date FECHA_ESTADO
    }
    FACT_BIBLIOTECA {
        string ITEM_LIBRO
        date FECHA_PRESTAMO
        string BP_ESTUDIANTE
    }
    FACT_PERMISO_ESTUDIANTE {
        string BP_ESTUDIANTE
        date FECHA_PERMISO
        string MOTIVO
    }
    FACT_TRANSPORTE ||--|| FACT_CUPOS_NEGADOS : "Relación de estudiantes"
    FACT_BIBLIOTECA ||--|| FACT_PERMISO_ESTUDIANTE : "Conexión por estudiantes"</code></pre>
<h2 id="componentes-clave-del-paquete">Componentes Clave del Paquete<a class="headerlink" href="#componentes-clave-del-paquete" title="Permanent link">&para;</a></h2>
<h3 id="componente-ep-edf-01-fact_enfermeria">Componente <strong><code>EP-EDF-01 FACT_ENFERMERIA</code></strong><a class="headerlink" href="#componente-ep-edf-01-fact_enfermeria" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general"><strong>Descripción General</strong><a class="headerlink" href="#descripcion-general" title="Permanent link">&para;</a></h4>
<p>La tarea <code>EP-EDF-01 FACT_ENFERMERIA</code> es un proceso de ejecución en un paquete SSIS diseñado para correr un script de Python que realiza tareas relacionadas con la descarga de información para la facturación de enfermería. El componente utiliza una ruta específica y argumentos para ejecutar el script.</p>
<hr />
<p><strong>Detalles del Componente</strong></p>
<ul>
<li><strong>Nombre del Componente</strong>: EP-EDF-01 FACT_ENFERMERIA</li>
<li><strong>Tipo</strong>: Execute Process Task</li>
<li><strong>Descripción</strong>: Ejecuta un script de Python encargado de descargar datos específicos relacionados con el proceso <code>EP-EDF-01</code>.</li>
<li><strong>ID del Componente</strong>: <code>{4412de09-7ca0-4c06-ab1a-20e07c589832}</code></li>
</ul>
<hr />
<p><strong>Propiedades Principales</strong></p>
<p><strong>Detalles del Componente</strong></p>
<table>
<thead>
<tr>
<th>Propiedad</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Ruta Ejecutable</strong></td>
<td><code>@[$Project::Python_Executable]</code></td>
</tr>
<tr>
<td><strong>Directorio</strong></td>
<td><code>@[$Project::Working_Directory] + "\\COMFENALCO_EDUCACION\\01.Scripts\\Utils"</code></td>
</tr>
<tr>
<td><strong>Argumentos</strong></td>
<td><code>download.py --key EP-EDF-01</code></td>
</tr>
<tr>
<td><strong>Tiempo de Espera</strong></td>
<td>No especificado (valor predeterminado)</td>
</tr>
<tr>
<td><strong>ThreadHint</strong></td>
<td><code>0</code></td>
</tr>
</tbody>
</table>
<hr />
<h4 id="detalles-de-ejecucion"><strong>Detalles de Ejecución</strong><a class="headerlink" href="#detalles-de-ejecucion" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Ruta del Ejecutable</strong>:<br />
<code>COMFENALCO_EDUCACION\01.Scripts\Utils\env\Scripts\python.exe</code></p>
</li>
<li>
<p><strong>Directorio de Trabajo</strong>:<br />
<code>COMFENALCO_EDUCACION\01.Scripts\Utils</code></p>
</li>
<li>
<p><strong>Argumentos del Script</strong>:<br />
<code>download.py --key EP-EDF-01</code></p>
</li>
</ol>
<hr />
<h4 id="diagrama-de-secuencia"><strong>Diagrama de Secuencia</strong><a class="headerlink" href="#diagrama-de-secuencia" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant SSIS as SSIS Package
    participant Python as Python Script

    SSIS -&gt;&gt; Python: Ejecuta `download.py --key EP-EDF-01`
    Python -&gt;&gt; Python: Descarga datos de `EP-EDF-01`
    Python -&gt;&gt; SSIS: Reporta resultado</code></pre>
<h3 id="componente-ep-edf-02-fact_ausentismo_docente">Componente <strong><code>EP-EDF-02 FACT_AUSENTISMO_DOCENTE</code></strong><a class="headerlink" href="#componente-ep-edf-02-fact_ausentismo_docente" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_1"><strong>Descripción General</strong><a class="headerlink" href="#descripcion-general_1" title="Permanent link">&para;</a></h4>
<p>La tarea <code>EP-EDF-02 FACT_AUSENTISMO_DOCENTE</code> es un proceso diseñado para ejecutar un script de Python que gestiona la descarga de información relacionada con el ausentismo docente. El componente utiliza configuraciones dinámicas para el ejecutable y el directorio de trabajo, maximizando la flexibilidad y portabilidad dentro del entorno del proyecto.</p>
<hr />
<p><strong>Detalles del Componente</strong></p>
<table>
<thead>
<tr>
<th>Propiedad</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Nombre del Componente</strong></td>
<td>EP-EDF-02 FACT_AUSENTISMO_DOCENTE</td>
</tr>
<tr>
<td><strong>Tipo</strong></td>
<td>Execute Process Task</td>
</tr>
<tr>
<td><strong>Descripción</strong></td>
<td>Ejecuta un script de Python que descarga datos relacionados con el ausentismo docente.</td>
</tr>
<tr>
<td><strong>ID del Componente</strong></td>
<td><code>{34225bf4-f1be-4808-9dfa-a648f4e220fc}</code></td>
</tr>
</tbody>
</table>
<hr />
<p><strong>Propiedades Principales</strong></p>
<p><strong>Detalles del Componente</strong></p>
<table>
<thead>
<tr>
<th>Propiedad</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Ruta Ejecutable</strong></td>
<td><code>@[$Project::Python_Executable]</code></td>
</tr>
<tr>
<td><strong>Directorio</strong></td>
<td><code>@[$Project::Working_Directory] + "\\COMFENALCO_EDUCACION\\01.Scripts\\Utils"</code></td>
</tr>
<tr>
<td><strong>Argumentos</strong></td>
<td><code>download.py --key EP-EDF-02</code></td>
</tr>
<tr>
<td><strong>Tiempo de Espera</strong></td>
<td>No especificado (valor predeterminado).</td>
</tr>
<tr>
<td><strong>ThreadHint</strong></td>
<td><code>0</code></td>
</tr>
</tbody>
</table>
<hr />
<h4 id="detalles-de-ejecucion_1"><strong>Detalles de Ejecución</strong><a class="headerlink" href="#detalles-de-ejecucion_1" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Ruta del Ejecutable</strong>:<br />
<code>COMFENALCO_EDUCACION\01.Scripts\Utils\env\Scripts\python.exe</code></p>
</li>
<li>
<p><strong>Directorio de Trabajo</strong>:<br />
<code>COMFENALCO_EDUCACION\01.Scripts\Utils</code></p>
</li>
<li>
<p><strong>Argumentos del Script</strong>:<br />
<code>download.py --key EP-EDF-02</code></p>
</li>
</ol>
<hr />
<h4 id="diagrama-de-secuencia_1"><strong>Diagrama de Secuencia</strong><a class="headerlink" href="#diagrama-de-secuencia_1" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant SSIS as SSIS Package
    participant Python as Python Script

    SSIS -&gt;&gt; Python: Ejecuta `download.py --key EP-EDF-02`
    Python -&gt;&gt; Python: Descarga datos relacionados con ausentismo docente
    Python -&gt;&gt; SSIS: Reporta resultado</code></pre>
<h3 id="componente-ep-edf-03-fact_reemplazo_docente">Componente <strong><code>EP-EDF-03 FACT_REEMPLAZO_DOCENTE</code></strong><a class="headerlink" href="#componente-ep-edf-03-fact_reemplazo_docente" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_2"><strong>Descripción General</strong><a class="headerlink" href="#descripcion-general_2" title="Permanent link">&para;</a></h4>
<p>La tarea <code>EP-EDF-03 FACT_REEMPLAZO_DOCENTE</code> es un componente diseñado para ejecutar un script de Python. Su propósito es gestionar la descarga de información relacionada con el reemplazo docente. Utiliza configuraciones dinámicas a través de variables de proyecto, lo que garantiza flexibilidad y adaptabilidad dentro del entorno de desarrollo.</p>
<hr />
<p><strong>Detalles del Componente</strong></p>
<table>
<thead>
<tr>
<th>Propiedad</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Nombre del Componente</strong></td>
<td>EP-EDF-03 FACT_REEMPLAZO_DOCENTE</td>
</tr>
<tr>
<td><strong>Tipo</strong></td>
<td>Execute Process Task</td>
</tr>
<tr>
<td><strong>Descripción</strong></td>
<td>Ejecuta un script de Python que descarga datos relacionados con el reemplazo docente.</td>
</tr>
<tr>
<td><strong>ID del Componente</strong></td>
<td><code>{df155a7f-6a3b-4e31-af0d-7b07113807e9}</code></td>
</tr>
</tbody>
</table>
<hr />
<p><strong>Propiedades Principales</strong>
<strong>Detalles del Componente</strong></p>
<table>
<thead>
<tr>
<th>Propiedad</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Ruta Ejecutable</strong></td>
<td><code>@[$Project::Python_Executable]</code></td>
</tr>
<tr>
<td><strong>Directorio</strong></td>
<td><code>@[$Project::Working_Directory] + "\\COMFENALCO_EDUCACION\\01.Scripts\\Utils"</code></td>
</tr>
<tr>
<td><strong>Argumentos</strong></td>
<td><code>download.py --key EP-EDF-03</code></td>
</tr>
<tr>
<td><strong>Tiempo de Espera</strong></td>
<td>No especificado (valor predeterminado).</td>
</tr>
<tr>
<td><strong>ThreadHint</strong></td>
<td><code>0</code></td>
</tr>
</tbody>
</table>
<h4 id="detalles-de-ejecucion_2"><strong>Detalles de Ejecución</strong><a class="headerlink" href="#detalles-de-ejecucion_2" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Ruta del Ejecutable</strong>:<br />
<code>COMFENALCO_EDUCACION\01.Scripts\Utils\env\Scripts\python.exe</code></p>
</li>
<li>
<p><strong>Directorio de Trabajo</strong>:<br />
<code>COMFENALCO_EDUCACION\01.Scripts\Utils</code></p>
</li>
<li>
<p><strong>Argumentos del Script</strong>:<br />
<code>download.py --key EP-EDF-03</code></p>
</li>
</ol>
<hr />
<h4 id="diagrama-de-secuencia_2"><strong>Diagrama de Secuencia</strong><a class="headerlink" href="#diagrama-de-secuencia_2" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant SSIS as SSIS Package
    participant Python as Python Script

    SSIS -&gt;&gt; Python: Ejecuta `download.py --key EP-EDF-03`
    Python -&gt;&gt; Python: Descarga datos relacionados con reemplazo docente
    Python -&gt;&gt; SSIS: Reporta resultado</code></pre>
<h3 id="componente-ep-edf-04-fact_permiso_estudiante">Componente <strong><code>EP-EDF-04 FACT_PERMISO_ESTUDIANTE</code></strong><a class="headerlink" href="#componente-ep-edf-04-fact_permiso_estudiante" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_3"><strong>Descripción General</strong><a class="headerlink" href="#descripcion-general_3" title="Permanent link">&para;</a></h4>
<p>La tarea <code>EP-EDF-04 FACT_PERMISO_ESTUDIANTE</code> es un componente que ejecuta un script de Python para descargar datos relacionados con permisos estudiantiles. Este componente utiliza variables dinámicas de proyecto para definir tanto el ejecutable como el directorio de trabajo, asegurando flexibilidad y adaptabilidad al entorno.</p>
<hr />
<p><strong>Detalles del Componente</strong></p>
<table>
<thead>
<tr>
<th>Propiedad</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Nombre del Componente</strong></td>
<td>EP-EDF-04 FACT_PERMISO_ESTUDIANTE</td>
</tr>
<tr>
<td><strong>Tipo</strong></td>
<td>Execute Process Task</td>
</tr>
<tr>
<td><strong>Descripción</strong></td>
<td>Ejecuta un script de Python que descarga datos relacionados con permisos estudiantiles.</td>
</tr>
<tr>
<td><strong>ID del Componente</strong></td>
<td><code>{2c32b9c0-798a-4bd5-a1e9-8b0351f2e222}</code></td>
</tr>
</tbody>
</table>
<hr />
<p><strong>Propiedades Principales</strong></p>
<p><strong>Detalles del Componente</strong></p>
<table>
<thead>
<tr>
<th>Propiedad</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Ruta Ejecutable</strong></td>
<td><code>@[$Project::Python_Executable]</code></td>
</tr>
<tr>
<td><strong>Directorio</strong></td>
<td><code>@[$Project::Working_Directory] + "\\COMFENALCO_EDUCACION\\01.Scripts\\Utils"</code></td>
</tr>
<tr>
<td><strong>Argumentos</strong></td>
<td><code>download.py --key EP-EDF-04</code></td>
</tr>
<tr>
<td><strong>Tiempo de Espera</strong></td>
<td>No especificado (valor predeterminado).</td>
</tr>
<tr>
<td><strong>ThreadHint</strong></td>
<td><code>0</code></td>
</tr>
</tbody>
</table>
<h4 id="detalles-de-ejecucion_3"><strong>Detalles de Ejecución</strong><a class="headerlink" href="#detalles-de-ejecucion_3" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Ruta del Ejecutable</strong>:<br />
<code>COMFENALCO_EDUCACION\01.Scripts\Utils\env\Scripts\python.exe</code></p>
</li>
<li>
<p><strong>Directorio de Trabajo</strong>:<br />
<code>COMFENALCO_EDUCACION\01.Scripts\Utils</code></p>
</li>
<li>
<p><strong>Argumentos del Script</strong>:<br />
<code>download.py --key EP-EDF-04</code></p>
</li>
</ol>
<hr />
<h4 id="diagrama-de-secuencia_3"><strong>Diagrama de Secuencia</strong><a class="headerlink" href="#diagrama-de-secuencia_3" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant SSIS as SSIS Package
    participant Python as Python Script

    SSIS -&gt;&gt; Python: Ejecuta `download.py --key EP-EDF-04`
    Python -&gt;&gt; Python: Descarga datos relacionados con permisos estudiantiles
    Python -&gt;&gt; SSIS: Reporta resultado</code></pre>
<h3 id="componente-ep-edf-05-fact_biblioteca">Componente <strong><code>EP-EDF-05 FACT_BIBLIOTECA</code></strong><a class="headerlink" href="#componente-ep-edf-05-fact_biblioteca" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_4"><strong>Descripción General</strong><a class="headerlink" href="#descripcion-general_4" title="Permanent link">&para;</a></h4>
<p>La tarea <code>EP-EDF-05 FACT_BIBLIOTECA</code> es un componente que ejecuta un script de Python diseñado para gestionar datos relacionados con la biblioteca del sistema. Este componente utiliza variables dinámicas de proyecto para configurar el ejecutable y el directorio de trabajo, proporcionando flexibilidad en diferentes entornos.</p>
<hr />
<p><strong>Detalles del Componente</strong></p>
<table>
<thead>
<tr>
<th>Propiedad</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Nombre del Componente</strong></td>
<td>EP-EDF-05 FACT_BIBLIOTECA</td>
</tr>
<tr>
<td><strong>Tipo</strong></td>
<td>Execute Process Task</td>
</tr>
<tr>
<td><strong>Descripción</strong></td>
<td>Ejecuta un script de Python para gestionar datos de la biblioteca.</td>
</tr>
<tr>
<td><strong>ID del Componente</strong></td>
<td><code>{93de8c31-f735-482b-9d44-ae33924b8a70}</code></td>
</tr>
</tbody>
</table>
<hr />
<p><strong>Propiedades Principales</strong></p>
<p><strong>Detalles del Componente</strong></p>
<table>
<thead>
<tr>
<th>Propiedad</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Ruta Ejecutable</strong></td>
<td><code>@[$Project::Python_Executable]</code></td>
</tr>
<tr>
<td><strong>Directorio</strong></td>
<td><code>@[$Project::Working_Directory] + "\\COMFENALCO_EDUCACION\\01.Scripts\\Utils"</code></td>
</tr>
<tr>
<td><strong>Argumentos</strong></td>
<td><code>download.py --key EP-EDF-05</code></td>
</tr>
<tr>
<td><strong>Tiempo de Espera</strong></td>
<td>No especificado (valor predeterminado).</td>
</tr>
<tr>
<td><strong>ThreadHint</strong></td>
<td><code>0</code></td>
</tr>
</tbody>
</table>
<h4 id="detalles-de-ejecucion_4"><strong>Detalles de Ejecución</strong><a class="headerlink" href="#detalles-de-ejecucion_4" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Ruta del Ejecutable</strong>:<br />
<code>COMFENALCO_EDUCACION\01.Scripts\Utils\env\Scripts\python.exe</code></p>
</li>
<li>
<p><strong>Directorio de Trabajo</strong>:<br />
<code>COMFENALCO_EDUCACION\01.Scripts\Utils</code></p>
</li>
<li>
<p><strong>Argumentos del Script</strong>:<br />
<code>download.py --key EP-EDF-05</code></p>
</li>
</ol>
<hr />
<h4 id="diagrama-de-secuencia_4"><strong>Diagrama de Secuencia</strong><a class="headerlink" href="#diagrama-de-secuencia_4" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant SSIS as SSIS Package
    participant Python as Python Script

    SSIS -&gt;&gt; Python: Ejecuta `download.py --key EP-EDF-05`
    Python -&gt;&gt; Python: Descarga datos de la biblioteca
    Python -&gt;&gt; SSIS: Reporta resultado</code></pre>
<h3 id="componente-ep-edf-06-fact_biblioteca_virtual">Componente <strong><code>EP-EDF-06 FACT_BIBLIOTECA_VIRTUAL</code></strong><a class="headerlink" href="#componente-ep-edf-06-fact_biblioteca_virtual" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_5"><strong>Descripción General</strong><a class="headerlink" href="#descripcion-general_5" title="Permanent link">&para;</a></h4>
<p>El componente <code>EP-EDF-06 FACT_BIBLIOTECA_VIRTUAL</code> está diseñado para ejecutar un script de Python que gestiona la descarga de datos relacionados con la biblioteca virtual en el sistema. Este componente utiliza propiedades dinámicas configuradas a nivel de proyecto, lo que permite flexibilidad en su uso en diferentes entornos.</p>
<p><strong>Detalles del Componente</strong></p>
<table>
<thead>
<tr>
<th>Propiedad</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Nombre del Componente</strong></td>
<td>EP-EDF-06 FACT_BIBLIOTECA_VIRTUAL</td>
</tr>
<tr>
<td><strong>Tipo</strong></td>
<td>Execute Process Task</td>
</tr>
<tr>
<td><strong>Descripción</strong></td>
<td>Ejecuta un script de Python para gestionar datos de la biblioteca virtual.</td>
</tr>
<tr>
<td><strong>ID del Componente</strong></td>
<td><code>{d22a6787-565a-4722-8ab0-acea586c4bfd}</code></td>
</tr>
</tbody>
</table>
<hr />
<p><strong>Propiedades Principales</strong></p>
<p><strong>Detalles del Componente</strong></p>
<table>
<thead>
<tr>
<th>Propiedad</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Ruta Ejecutable</strong></td>
<td><code>@[$Project::Python_Executable]</code></td>
</tr>
<tr>
<td><strong>Directorio</strong></td>
<td><code>@[$Project::Working_Directory] + "\\COMFENALCO_EDUCACION\\01.Scripts\\Utils"</code></td>
</tr>
<tr>
<td><strong>Argumentos</strong></td>
<td><code>download.py --key EP-EDF-06</code></td>
</tr>
<tr>
<td><strong>Tiempo de Espera</strong></td>
<td>No especificado (valor predeterminado).</td>
</tr>
<tr>
<td><strong>ThreadHint</strong></td>
<td><code>0</code></td>
</tr>
</tbody>
</table>
<h4 id="detalles-de-ejecucion_5"><strong>Detalles de Ejecución</strong><a class="headerlink" href="#detalles-de-ejecucion_5" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Ruta del Ejecutable</strong>:<br />
<code>COMFENALCO_EDUCACION\01.Scripts\Utils\env\Scripts\python.exe</code></p>
</li>
<li>
<p><strong>Directorio de Trabajo</strong>:<br />
<code>COMFENALCO_EDUCACION\01.Scripts\Utils</code></p>
</li>
<li>
<p><strong>Argumentos del Script</strong>:<br />
<code>download.py --key EP-EDF-06</code></p>
</li>
</ol>
<hr />
<h4 id="diagrama-de-secuencia_5"><strong>Diagrama de Secuencia</strong><a class="headerlink" href="#diagrama-de-secuencia_5" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant SSIS as SSIS Package
    participant Python as Python Script

    SSIS -&gt;&gt; Python: Ejecuta `download.py --key EP-EDF-06`
    Python -&gt;&gt; Python: Descarga datos de la biblioteca virtual
    Python -&gt;&gt; SSIS: Reporta resultado</code></pre>
<h3 id="componente-ep-edf-07-fact_saber11_individual">Componente <strong><code>EP-EDF-07 FACT_SABER11_INDIVIDUAL</code></strong><a class="headerlink" href="#componente-ep-edf-07-fact_saber11_individual" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_6"><strong>Descripción General</strong><a class="headerlink" href="#descripcion-general_6" title="Permanent link">&para;</a></h4>
<p>El componente <code>EP-EDF-07 FACT_SABER11_INDIVIDUAL</code> ejecuta un script de Python que gestiona la descarga y procesamiento de información relacionada con las evaluaciones Saber 11 individuales. Este componente utiliza variables de proyecto para configurar el ejecutable y el directorio de trabajo, lo que garantiza flexibilidad en diferentes entornos.</p>
<hr />
<p><strong>Detalles del Componente</strong></p>
<table>
<thead>
<tr>
<th>Propiedad</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Nombre del Componente</strong></td>
<td>EP-EDF-07 FACT_SABER11_INDIVIDUAL</td>
</tr>
<tr>
<td><strong>Tipo</strong></td>
<td>Execute Process Task</td>
</tr>
<tr>
<td><strong>Descripción</strong></td>
<td>Ejecuta un script de Python para gestionar datos de evaluaciones Saber 11 individuales.</td>
</tr>
<tr>
<td><strong>ID del Componente</strong></td>
<td><code>{47f926b0-8b2b-497d-bed6-90dc0e6f9d7c}</code></td>
</tr>
</tbody>
</table>
<hr />
<p><strong>Propiedades Principales</strong></p>
<table>
<thead>
<tr>
<th>Propiedad</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Ruta Ejecutable</strong></td>
<td><code>@[$Project::Python_Executable]</code></td>
</tr>
<tr>
<td><strong>Directorio</strong></td>
<td><code>@[$Project::Working_Directory] + "\\COMFENALCO_EDUCACION\\01.Scripts\\Utils"</code></td>
</tr>
<tr>
<td><strong>Argumentos</strong></td>
<td><code>download.py --key EP-EDF-07</code></td>
</tr>
<tr>
<td><strong>Tiempo de Espera</strong></td>
<td>No especificado (valor predeterminado).</td>
</tr>
<tr>
<td><strong>ThreadHint</strong></td>
<td><code>0</code></td>
</tr>
</tbody>
</table>
<h4 id="detalles-de-ejecucion_6"><strong>Detalles de Ejecución</strong><a class="headerlink" href="#detalles-de-ejecucion_6" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Ruta del Ejecutable</strong>:<br />
<code>COMFENALCO_EDUCACION\01.Scripts\Utils\env\Scripts\python.exe</code></p>
</li>
<li>
<p><strong>Directorio de Trabajo</strong>:<br />
<code>COMFENALCO_EDUCACION\01.Scripts\Utils</code></p>
</li>
<li>
<p><strong>Argumentos del Script</strong>:<br />
<code>download.py --key EP-EDF-07</code></p>
</li>
</ol>
<hr />
<h4 id="diagrama-de-secuencia_6"><strong>Diagrama de Secuencia</strong><a class="headerlink" href="#diagrama-de-secuencia_6" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant SSIS as SSIS Package
    participant Python as Python Script

    SSIS -&gt;&gt; Python: Ejecuta `download.py --key EP-EDF-07`
    Python -&gt;&gt; Python: Descarga y procesa datos de evaluaciones Saber 11
    Python -&gt;&gt; SSIS: Reporta resultado</code></pre>
<h3 id="componente-procesar-fact_transporte">Componente <strong><code>Procesar FACT_TRANSPORTE</code></strong><a class="headerlink" href="#componente-procesar-fact_transporte" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_7">Descripción General<a class="headerlink" href="#descripcion-general_7" title="Permanent link">&para;</a></h4>
<p>El componente <code>Procesar FACT_TRANSPORTE</code> es una tarea de flujo de datos en un paquete SSIS que realiza procesos ETL para gestionar información de transporte. Este flujo extrae datos de SAP, realiza transformaciones mediante conversiones, divisiones condicionales y búsquedas, y finalmente carga los datos procesados en una base de datos destino.</p>
<hr />
<h4 id="componentes-del-flujo-de-datos">Componentes del Flujo de Datos<a class="headerlink" href="#componentes-del-flujo-de-datos" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>Fuente de Datos ADO.NET (<code>FACT_TRANSPORTE SAP</code>)</strong><ul>
<li><strong>Descripción</strong>: Extrae datos de SAP mediante una consulta SQL.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>SqlCommand</code>: 
  <div class="highlight"><pre><span></span><code><span class="k">WITH</span><span class="w"> </span><span class="n">TransportDetails</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">OBJID</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">OBJETO_SAP_ESTUDIANTE</span><span class="p">,</span><span class="w"> </span><span class="n">BEGDA</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">FECHA_INICIO_SERVICIO</span><span class="p">,</span><span class="w"> </span>
<span class="w">           </span><span class="n">ENDDA</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">FECHA_FIN_SERVICIO</span><span class="p">,</span><span class="w"> </span><span class="n">BENCAT</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">CATEGORIA_SERVICIO</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">hrp1706</span><span class="w"> </span><span class="n">hh</span>
<span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">PLVAR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;01&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">otype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ST&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">PDISCT2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;TRAN&#39;</span>
<span class="p">),</span><span class="w"> </span>
<span class="n">StudentKeys</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">objid</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">OBJETO_SAP_ESTUDIANTE</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">short</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">NUMERO_MATRICULA</span><span class="p">,</span>
<span class="w">           </span><span class="n">b</span><span class="p">.</span><span class="n">PARTNER</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PARTNER_ESTUDIANTE</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">HRP1000</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">a</span>
<span class="w">    </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">CMACBPST</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">objid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">stobjid</span>
<span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">plvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">otype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ST&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">endda</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">CURDATE</span><span class="p">()</span>
<span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">PARTNER_ESTUDIANTE</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">FECHA_INICIO_SERVICIO</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ID_FECHA</span><span class="p">,</span>
<span class="w">       </span><span class="k">YEAR</span><span class="p">(</span><span class="n">TO_DATE</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">FECHA_INICIO_SERVICIO</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;YYYYMMDD&#39;</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ANIO_ACADEMICO</span><span class="p">,</span>
<span class="w">       </span><span class="n">TO_DATE</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">FECHA_INICIO_SERVICIO</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;YYYYMMDD&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">FECHA_INICIO_SERVICIO</span><span class="p">,</span>
<span class="w">       </span><span class="n">TO_DATE</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">FECHA_FIN_SERVICIO</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;YYYYMMDD&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">FECHA_FIN_SERVICIO</span><span class="p">,</span>
<span class="w">       </span><span class="n">t</span><span class="p">.</span><span class="n">CATEGORIA_SERVICIO</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SI&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">SERVICIO_TRANSPORTE</span><span class="p">,</span>
<span class="w">       </span><span class="n">s</span><span class="p">.</span><span class="n">PARTNER_ESTUDIANTE</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">TO_CHAR</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">FECHA_INICIO_SERVICIO</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;YYYYMMDD&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ID_REGISTRO_AUXILIAR</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">TransportDetails</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">StudentKeys</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">S</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">OBJETO_SAP_ESTUDIANTE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">OBJETO_SAP_ESTUDIANTE</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">FECHA_INICIO_SERVICIO</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="s1">&#39;20230101&#39;</span>
</code></pre></div></li>
<li><code>CommandTimeout</code>: <code>30</code></li>
</ul>
</li>
<li><strong>Conexiones</strong>:<ul>
<li><code>IDbConnection</code>: Conexión a SAP referenciada por <code>SAP_ERP</code>.</li>
</ul>
</li>
<li><strong>Columnas de Salida</strong>:<ul>
<li><code>PARTNER_ESTUDIANTE</code>, <code>ID_FECHA</code>, <code>ANIO_ACADEMICO</code>, <code>FECHA_INICIO_SERVICIO</code>, <code>FECHA_FIN_SERVICIO</code>, <code>CATEGORIA_SERVICIO</code>, <code>SERVICIO_TRANSPORTE</code>, <code>ID_REGISTRO_AUXILIAR</code>.</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr />
<ol>
<li><strong>Conversión de Datos (<code>Data Conversion</code>)</strong><ul>
<li><strong>Descripción</strong>: Convierte columnas de entrada para garantizar compatibilidad con componentes posteriores.</li>
<li><strong>Columnas de Entrada</strong>:<ul>
<li><code>PARTNER_ESTUDIANTE</code>, <code>ID_FECHA</code>, <code>ANIO_ACADEMICO</code>, <code>FECHA_INICIO_SERVICIO</code>, <code>FECHA_FIN_SERVICIO</code>, <code>SERVICIO_TRANSPORTE</code>, <code>ID_REGISTRO_AUXILIAR</code>.</li>
</ul>
</li>
<li><strong>Columnas de Salida</strong>:<ul>
<li><code>Copy of PARTNER_ESTUDIANTE</code>, <code>Copy of ANIO_ACADEMICO</code>, <code>Copy of FECHA_INICIO_SERVICIO</code>, <code>Copy of FECHA_FIN_SERVICIO</code>, <code>Copy of SERVICIO_TRANSPORTE</code>, <code>Copy of ID_REGISTRO_AUXILIAR</code>.</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr />
<ol>
<li><strong>Búsquedas (<code>Lookup</code>)</strong><ul>
<li><strong>Lookup <code>1</code>:</strong><ul>
<li><strong>Descripción</strong>: Realiza una búsqueda en la tabla <code>DIM_TARIFAS_SERVICIOS</code>.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>SqlCommand</code>:
  <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="p">[</span><span class="n">ID_TARIFA</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">CON_OBJETO_TARIFA</span><span class="p">],</span><span class="w"> </span><span class="k">CAST</span><span class="p">([</span><span class="n">ANIO_TARIFA</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INT</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">[</span><span class="n">ANIO_TARIFA</span><span class="p">]</span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_TARIFAS_SERVICIOS</span><span class="p">]</span>
<span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">COD_INFRAESTRUCTURA_CCF</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;CCF008-12-00001&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">UPPER</span><span class="p">([</span><span class="n">CON_OBJETO_TARIFA</span><span class="p">])</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="s1">&#39;%TRANSPORTE%&#39;</span>
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li><strong>Lookup <code>2</code>:</strong><ul>
<li><strong>Descripción</strong>: Busca en <code>FACT_TRANSPORTE</code> utilizando la columna <code>ID_REGISTRO_AUXILIAR</code>.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>SqlCommand</code>:
  <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="p">[</span><span class="n">ID_REGISTRO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">BP_ESTUDIANTE</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">ID_FECHA</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">BP_ESTUDIANTE</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">CONVERT</span><span class="p">(</span><span class="nb">VARCHAR</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">ID_FECHA</span><span class="p">],</span><span class="w"> </span><span class="mi">112</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">[</span><span class="n">ID_REGISTRO_AUXILIAR</span><span class="p">]</span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">FACT_TRANSPORTE</span><span class="p">]</span>
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr />
<ol>
<li><strong>División Condicional (<code>Conditional Split</code>)</strong><ul>
<li><strong>Descripción</strong>: Separa filas en salidas distintas según condiciones específicas.</li>
<li><strong>Condiciones</strong>:<ul>
<li>Agregar: <code>!ISNULL(ID_TARIFA)</code></li>
<li>No Agregar: Filas que no cumplen con la condición anterior.</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr />
<ol>
<li><strong>Destino de Datos ADO.NET (<code>FACT_TRANSPORTE_DEST</code>)</strong><ul>
<li><strong>Descripción</strong>: Carga los datos procesados en la tabla <code>FACT_TRANSPORTE</code>.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>TableOrViewName</code>: <code>"Colegio"."FACT_TRANSPORTE"</code></li>
<li><code>BatchSize</code>: <code>0</code></li>
<li><code>CommandTimeout</code>: <code>30</code></li>
</ul>
</li>
<li><strong>Columnas de Entrada</strong>:<ul>
<li><code>Copy of PARTNER_ESTUDIANTE</code>, <code>Copy of ANIO_ACADEMICO</code>, <code>Copy of FECHA_INICIO_SERVICIO</code>, <code>Copy of FECHA_FIN_SERVICIO</code>, <code>Copy of SERVICIO_TRANSPORTE</code>.</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr />
<h4 id="diagrama-de-secuencia_7">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia_7" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant Source as FACT_TRANSPORTE SAP (Fuente)
    participant DataConversion as Data Conversion
    participant Lookup1 as Lookup 1
    participant ConditionalSplit as Conditional Split
    participant Lookup2 as Lookup 2
    participant Destination as FACT_TRANSPORTE_DEST (Destino)

    Source -&gt;&gt; DataConversion: Datos extraídos
    DataConversion -&gt;&gt; Lookup1: Datos convertidos
    Lookup1 -&gt;&gt; ConditionalSplit: Datos enriquecidos
    ConditionalSplit -&gt;&gt; Lookup2: Filas seleccionadas
    Lookup2 -&gt;&gt; Destination: Datos finales</code></pre>
<h3 id="componente-procesar-fact_cupos_negados">Componente <strong><code>Procesar FACT_CUPOS_NEGADOS</code></strong><a class="headerlink" href="#componente-procesar-fact_cupos_negados" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_8">Descripción General<a class="headerlink" href="#descripcion-general_8" title="Permanent link">&para;</a></h4>
<p>El componente <code>Procesar FACT_CUPOS_NEGADOS</code> es un flujo de datos en un paquete SSIS que gestiona el procesamiento de información relacionada con cupos negados para estudiantes. Este flujo incluye extracción de datos desde SAP, transformaciones mediante conversiones, búsquedas y derivación de columnas, finalizando con la carga de datos en una base de datos destino.</p>
<hr />
<h4 id="componentes-del-flujo-de-datos_1">Componentes del Flujo de Datos<a class="headerlink" href="#componentes-del-flujo-de-datos_1" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>Fuente de Datos ADO.NET (<code>FACT_CUPOS NEGADOS SAP</code>)</strong><ul>
<li><strong>Descripción</strong>: Extrae datos desde SAP utilizando una consulta SQL.</li>
<li><strong>Propiedades</strong>:<ul>
<li><strong>Consulta SQL</strong>:
  <div class="highlight"><pre><span></span><code><span class="k">WITH</span><span class="w"> </span><span class="n">StudentKeys</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">objid</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">OBJETO_SAP_ESTUDIANTE</span><span class="p">,</span><span class="w"> </span>
<span class="w">           </span><span class="n">a</span><span class="p">.</span><span class="n">short</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">NUMERO_MATRICULA</span><span class="p">,</span>
<span class="w">           </span><span class="n">b</span><span class="p">.</span><span class="n">PARTNER</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PARTNER_ESTUDIANTE</span><span class="p">,</span>
<span class="w">           </span><span class="n">a</span><span class="p">.</span><span class="n">STEXT</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">NOMBRE_ESTUDIANTE</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">HRP1000</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">a</span>
<span class="w">    </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">CMACBPST</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">objid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">stobjid</span>
<span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">plvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">otype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ST&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">a</span><span class="p">.</span><span class="n">endda</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">CURDATE</span><span class="p">()</span>
<span class="p">),</span>
<span class="n">DeniedStudents</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="n">OBJID</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">OBJETO_SAP_ESTUDIANTE</span><span class="p">,</span><span class="w"> </span>
<span class="w">           </span><span class="n">HS_PERYR</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ANIO_ACADEMICO</span><span class="p">,</span><span class="w"> </span>
<span class="w">           </span><span class="n">AEDTM</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">FECHA_ESTADO</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">HRP1728</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">h</span>
<span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">plvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;01&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">otype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ST&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">SUBTY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;9060&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">HS_STATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;A&#39;</span>
<span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="n">sk</span><span class="p">.</span><span class="n">NUMERO_MATRICULA</span><span class="p">,</span><span class="w"> </span><span class="n">sk</span><span class="p">.</span><span class="n">PARTNER_ESTUDIANTE</span><span class="p">,</span><span class="w"> </span><span class="n">sk</span><span class="p">.</span><span class="n">OBJETO_SAP_ESTUDIANTE</span><span class="p">,</span><span class="w"> </span>
<span class="w">       </span><span class="n">sk</span><span class="p">.</span><span class="n">NOMBRE_ESTUDIANTE</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">ANIO_ACADEMICO</span><span class="p">,</span><span class="w"> </span>
<span class="w">       </span><span class="n">TO_DATE</span><span class="p">(</span><span class="n">d</span><span class="p">.</span><span class="n">FECHA_ESTADO</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;YYYYMMDD&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">FECHA_ESTADO</span><span class="p">,</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">FECHA_ESTADO</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ID_FECHA</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">DeniedStudents</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">d</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">StudentKeys</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">sk</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="n">OBJETO_SAP_ESTUDIANTE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sk</span><span class="p">.</span><span class="n">OBJETO_SAP_ESTUDIANTE</span>
</code></pre></div></li>
<li><strong>Conexión</strong>: Referencia a <code>SAP_ERP</code>.</li>
<li><strong>Tiempo de espera</strong>: <code>30</code> segundos.</li>
</ul>
</li>
<li><strong>Columnas de Salida</strong>:<ul>
<li><code>NUMERO_MATRICULA</code>, <code>PARTNER_ESTUDIANTE</code>, <code>OBJETO_SAP_ESTUDIANTE</code>, <code>NOMBRE_ESTUDIANTE</code>, <code>ANIO_ACADEMICO</code>, <code>FECHA_ESTADO</code>, <code>ID_FECHA</code>.</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr />
<ol>
<li><strong>Conversión de Datos (<code>Data Conversion</code>)</strong><ul>
<li><strong>Descripción</strong>: Convierte columnas de entrada a tipos y longitudes compatibles con otros componentes.</li>
<li><strong>Columnas de Entrada</strong>:<ul>
<li><code>NUMERO_MATRICULA</code>, <code>PARTNER_ESTUDIANTE</code>, <code>OBJETO_SAP_ESTUDIANTE</code>, <code>NOMBRE_ESTUDIANTE</code>, <code>ANIO_ACADEMICO</code>, <code>FECHA_ESTADO</code>, <code>ID_FECHA</code>.</li>
</ul>
</li>
<li><strong>Columnas de Salida</strong>:<ul>
<li><code>Copy of NUMERO_MATRICULA</code>, <code>Copy of PARTNER_ESTUDIANTE</code>, <code>Copy of OBJETO_SAP_ESTUDIANTE</code>, <code>Copy of NOMBRE_ESTUDIANTE</code>, <code>Copy of ANIO_ACADEMICO</code>, <code>Copy of FECHA_ESTADO</code>, <code>Copy of ID_FECHA</code>.</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr />
<ol>
<li><strong>Búsqueda (<code>Lookup</code>)</strong><ul>
<li><strong>Descripción</strong>: Busca datos adicionales en la tabla <code>DIM_POBLACION_MATRICULA</code>.</li>
<li><strong>Propiedades</strong>:<ul>
<li><strong>Consulta SQL</strong>:
  <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_POBLACION_MATRICULA</span><span class="p">]</span>
</code></pre></div></li>
<li><strong>Columna de Unión</strong>: <code>PARTNER</code>.</li>
</ul>
</li>
<li><strong>Columnas de Salida</strong>:<ul>
<li><code>ID_POBLACION_MATRICULA</code>.</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr />
<ol>
<li><strong>Columna Derivada (<code>Derived Column</code>)</strong><ul>
<li><strong>Descripción</strong>: Calcula o asigna valores a columnas existentes o nuevas basándose en condiciones.</li>
<li><strong>Expresión</strong>:
  <div class="highlight"><pre><span></span><code><span class="k">ISNULL</span><span class="p">(</span><span class="n">ID_POBLACION_MATRICULA</span><span class="p">)</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ID_POBLACION_MATRICULA</span>
</code></pre></div></li>
<li><strong>Columna Derivada</strong>:<ul>
<li><code>ID_POBLACION_MATRICULA</code>.</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr />
<ol>
<li><strong>Destino de Datos ADO.NET (<code>Destino de ADO NET</code>)</strong><ul>
<li><strong>Descripción</strong>: Carga los datos procesados en la tabla <code>FACT_CUPOS_NEGADOS</code>.</li>
<li><strong>Propiedades</strong>:<ul>
<li><strong>Nombre de la tabla</strong>: <code>"Colegio"."FACT_CUPOS_NEGADOS"</code>.</li>
<li><strong>BatchSize</strong>: <code>0</code> (tamaño predeterminado del búfer interno).</li>
<li><strong>Tiempo de espera</strong>: <code>30</code> segundos.</li>
</ul>
</li>
<li><strong>Columnas de Entrada</strong>:<ul>
<li><code>Copy of NUMERO_MATRICULA</code>, <code>Copy of PARTNER_ESTUDIANTE</code>, <code>Copy of OBJETO_SAP_ESTUDIANTE</code>, <code>Copy of NOMBRE_ESTUDIANTE</code>, <code>Copy of ANIO_ACADEMICO</code>, <code>Copy of FECHA_ESTADO</code>, <code>Copy of ID_FECHA</code>, <code>ID_POBLACION_MATRICULA</code>.</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr />
<h4 id="diagrama-de-secuencia-del-flujo">Diagrama de Secuencia del Flujo<a class="headerlink" href="#diagrama-de-secuencia-del-flujo" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant Source as FACT_CUPOS NEGADOS SAP (Fuente)
    participant DataConversion as Data Conversion
    participant Lookup as Lookup (DIM_POBLACION_MATRICULA)
    participant DerivedColumn as Derived Column
    participant Destination as FACT_CUPOS_NEGADOS (Destino)

    Source -&gt;&gt; DataConversion: Extrae datos y los convierte
    DataConversion -&gt;&gt; Lookup: Enriquecimiento con búsqueda
    Lookup -&gt;&gt; DerivedColumn: Asigna valores derivados
    DerivedColumn -&gt;&gt; Destination: Carga datos procesados</code></pre>
<h3 id="componente-crear-procedimiento">Componente <strong><code>Crear Procedimiento</code></strong><a class="headerlink" href="#componente-crear-procedimiento" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_9">Descripción General<a class="headerlink" href="#descripcion-general_9" title="Permanent link">&para;</a></h4>
<p>El componente <code>Crear Procedimiento</code> es una tarea de ejecución de SQL (<code>Execute SQL Task</code>) que permite la creación dinámica de un procedimiento almacenado en una base de datos. Antes de proceder con la creación, verifica si un procedimiento con el mismo nombre ya existe, y lo elimina si es necesario.</p>
<hr />
<p><strong>Configuración de la Tarea</strong></p>
<ol>
<li><strong>Nombre del Componente</strong>: <code>Crear Procedimiento</code></li>
<li><strong>Tipo de Tarea</strong>: <code>Microsoft.ExecuteSQLTask</code></li>
<li><strong>Conexión</strong>: Referencia a una conexión de base de datos ADO.NET (<code>{3A7D3F89-902D-4694-893E-02F1E08B0F72}</code>).</li>
<li><strong>Consulta SQL</strong>:
    <div class="highlight"><pre><span></span><code><span class="c1">-- Verificar si el procedimiento &#39;GetRetirosByYear&#39; existe y eliminarlo si es así</span>
<span class="k">DO</span>
<span class="k">BEGIN</span>
<span class="w">    </span><span class="k">DECLARE</span><span class="w"> </span><span class="n">proc_count</span><span class="w"> </span><span class="nb">INT</span><span class="p">;</span>

<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">proc_count</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">PROCEDURES</span>
<span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="n">PROCEDURE_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;GETRETIROSBYYEAR&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">SCHEMA_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CURRENT_SCHEMA</span><span class="p">;</span>

<span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="n">proc_count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">THEN</span>
<span class="w">        </span><span class="k">EXEC</span><span class="w"> </span><span class="s1">&#39;DROP PROCEDURE GETRETIROSBYYEAR&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">IF</span><span class="p">;</span>
<span class="k">END</span><span class="p">;</span>
</code></pre></div></li>
</ol>
<hr />
<p><strong>Descripción del Código SQL</strong></p>
<ol>
<li><strong>Propósito</strong>:</li>
<li>Elimina el procedimiento almacenado <code>GetRetirosByYear</code> si ya existe.</li>
<li>Garantiza que la base de datos esté limpia para crear un nuevo procedimiento.</li>
<li><strong>Operaciones Realizadas</strong>:</li>
<li><strong>Verificación</strong>:<ul>
<li>Consulta en la tabla de metadatos <code>PROCEDURES</code> si existe un procedimiento llamado <code>GETRETIROSBYYEAR</code>.</li>
</ul>
</li>
<li><strong>Eliminación</strong>:<ul>
<li>Si el procedimiento existe, se ejecuta <code>DROP PROCEDURE</code> para eliminarlo.</li>
</ul>
</li>
</ol>
<hr />
<p><strong>Conexión de Base de Datos</strong></p>
<ul>
<li><strong>Tipo de Conexión</strong>: ADO.NET.</li>
<li><strong>Identificador de Conexión</strong>: <code>{3A7D3F89-902D-4694-893E-02F1E08B0F72}</code>.</li>
</ul>
<h4 id="flujo-de-la-tarea">Flujo de la Tarea<a class="headerlink" href="#flujo-de-la-tarea" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant ExecuteSQL as Crear Procedimiento
    ExecuteSQL-&gt;&gt;DB: Verifica existencia de `GetRetirosByYear`
    alt Procedimiento Existe
        ExecuteSQL-&gt;&gt;DB: Ejecuta `DROP PROCEDURE`
    end
    ExecuteSQL-&gt;&gt;DB: Finaliza ejecución</code></pre>
<h3 id="componente-validar-si-existe-tabla-para-guardar">Componente <strong><code>Validar si existe tabla para guardar</code></strong><a class="headerlink" href="#componente-validar-si-existe-tabla-para-guardar" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_10">Descripción General<a class="headerlink" href="#descripcion-general_10" title="Permanent link">&para;</a></h4>
<p>La tarea <code>Validar si existe tabla para guardar</code> es una ejecución de SQL que verifica la existencia de una tabla específica (<code>RESULTS</code>) en la base de datos. Si esta tabla existe, la tarea procede a eliminarla, asegurando que el espacio para almacenar datos esté limpio antes de realizar nuevas inserciones o procesos.</p>
<hr />
<p><strong>Configuración de la Tarea</strong></p>
<ol>
<li><strong>Nombre del Componente</strong>: <code>Validar si existe tabla para guardar</code></li>
<li><strong>Tipo de Tarea</strong>: <code>Microsoft.ExecuteSQLTask</code></li>
<li><strong>Conexión</strong>: Referencia a una conexión de base de datos ADO.NET (<code>{3A7D3F89-902D-4694-893E-02F1E08B0F72}</code>).</li>
<li><strong>Consulta SQL</strong>:
    <div class="highlight"><pre><span></span><code><span class="c1">-- Verificar si la tabla &#39;RESULTS&#39; existe y eliminarla si es así</span>
<span class="k">DO</span>
<span class="k">BEGIN</span>
<span class="w">    </span><span class="k">DECLARE</span><span class="w"> </span><span class="n">table_count</span><span class="w"> </span><span class="nb">INT</span><span class="p">;</span>

<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COUNT</span><span class="p">(</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">table_count</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">TABLES</span>
<span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="k">TABLE_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;RESULTS&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="k">SCHEMA_NAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CURRENT_SCHEMA</span><span class="p">;</span>

<span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="n">table_count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">THEN</span>
<span class="w">        </span><span class="k">EXEC</span><span class="w"> </span><span class="s1">&#39;DROP TABLE RESULTS&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">IF</span><span class="p">;</span>
<span class="k">END</span><span class="p">;</span>
</code></pre></div></li>
</ol>
<hr />
<p><strong>Descripción del Código SQL</strong></p>
<ol>
<li><strong>Propósito</strong>:</li>
<li>Garantiza que no existan conflictos al trabajar con la tabla <code>RESULTS</code>.</li>
<li>
<p>Elimina la tabla si ya existe para permitir la creación de una nueva o reutilización sin conflictos.</p>
</li>
<li>
<p><strong>Operaciones Realizadas</strong>:</p>
</li>
<li><strong>Verificación</strong>:<ul>
<li>Consulta en la tabla de metadatos <code>TABLES</code> si existe una tabla llamada <code>RESULTS</code>.</li>
</ul>
</li>
<li><strong>Eliminación</strong>:<ul>
<li>Si la tabla existe, ejecuta <code>DROP TABLE RESULTS</code> para eliminarla.</li>
</ul>
</li>
</ol>
<hr />
<p><strong>Conexión de Base de Datos</strong></p>
<ul>
<li><strong>Tipo de Conexión</strong>: ADO.NET.</li>
<li><strong>Identificador de Conexión</strong>: <code>{3A7D3F89-902D-4694-893E-02F1E08B0F72}</code>.</li>
</ul>
<h4 id="flujo-de-la-tarea_1">Flujo de la Tarea<a class="headerlink" href="#flujo-de-la-tarea_1" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant ExecuteSQL as Validar si existe tabla
    ExecuteSQL-&gt;&gt;DB: Verifica existencia de `RESULTS`
    alt Tabla Existe
        ExecuteSQL-&gt;&gt;DB: Ejecuta `DROP TABLE RESULTS`
    end
    ExecuteSQL-&gt;&gt;DB: Finaliza ejecución</code></pre>
<h3 id="componente-crear-tabla">Componente <strong><code>Crear Tabla</code></strong><a class="headerlink" href="#componente-crear-tabla" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_11">Descripción General<a class="headerlink" href="#descripcion-general_11" title="Permanent link">&para;</a></h4>
<p>La tarea <code>Crear Tabla</code> es una ejecución de SQL destinada a crear la tabla <code>RESULTS</code> en la base de datos. Esta tabla servirá para almacenar de forma persistente los resultados procesados. Este paso asegura que exista una estructura adecuada para recibir datos y facilita la validación y manipulación posterior de los mismos.</p>
<hr />
<p><strong>Configuración de la Tarea</strong></p>
<ol>
<li><strong>Nombre del Componente</strong>: <code>Crear Tabla</code></li>
<li><strong>Tipo de Tarea</strong>: <code>Microsoft.ExecuteSQLTask</code></li>
<li><strong>Conexión</strong>: Referencia a una conexión de base de datos ADO.NET (<code>{3A7D3F89-902D-4694-893E-02F1E08B0F72}</code>).</li>
<li><strong>Consulta SQL</strong>:
    <div class="highlight"><pre><span></span><code><span class="c1">-- Crear la tabla persistente para almacenar los resultados</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">RESULTS</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">OBJETO_SAP_ESTUDIANTE</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="w">    </span><span class="n">NUMERO_MATRICULA</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="w">    </span><span class="n">PARTNER_ESTUDIANTE</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="w">    </span><span class="n">ANIO_ACADEMICO</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="w">    </span><span class="n">APELLIDOS</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="n">NOMBRES</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="n">CURSO</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="w">    </span><span class="n">GRADO</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="w">    </span><span class="n">FECHA_RETIRO_SAP</span><span class="w"> </span><span class="nb">DATE</span><span class="p">,</span>
<span class="w">    </span><span class="n">FECHA_VALIDO_DESDE</span><span class="w"> </span><span class="nb">DATE</span><span class="p">,</span>
<span class="w">    </span><span class="n">FECHA_VALIDO_HASTA</span><span class="w"> </span><span class="nb">DATE</span>
<span class="p">);</span>
</code></pre></div></li>
</ol>
<hr />
<p><strong>Descripción del Código SQL</strong></p>
<ol>
<li>
<p><strong>Propósito</strong>:</p>
<ul>
<li>Define la estructura de la tabla <code>RESULTS</code> para almacenar datos relacionados con los retiros de estudiantes.</li>
</ul>
</li>
<li>
<p><strong>Estructura de la Tabla</strong>:</p>
<ul>
<li><strong>Columnas</strong>:<ul>
<li><code>OBJETO_SAP_ESTUDIANTE</code>: Identificador único del estudiante en SAP.</li>
<li><code>NUMERO_MATRICULA</code>: Matrícula del estudiante.</li>
<li><code>PARTNER_ESTUDIANTE</code>: Partner asociado al estudiante.</li>
<li><code>ANIO_ACADEMICO</code>: Año académico del registro.</li>
<li><code>APELLIDOS</code>: Apellidos del estudiante.</li>
<li><code>NOMBRES</code>: Nombres del estudiante.</li>
<li><code>CURSO</code>: Curso del estudiante.</li>
<li><code>GRADO</code>: Grado académico del estudiante.</li>
<li><code>FECHA_RETIRO_SAP</code>: Fecha del retiro registrada en SAP.</li>
<li><code>FECHA_VALIDO_DESDE</code>: Fecha de inicio de validez.</li>
<li><code>FECHA_VALIDO_HASTA</code>: Fecha de fin de validez.</li>
</ul>
</li>
</ul>
</li>
</ol>
<hr />
<p><strong>Conexión de Base de Datos</strong></p>
<ul>
<li><strong>Tipo de Conexión</strong>: ADO.NET.</li>
<li><strong>Identificador de Conexión</strong>: <code>{3A7D3F89-902D-4694-893E-02F1E08B0F72}</code>.</li>
</ul>
<hr />
<p><strong>Notas y Recomendaciones</strong></p>
<ol>
<li>
<p><strong>Validación Previa</strong>:</p>
<ul>
<li>Antes de ejecutar esta consulta, asegúrese de que no exista ya una tabla con el nombre <code>RESULTS</code>. Si existe, debería eliminarse con una tarea previa para evitar conflictos.</li>
</ul>
</li>
<li>
<p><strong>Tipos de Datos</strong>:</p>
<ul>
<li>Verifique que los tipos de datos definidos sean los adecuados según las especificaciones del sistema y los datos que se procesarán.</li>
</ul>
</li>
<li>
<p><strong>Seguridad</strong>:</p>
<ul>
<li>Garantice que el usuario o conexión utilizada tenga permisos suficientes para crear tablas en el esquema de la base de datos.</li>
</ul>
</li>
<li>
<p><strong>Índices</strong>:</p>
<ul>
<li>Si la tabla requiere índices para mejorar el rendimiento de consultas futuras, estos pueden añadirse después de la creación de la tabla.</li>
</ul>
</li>
</ol>
<h4 id="flujo-de-la-tarea_2">Flujo de la Tarea<a class="headerlink" href="#flujo-de-la-tarea_2" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant ExecuteSQL as Crear Tabla
    ExecuteSQL-&gt;&gt;DB: Ejecuta el comando SQL `CREATE TABLE RESULTS`
    DB--&gt;&gt;ExecuteSQL: Confirma la creación de la tabla</code></pre>
<h3 id="componente-crear-procedimiento-anual">Componente <strong><code>Crear procedimiento anual</code></strong><a class="headerlink" href="#componente-crear-procedimiento-anual" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_12">Descripción General<a class="headerlink" href="#descripcion-general_12" title="Permanent link">&para;</a></h4>
<p>La tarea <code>Crear procedimiento anual</code> utiliza SQL para crear un procedimiento almacenado llamado <code>GetRetirosByYear</code>. Este procedimiento está diseñado para insertar registros relacionados con los retiros de estudiantes en la tabla <code>RESULTS</code>, basado en un año específico proporcionado como parámetro de entrada.</p>
<p><strong>Configuración de la Tarea</strong></p>
<ol>
<li><strong>Nombre del Componente</strong>: <code>Crear procedimiento anual</code></li>
<li><strong>Tipo de Tarea</strong>: <code>Microsoft.ExecuteSQLTask</code></li>
<li><strong>Conexión</strong>: Referencia a una conexión de base de datos ADO.NET (<code>{3A7D3F89-902D-4694-893E-02F1E08B0F72}</code>).</li>
<li><strong>Consulta SQL</strong>:
    <div class="highlight"><pre><span></span><code><span class="c1">-- Crear el procedimiento para obtener los retiros por año</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">PROCEDURE</span><span class="w"> </span><span class="n">GetRetirosByYear</span><span class="w"> </span><span class="p">(</span><span class="k">IN</span><span class="w"> </span><span class="n">P_YEAR</span><span class="w"> </span><span class="nb">INT</span><span class="p">)</span>
<span class="k">LANGUAGE</span><span class="w"> </span><span class="n">SQLSCRIPT</span>
<span class="k">AS</span>
<span class="k">BEGIN</span>
<span class="w">    </span><span class="k">DECLARE</span><span class="w"> </span><span class="n">valid_from_date</span><span class="w"> </span><span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">8</span><span class="p">);</span><span class="w"> </span>
<span class="w">    </span><span class="n">valid_from_date</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">CONCAT</span><span class="p">(</span><span class="n">P_YEAR</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0101&#39;</span><span class="p">);</span>

<span class="w">    </span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">RESULTS</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span>
<span class="w">        </span><span class="k">DISTINCT</span><span class="w"> </span>
<span class="w">        </span><span class="n">h</span><span class="p">.</span><span class="n">objid</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">OBJETO_SAP_ESTUDIANTE</span><span class="p">,</span>
<span class="w">        </span><span class="n">p</span><span class="p">.</span><span class="n">short</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">NUMERO_MATRICULA</span><span class="p">,</span>
<span class="w">        </span><span class="n">b</span><span class="p">.</span><span class="n">PARTNER</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">PARTNER_ESTUDIANTE</span><span class="p">,</span>
<span class="w">        </span><span class="n">o</span><span class="p">.</span><span class="n">ayear</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ANIO_ACADEMICO</span><span class="p">,</span>
<span class="w">        </span><span class="n">h</span><span class="p">.</span><span class="n">nachn</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">APELLIDOS</span><span class="p">,</span>
<span class="w">        </span><span class="n">h</span><span class="p">.</span><span class="n">vorna</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">NOMBRES</span><span class="p">,</span>
<span class="w">        </span><span class="n">i</span><span class="p">.</span><span class="n">prcl</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">CURSO</span><span class="p">,</span>
<span class="w">        </span><span class="n">j</span><span class="p">.</span><span class="n">matrikel</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">GRADO</span><span class="p">,</span>
<span class="w">        </span><span class="n">m</span><span class="p">.</span><span class="n">END_KEY_DATE</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">FECHA_RETIRO_SAP</span><span class="p">,</span>
<span class="w">        </span><span class="n">i</span><span class="p">.</span><span class="n">mc_valid_from</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">FECHA_VALIDO_DESDE</span><span class="p">,</span>
<span class="w">        </span><span class="n">i</span><span class="p">.</span><span class="n">mc_valid_to</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">FECHA_VALIDO_HASTA</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">hrp1702</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">h</span>
<span class="w">    </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">hrp1000</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">h</span><span class="p">.</span><span class="n">plvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">plvar</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">h</span><span class="p">.</span><span class="n">otype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">otype</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">h</span><span class="p">.</span><span class="n">objid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">objid</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">h</span><span class="p">.</span><span class="n">endda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">endda</span>
<span class="w">    </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">hrp1705</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">h</span><span class="p">.</span><span class="n">plvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">.</span><span class="n">plvar</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">h</span><span class="p">.</span><span class="n">otype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">.</span><span class="n">otype</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">h</span><span class="p">.</span><span class="n">objid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">.</span><span class="n">objid</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">h</span><span class="p">.</span><span class="n">endda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">.</span><span class="n">endda</span>
<span class="w">    </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">hrp1737</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">j</span><span class="p">.</span><span class="n">plvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">.</span><span class="n">plvar</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">j</span><span class="p">.</span><span class="n">otype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">.</span><span class="n">otype</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">j</span><span class="p">.</span><span class="n">objid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">.</span><span class="n">objid</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">j</span><span class="p">.</span><span class="n">endda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">.</span><span class="n">endda</span>
<span class="w">    </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">hrt1737</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">k</span><span class="p">.</span><span class="n">tabnr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="p">.</span><span class="n">tabnr</span>
<span class="w">    </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">hrp1001</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">l</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">l</span><span class="p">.</span><span class="n">plvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h</span><span class="p">.</span><span class="n">plvar</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">l</span><span class="p">.</span><span class="n">otype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h</span><span class="p">.</span><span class="n">otype</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">l</span><span class="p">.</span><span class="n">objid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h</span><span class="p">.</span><span class="n">objid</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">l</span><span class="p">.</span><span class="n">endda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h</span><span class="p">.</span><span class="n">endda</span>
<span class="w">    </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">hrp1001</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">n</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">plvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="p">.</span><span class="n">plvar</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">otype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="p">.</span><span class="n">sclas</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">objid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="p">.</span><span class="n">sobid</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">endda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">l</span><span class="p">.</span><span class="n">endda</span>
<span class="w">    </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">hrp1769</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">plvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">plvar</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">otype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">otype</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">m</span><span class="p">.</span><span class="n">objid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">objid</span>
<span class="w">    </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">hrp1771</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">plvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">plvar</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">otype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">otype</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">o</span><span class="p">.</span><span class="n">objid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">.</span><span class="n">objid</span>
<span class="w">    </span><span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">SAPABAP1</span><span class="p">.</span><span class="n">CMACBPST</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="k">On</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">objid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">.</span><span class="n">stobjid</span>
<span class="w">    </span><span class="k">WHERE</span>
<span class="w">        </span><span class="n">l</span><span class="p">.</span><span class="n">sclas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;CS&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="c1">-- CS = Estudios</span>
<span class="w">        </span><span class="n">n</span><span class="p">.</span><span class="n">sclas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;SC&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="c1">-- SC = Plan de estudios</span>
<span class="w">        </span><span class="n">p</span><span class="p">.</span><span class="n">otype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ST&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="c1">-- ST = Estudiante</span>
<span class="w">        </span><span class="n">p</span><span class="p">.</span><span class="n">plvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;01&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="c1">-- 01 – Plan activo</span>
<span class="w">        </span><span class="n">i</span><span class="p">.</span><span class="n">mc_valid_to</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">CURDATE</span><span class="p">()</span><span class="w"> </span><span class="k">AND</span>
<span class="w">        </span><span class="n">i</span><span class="p">.</span><span class="n">prog_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;4&#39;</span><span class="w"> </span><span class="k">AND</span>
<span class="w">        </span><span class="n">i</span><span class="p">.</span><span class="n">valid_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valid_from_date</span><span class="w"> </span><span class="k">AND</span>
<span class="w">        </span><span class="n">m</span><span class="p">.</span><span class="n">begda</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">CURDATE</span><span class="p">()</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="c1">-- Fec. Hoy</span>
<span class="w">        </span><span class="n">m</span><span class="p">.</span><span class="n">endda</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">CURDATE</span><span class="p">()</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="c1">-- &lt;= Fec. Hoy</span>
<span class="w">        </span><span class="n">o</span><span class="p">.</span><span class="n">prs_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="w"> </span><span class="k">AND</span>
<span class="w">        </span><span class="n">o</span><span class="p">.</span><span class="n">ayear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">P_YEAR</span><span class="w"> </span><span class="k">AND</span>
<span class="w">        </span><span class="n">m</span><span class="p">.</span><span class="n">END_PROCESS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;RW01&#39;</span><span class="w"> </span><span class="k">AND</span>
<span class="w">        </span><span class="n">m</span><span class="p">.</span><span class="n">END_KEY_DATE</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">i</span><span class="p">.</span><span class="n">valid_from</span><span class="p">;</span>
<span class="k">END</span><span class="p">;</span>
</code></pre></div></li>
</ol>
<p><strong>Descripción del Código SQL</strong></p>
<ol>
<li>
<p><strong>Propósito</strong>:</p>
<ul>
<li>Crear un procedimiento almacenado que extrae registros de estudiantes retirados basados en el año proporcionado y los inserta en la tabla <code>RESULTS</code>.</li>
</ul>
</li>
<li>
<p><strong>Parámetros</strong>:</p>
<ul>
<li><code>P_YEAR</code>: Año de interés para filtrar los registros.</li>
</ul>
</li>
<li>
<p><strong>Operaciones Clave</strong>:</p>
<ul>
<li>Cálculo de la fecha de inicio válida (<code>valid_from_date</code>).</li>
<li>Inserción de datos en <code>RESULTS</code> desde múltiples tablas SAP relacionadas, con filtros específicos para el año académico, el estado del proceso y otras validaciones.</li>
</ul>
</li>
<li>
<p><strong>Validaciones</strong>:</p>
<ul>
<li>Solo se incluyen registros donde el estudiante esté activo, el año académico coincida y las fechas de retiro sean válidas.</li>
</ul>
</li>
</ol>
<p><strong>Conexión de Base de Datos</strong></p>
<ul>
<li><strong>Tipo de Conexión</strong>: ADO.NET.</li>
<li><strong>Identificador de Conexión</strong>: <code>{3A7D3F89-902D-4694-893E-02F1E08B0F72}</code>.</li>
</ul>
<h4 id="flujo-de-la-tarea_3">Flujo de la Tarea<a class="headerlink" href="#flujo-de-la-tarea_3" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant ExecuteSQL as Crear procedimiento anual
    ExecuteSQL-&gt;&gt;DB: Ejecuta el comando SQL `CREATE PROCEDURE GetRetirosByYear`
    DB--&gt;&gt;ExecuteSQL: Confirma la creación del procedimiento</code></pre>
<h3 id="componente-truncar-tabla">Componente: <strong><code>Truncar tabla</code></strong><a class="headerlink" href="#componente-truncar-tabla" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_13"><strong>Descripción General</strong><a class="headerlink" href="#descripcion-general_13" title="Permanent link">&para;</a></h4>
<p>El componente "Truncar tabla" es una tarea de ejecución de SQL que elimina todos los datos de la tabla <code>RESULTS</code> antes de ejecutar cualquier procedimiento o carga posterior, asegurando que la tabla esté vacía y preparada para nuevos datos. Utiliza el comando <code>TRUNCATE TABLE</code> para eliminar de forma eficiente los registros, sin generar registros de transacción para cada fila eliminada.</p>
<hr />
<h4 id="componentes-detallados"><strong>Componentes Detallados</strong><a class="headerlink" href="#componentes-detallados" title="Permanent link">&para;</a></h4>
<p><strong>Descripción</strong>
- <strong>Nombre del componente:</strong> Truncar tabla
- <strong>Tipo:</strong> Tarea Ejecutar SQL
- <strong>Descripción:</strong> Limpia la tabla <code>RESULTS</code> para evitar conflictos o duplicados en cargas posteriores.</p>
<p><strong>Propiedades</strong></p>
<table>
<thead>
<tr>
<th>Propiedad</th>
<th>Valor</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Connection</strong></td>
<td><code>{3A7D3F89-902D-4694-893E-02F1E08B0F72}</code></td>
</tr>
<tr>
<td><strong>SqlStatementSource</strong></td>
<td><code>TRUNCATE TABLE RESULTS;</code></td>
</tr>
<tr>
<td><strong>LocaleID</strong></td>
<td><code>-1</code></td>
</tr>
<tr>
<td><strong>CreationName</strong></td>
<td><code>Microsoft.ExecuteSQLTask</code></td>
</tr>
<tr>
<td><strong>TaskContact</strong></td>
<td><code>Execute SQL Task; Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation</code></td>
</tr>
</tbody>
</table>
<p><strong>Script SQL</strong>
<div class="highlight"><pre><span></span><code><span class="c1">-- Limpiar la tabla antes de ejecutar el procedimiento</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">RESULTS</span><span class="p">;</span>
</code></pre></div></p>
<h3 id="componente-calcular-retiros">Componente <strong><code>Calcular retiros</code></strong><a class="headerlink" href="#componente-calcular-retiros" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_14"><strong>Descripción General</strong><a class="headerlink" href="#descripcion-general_14" title="Permanent link">&para;</a></h4>
<p>El componente "Calcular retiros" es una tarea de flujo de datos en SSIS diseñada para procesar, transformar y almacenar información relacionada con retiros de estudiantes. Este flujo extrae datos de una fuente SAP, realiza conversiones de datos, derivaciones de columnas, y finalmente almacena los resultados en la tabla de destino <code>FACT_RETIROS</code>.</p>
<hr />
<h4 id="componentes-del-flujo-de-datos_2"><strong>Componentes del Flujo de Datos</strong><a class="headerlink" href="#componentes-del-flujo-de-datos_2" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>FACT_RETIROS SAP (Origen de datos)</strong></p>
<ul>
<li><strong>Descripción:</strong> Extrae información de estudiantes y retiros desde SAP usando un bloque SQL que recorre años desde 2023 hasta el año actual.</li>
<li><strong>Propiedades principales:</strong><ul>
<li><strong>Consulta SQL:</strong>
<div class="highlight"><pre><span></span><code><span class="k">DO</span>
<span class="k">BEGIN</span>
<span class="w">    </span><span class="k">DECLARE</span><span class="w"> </span><span class="k">year</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="mi">2023</span><span class="p">;</span>
<span class="w">    </span><span class="k">DECLARE</span><span class="w"> </span><span class="n">current_year</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="k">YEAR</span><span class="p">(</span><span class="k">CURRENT_DATE</span><span class="p">);</span>
<span class="w">    </span><span class="n">WHILE</span><span class="w"> </span><span class="k">year</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">current_year</span><span class="w"> </span><span class="k">DO</span>
<span class="w">        </span><span class="k">CALL</span><span class="w"> </span><span class="n">GetRetirosByYear</span><span class="p">(</span><span class="k">year</span><span class="p">);</span>
<span class="w">        </span><span class="k">year</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="k">year</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="n">WHILE</span><span class="p">;</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">RESULTS</span><span class="p">;</span>
<span class="k">END</span>
</code></pre></div></li>
<li><strong>Conexión:</strong> <code>SAP_ERP</code></li>
<li><strong>Timeout:</strong> 30 segundos.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Data Conversion</strong></p>
<ul>
<li><strong>Descripción:</strong> Convierte los datos extraídos a los tipos requeridos para las siguientes transformaciones y el destino.</li>
<li><strong>Entrada:</strong><ul>
<li>Columnas: <code>OBJETO_SAP_ESTUDIANTE</code>, <code>NUMERO_MATRICULA</code>, <code>PARTNER_ESTUDIANTE</code>, <code>ANIO_ACADEMICO</code>, <code>APELLIDOS</code>, <code>NOMBRES</code>, <code>CURSO</code>, <code>GRADO</code>, <code>FECHA_RETIRO_SAP</code>, <code>FECHA_VALIDO_DESDE</code>, <code>FECHA_VALIDO_HASTA</code>.</li>
</ul>
</li>
<li><strong>Salida:</strong><ul>
<li>Columnas convertidas como <code>Copy of &lt;nombre original&gt;</code>.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Lookup</strong></p>
<ul>
<li><strong>Descripción:</strong> Enlaza información adicional de la tabla <code>DIM_POBLACION_MATRICULA</code>.</li>
<li><strong>Propiedades principales:</strong><ul>
<li><strong>Consulta SQL:</strong>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_POBLACION_MATRICULA</span><span class="p">]</span>
</code></pre></div></li>
<li><strong>Comportamiento de no coincidencia:</strong> Ignorar filas sin coincidencias.</li>
<li><strong>Conexión:</strong> <code>DWH_COMFENALCO_Destino_OLEDB</code>.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Derived Column</strong></p>
<ul>
<li><strong>Descripción:</strong> Deriva nuevas columnas a partir de las existentes. Por ejemplo, se genera la columna <code>ID_FECHA</code> utilizando <code>FECHA_RETIRO_SAP</code>.</li>
<li><strong>Expresión derivada:</strong>
    <div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">DT_I4</span><span class="p">)(</span><span class="k">YEAR</span><span class="p">([</span><span class="k">Copy</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">FECHA_RETIRO_SAP</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">10000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">MONTH</span><span class="p">([</span><span class="k">Copy</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">FECHA_RETIRO_SAP</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">DAY</span><span class="p">([</span><span class="k">Copy</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">FECHA_RETIRO_SAP</span><span class="p">]))</span>
</code></pre></div></li>
</ul>
</li>
<li>
<p><strong>Destino de ADO NET</strong></p>
<ul>
<li><strong>Descripción:</strong> Almacena los resultados procesados en la tabla <code>FACT_RETIROS</code> en la base de datos de destino.</li>
<li><strong>Propiedades principales:</strong><ul>
<li><strong>Tabla de destino:</strong> <code>Colegio.FACT_RETIROS</code></li>
<li><strong>Conexión:</strong> <code>DWH_COMFENALCO_Destino</code>.</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="flujo-del-proceso"><strong>Flujo del Proceso</strong><a class="headerlink" href="#flujo-del-proceso" title="Permanent link">&para;</a></h4>
<ol>
<li>Extraer datos desde SAP mediante <code>FACT_RETIROS SAP</code>.</li>
<li>Convertir datos en el componente <code>Data Conversion</code>.</li>
<li>Realizar un <strong>lookup</strong> para enriquecer datos desde <code>DIM_POBLACION_MATRICULA</code>.</li>
<li>Derivar nuevas columnas usando <code>Derived Column</code>.</li>
<li>Almacenar los datos procesados en la tabla <code>FACT_RETIROS</code>.</li>
</ol>
<hr />
<h4 id="diagrama-de-secuencia-del-flujo_1"><strong>Diagrama de Secuencia del Flujo</strong><a class="headerlink" href="#diagrama-de-secuencia-del-flujo_1" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant SAP as FACT_RETIROS SAP
    participant DC as Data Conversion
    participant LKP as Lookup
    participant DCOL as Derived Column
    participant DEST as Destino de ADO NET

    SAP-&gt;&gt;DC: Extraer datos desde SAP
    DC-&gt;&gt;LKP: Convertir datos y realizar Lookup
    LKP-&gt;&gt;DCOL: Enviar datos enriquecidos
    DCOL-&gt;&gt;DEST: Derivar columnas y guardar en destino
    DEST--&gt;&gt;SAP: Fin del proceso</code></pre>
<h3 id="componente-procesar-fact_ausentismo_docente">Componente <strong><code>Procesar FACT_AUSENTISMO_DOCENTE</code></strong><a class="headerlink" href="#componente-procesar-fact_ausentismo_docente" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_15"><strong>Descripción General</strong><a class="headerlink" href="#descripcion-general_15" title="Permanent link">&para;</a></h4>
<p>El componente <strong>"Procesar FACT_AUSENTISMO_DOCENTE"</strong> es una tarea de flujo de datos en SSIS destinada a procesar, transformar y almacenar información relacionada con el ausentismo docente. El flujo de datos incluye una fuente de datos Excel, transformaciones como conversión de datos y derivación de columnas, enriquecimiento con datos adicionales mediante <code>Lookup</code>, y finalmente el almacenamiento en la tabla <code>FACT_AUSENTISMO_DOCENTE</code>.</p>
<hr />
<h4 id="componentes-del-flujo-de-datos_3"><strong>Componentes del Flujo de Datos</strong><a class="headerlink" href="#componentes-del-flujo-de-datos_3" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Leer EP-EDF-02 (Excel Source)</strong></p>
<ul>
<li><strong>Descripción:</strong> Lee los datos desde un archivo Excel ubicado en la conexión <code>Excel_Connection_Fact_Ausentismo_Docente</code>.</li>
<li><strong>Propiedades principales:</strong><ul>
<li><strong>Nombre de la hoja:</strong> <code>Hoja1$</code>.</li>
<li><strong>Columnas:</strong> <code>TIPO_DOCUMENTO</code>, <code>DOCUMENTO</code>, <code>ANIO_ACADEMICO</code>, <code>FECHA_REGISTRO</code>, <code>NOMBRE_DOCENTE</code>, <code>CARGO</code>, <code>FECHA_INICIO</code>, <code>FECHA_FIN</code>, <code>AUSENCIA_HORAS</code>, <code>AUSENCIA_DIAS</code>, <code>TIPO_AUSENCIA</code>, <code>PERMISO</code>, <code>MOTIVO_AUSENCIA</code>.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Data Conversion</strong></p>
<ul>
<li><strong>Descripción:</strong> Convierte los datos extraídos a los tipos requeridos para las siguientes transformaciones y el destino.</li>
<li><strong>Entrada:</strong><ul>
<li>Columnas del archivo Excel.</li>
</ul>
</li>
<li><strong>Salida:</strong><ul>
<li>Columnas convertidas, con prefijo <code>Copy of</code>.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Derived Column</strong></p>
<ul>
<li><strong>Descripción:</strong> Deriva nuevas columnas basadas en cálculos sobre las columnas existentes. Por ejemplo, se genera <code>ID_FECHA</code> utilizando <code>FECHA_REGISTRO</code>.</li>
<li><strong>Expresión derivada:</strong>
    <div class="highlight"><pre><span></span><code><span class="p">(</span><span class="n">DT_I4</span><span class="p">)(</span><span class="k">YEAR</span><span class="p">([</span><span class="k">Copy</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">FECHA_REGISTRO</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">10000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">MONTH</span><span class="p">([</span><span class="k">Copy</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">FECHA_REGISTRO</span><span class="p">])</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">DAY</span><span class="p">([</span><span class="k">Copy</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">FECHA_REGISTRO</span><span class="p">]))</span>
</code></pre></div></li>
</ul>
</li>
<li>
<p><strong>Lookup</strong></p>
<ul>
<li><strong>Descripción:</strong> Enlaza información adicional desde la tabla <code>DIM_PERSONAL</code> en la base de datos <code>DWH_COMFENALCO</code>.</li>
<li><strong>Propiedades principales:</strong><ul>
<li><strong>Consulta SQL:</strong>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="p">[</span><span class="n">ID_PERSONAL</span><span class="p">],</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="k">LEFT</span><span class="p">([</span><span class="n">COD_PERSONA_UNIDAD</span><span class="p">],</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INT</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ANIO_ACADEMICO</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">ID_UNIDAD</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">TIPO_DOCUMENTO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">DOCUMENTO</span><span class="p">]</span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_PERSONAL</span><span class="p">]</span>
<span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">ID_UNIDAD</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</code></pre></div></li>
<li><strong>Claves de unión:</strong> <code>TIPO_DOCUMENTO</code>, <code>DOCUMENTO</code>, <code>ANIO_ACADEMICO</code>.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Destino de ADO NET</strong></p>
<ul>
<li><strong>Descripción:</strong> Almacena los datos procesados en la tabla <code>FACT_AUSENTISMO_DOCENTE</code>.</li>
<li><strong>Propiedades principales:</strong><ul>
<li><strong>Tabla de destino:</strong> <code>Colegio.FACT_AUSENTISMO_DOCENTE</code>.</li>
<li><strong>Conexión:</strong> <code>DWH_COMFENALCO_Destino</code>.</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="diagrama-de-secuencia_8"><strong>Diagrama de Secuencia</strong><a class="headerlink" href="#diagrama-de-secuencia_8" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant Excel as Leer EP-EDF-02 (Excel Source)
    participant DC as Data Conversion
    participant LKP as Lookup
    participant DCOL as Derived Column
    participant DEST as Destino de ADO NET

    Excel-&gt;&gt;DC: Leer datos desde Excel
    DC-&gt;&gt;DCOL: Convertir datos y derivar columnas
    DCOL-&gt;&gt;LKP: Enviar datos para enriquecimiento
    LKP-&gt;&gt;DEST: Guardar en base de datos
    DEST--&gt;&gt;Excel: Fin del proceso</code></pre>
<p><strong>Flujo del Proceso</strong></p>
<ol>
<li>Leer datos desde el archivo Excel (<code>Leer EP-EDF-02</code>).</li>
<li>Convertir tipos de datos con el componente <code>Data Conversion</code>.</li>
<li>Derivar nuevas columnas usando <code>Derived Column</code>.</li>
<li>Enriquecer datos con información adicional mediante <code>Lookup</code>.</li>
<li>Almacenar los datos procesados en la tabla <code>FACT_AUSENTISMO_DOCENTE</code>.</li>
</ol>
<h3 id="componente-procesar-fact_biblioteca">Componente <strong><code>Procesar FACT_BIBLIOTECA</code></strong><a class="headerlink" href="#componente-procesar-fact_biblioteca" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_16"><strong>Descripción General</strong><a class="headerlink" href="#descripcion-general_16" title="Permanent link">&para;</a></h4>
<p>Este flujo de datos procesa la información de préstamos de biblioteca desde un archivo Excel hasta un destino en la base de datos relacional mediante transformaciones como conversiones de datos, columnas derivadas y búsquedas para enriquecer los datos con información adicional.</p>
<h4 id="componentes-del-flujo-de-datos_4"><strong>Componentes del Flujo de Datos</strong><a class="headerlink" href="#componentes-del-flujo-de-datos_4" title="Permanent link">&para;</a></h4>
<p><strong>1. Fuente: Leer EP-EDF-05</strong></p>
<ul>
<li><strong>Descripción</strong>: Extrae datos de un archivo Excel que contiene registros de préstamos de biblioteca.</li>
<li><strong>Propiedades</strong>:<ul>
<li>Nombre de la hoja: <code>Hoja1$</code>.</li>
<li>Conexión: <code>Excel_Connection_Fact_Biblioteca</code>.</li>
<li>Tiempo de espera del comando: <code>0</code> (sin límite).</li>
</ul>
</li>
<li><strong>Columnas extraídas</strong>:<ul>
<li><code>TIPO_DOCUMENTO</code>, <code>DOCUMENTO</code>, <code>BP_ESTUDIANTE</code>, <code>TIPO_USUARIO</code>, <code>FECHA_PRESTAMO</code>, <code>FECHA_VENCIMIENTO</code>, <code>FECHA_ENTREGA</code>, <code>BIBLIOTECA</code>, <code>ITEM_LIBRO</code>, <code>NO_PRESTAMOS</code>.</li>
</ul>
</li>
</ul>
<p><strong>2. Transformación: Data Conversion</strong></p>
<ul>
<li><strong>Descripción</strong>: Convierte las columnas extraídas en tipos compatibles con los destinos y procesos posteriores.</li>
<li><strong>Propiedades</strong>:<ul>
<li>Conversión de tipos: <code>wstr</code> a tipos específicos como <code>date</code> e <code>i4</code>.</li>
<li>Columnas convertidas: <ul>
<li>Ejemplo: <code>FECHA_PRESTAMO</code> a tipo <code>date</code>, <code>ITEM_LIBRO</code> a tipo <code>wstr</code> con longitud específica.</li>
</ul>
</li>
<li>Disposición en caso de error: <code>FailComponent</code>.</li>
</ul>
</li>
</ul>
<p><strong>3. Transformación: Derived Column</strong></p>
<ul>
<li><strong>Descripción</strong>: Crea nuevas columnas derivadas de las existentes, como <code>ID_FECHA</code> y <code>ANIO_ACADEMICO</code>.</li>
<li><strong>Propiedades</strong>:<ul>
<li>Expresiones:<ul>
<li><code>ID_FECHA</code>: <code>(DT_I4)(YEAR([FECHA_PRESTAMO])*10000 + MONTH([FECHA_PRESTAMO])*100 + DAY([FECHA_PRESTAMO]))</code>.</li>
<li><code>ANIO_ACADEMICO</code>: <code>(DT_I4)(YEAR([FECHA_PRESTAMO]))</code>.</li>
</ul>
</li>
<li>Manejo de errores: <code>FailComponent</code>.</li>
</ul>
</li>
</ul>
<p><strong>4. Transformación: Lookup</strong></p>
<ul>
<li>
<p><strong>Lookup 1: Datos de matrícula (<code>DIM_POBLACION_MATRICULA</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Asocia datos de estudiantes a partir de la columna <code>BP_ESTUDIANTE</code>.</li>
<li><strong>Propiedades</strong>:<ul>
<li>Consulta SQL:
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_POBLACION_MATRICULA</span><span class="p">];</span>
</code></pre></div></li>
<li>Mapeo de parámetros: <code>BP_ESTUDIANTE → PARTNER</code>.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Lookup 2: Datos de libros (<code>DIM_LIBROS</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Busca el <code>ID_LIBRO</code> usando el código de barras o ítem del libro.</li>
<li><strong>Propiedades</strong>:<ul>
<li>Consulta SQL (con CTE para manejar duplicados):
<div class="highlight"><pre><span></span><code><span class="k">WITH</span><span class="w"> </span><span class="n">CTE</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="p">[</span><span class="n">ID_LIBRO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">ITEM</span><span class="p">],</span>
<span class="w">            </span><span class="n">ROW_NUMBER</span><span class="p">()</span><span class="w"> </span><span class="n">OVER</span><span class="w"> </span><span class="p">(</span><span class="n">PARTITION</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="p">[</span><span class="n">ITEM</span><span class="p">]</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="p">[</span><span class="n">ID_LIBRO</span><span class="p">])</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">rn</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_LIBROS</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span><span class="p">[</span><span class="n">ID_LIBRO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">ITEM</span><span class="p">]</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">CTE</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">rn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Lookup 3: Verificación de registros existentes (<code>FACT_BIBLIOTECA</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Verifica si ya existe un registro similar en la tabla destino.</li>
<li><strong>Propiedades</strong>:<ul>
<li>Consulta SQL:
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">FACT_BIBLIOTECA</span><span class="p">];</span>
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>5. Destino: Destino de ADO.NET</strong></p>
<ul>
<li><strong>Descripción</strong>: Inserta los datos transformados en la tabla <code>FACT_BIBLIOTECA</code> del esquema <code>Colegio</code>.</li>
<li><strong>Propiedades</strong>:<ul>
<li>Tabla destino: <code>"Colegio"."FACT_BIBLIOTECA"</code>.</li>
<li>Conexión: <code>DWH_COMFENALCO_Destino</code>.</li>
<li>Tamaño de lotes: <code>0</code> (uso del tamaño de buffer interno).</li>
</ul>
</li>
</ul>
<h4 id="diagrama-de-secuencia_9"><strong>Diagrama de Secuencia</strong><a class="headerlink" href="#diagrama-de-secuencia_9" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant ExcelSource as Leer EP-EDF-05
    participant DataConversion as Data Conversion
    participant DerivedColumn as Derived Column
    participant LookupMatricula as Lookup: DIM_POBLACION_MATRICULA
    participant LookupLibros as Lookup: DIM_LIBROS
    participant LookupFact as Lookup: FACT_BIBLIOTECA
    participant Destino as ADO.NET Destination

    ExcelSource -&gt;&gt; DataConversion: Extraer columnas y convertir tipos
    DataConversion -&gt;&gt; DerivedColumn: Generar columnas derivadas
    DerivedColumn -&gt;&gt; LookupMatricula: Buscar ID de matrícula
    LookupMatricula -&gt;&gt; LookupLibros: Buscar ID de libro
    LookupLibros -&gt;&gt; LookupFact: Verificar duplicados
    LookupFact -&gt;&gt; Destino: Insertar registros finales</code></pre>
<h3 id="componente-procesar-fact_biblioteca_virtual">Componente <strong><code>Procesar FACT_BIBLIOTECA_VIRTUAL</code></strong><a class="headerlink" href="#componente-procesar-fact_biblioteca_virtual" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_17">Descripción General<a class="headerlink" href="#descripcion-general_17" title="Permanent link">&para;</a></h4>
<p>Este flujo de datos realiza la extracción, transformación y carga (ETL) para los registros de la biblioteca virtual. Incluye conversiones de datos, derivación de columnas, búsquedas y carga en un destino ADO.NET.</p>
<h4 id="componentes-del-flujo-de-datos_5">Componentes del Flujo de Datos<a class="headerlink" href="#componentes-del-flujo-de-datos_5" title="Permanent link">&para;</a></h4>
<p><strong>1. Componente <code>Leer EP-EDF-06</code></strong></p>
<ul>
<li><strong>Descripción:</strong> Fuente de datos Excel que extrae información de la hoja <code>Hoja1$</code>.</li>
<li><strong>Propiedades:</strong><ul>
<li><code>CommandTimeout</code>: 0 (infinito).</li>
<li><code>AccessMode</code>: 0 (tabla directa).</li>
<li><code>OpenRowset</code>: <code>Hoja1$</code>.</li>
</ul>
</li>
</ul>
<p><strong>2. Componente <code>Data Conversion</code></strong></p>
<ul>
<li><strong>Descripción:</strong> Convierte las columnas de entrada para ajustarlas a los tipos requeridos.</li>
<li><strong>Columnas Convertidas:</strong><ul>
<li><code>TIPO_DOCUMENTO</code>: <code>wstr</code> (40).</li>
<li><code>DOCUMENTO</code>: <code>wstr</code> (20).</li>
<li><code>FECHA_INICIO</code>: <code>date</code>.</li>
</ul>
</li>
<li><strong>Propiedades Adicionales:</strong><ul>
<li><code>FastParse</code>: <code>false</code> en todas las columnas.</li>
</ul>
</li>
</ul>
<p><strong>3. Componente <code>Derived Column</code></strong></p>
<ul>
<li><strong>Descripción:</strong> Deriva columnas calculadas como <code>ID_FECHA</code> y <code>ANIO_ACADEMICO</code>.</li>
<li><strong>Columnas Derivadas:</strong><ul>
<li><code>ID_FECHA</code>: Combina año, mes y día de <code>FECHA_INICIO</code>.</li>
<li><code>ANIO_ACADEMICO</code>: Extrae solo el año.</li>
</ul>
</li>
</ul>
<p><strong>4. Componente <code>Lookup</code></strong></p>
<ul>
<li><strong>Descripción:</strong> Realiza una búsqueda en la tabla <code>DIM_POBLACION_MATRICULA</code> para obtener <code>ID_POBLACION_MATRICULA</code>.</li>
<li><strong>SQL de Búsqueda:</strong> 
  <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">Colegio</span><span class="p">.</span><span class="n">DIM_POBLACION_MATRICULA</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">TIPO_DOCUMENTO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">DOCUMENTO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
</code></pre></div></li>
<li><strong>Propiedades:</strong><ul>
<li><code>CacheType</code>: Completo.</li>
<li><code>NoMatchBehavior</code>: Ignorar filas sin coincidencia.</li>
</ul>
</li>
</ul>
<p><strong>5. Componente <code>Destino de ADO NET</code></strong></p>
<ul>
<li><strong>Descripción:</strong> Carga los datos transformados en la tabla <code>Colegio.FACT_BIBLIOTECA</code>.</li>
<li><strong>Propiedades:</strong><ul>
<li><code>BatchSize</code>: 0 (usa tamaño de búfer).</li>
<li><code>UseBulkInsertWhenPossible</code>: <code>true</code>.</li>
<li><code>CommandTimeout</code>: 30 segundos.</li>
</ul>
</li>
</ul>
<h4 id="diagrama-de-secuencia_10">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia_10" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    Leer EP-EDF-06 -&gt;&gt; Data Conversion: Exporta datos Excel
    Data Conversion -&gt;&gt; Derived Column: Convierte columnas
    Derived Column -&gt;&gt; Lookup: Realiza búsquedas
    Lookup -&gt;&gt; Derived Column 1: Agrega nuevas columnas derivadas
    Derived Column 1 -&gt;&gt; Destino de ADO NET: Carga datos en la tabla FACT_BIBLIOTECA</code></pre>
<h3 id="componente-procesar-fact_desempenho_docente">Componente <strong><code>Procesar FACT_DESEMPENHO_DOCENTE</code></strong><a class="headerlink" href="#componente-procesar-fact_desempenho_docente" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_18">Descripción General<a class="headerlink" href="#descripcion-general_18" title="Permanent link">&para;</a></h4>
<p>El componente <code>Procesar FACT_DESEMPENHO_DOCENTE</code> es un flujo de datos diseñado para extraer información desde un archivo Excel, realizar transformaciones y cargar los datos procesados en una base de datos. Este flujo incluye transformaciones clave como conversión de datos, derivación de columnas, y consultas de búsqueda para enriquecer la información antes de almacenarla en un destino ADO.NET.</p>
<h4 id="componentes-del-flujo-de-datos_6"><strong>Componentes del Flujo de Datos:</strong><a class="headerlink" href="#componentes-del-flujo-de-datos_6" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Leer EP-EDF-09 (Excel Source):</strong></p>
<ul>
<li><strong>Descripción:</strong> Fuente de datos que extrae información desde un archivo Excel.</li>
<li><strong>Propiedades:</strong><ul>
<li><strong>Hoja:</strong> <code>Hoja1$</code></li>
<li><strong>Conexión:</strong> <code>Excel_Connection_Fact_Desempenho_Colegio</code></li>
<li><strong>Columnas:</strong> <code>TIPO_DOCUMENTO</code>, <code>DOCUMENTO</code>, <code>ANIO_ACADEMICO</code>, entre otras.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Data Conversion:</strong></p>
<ul>
<li><strong>Descripción:</strong> Realiza conversiones de tipos de datos de las columnas extraídas.</li>
<li><strong>Columnas Convertidas:</strong><ul>
<li><code>TIPO_DOCUMENTO</code> a <code>wstr(40)</code></li>
<li><code>FECHA</code> a <code>date</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Derived Column:</strong></p>
<ul>
<li><strong>Descripción:</strong> Genera la columna <code>ID_FECHA</code> basada en la fecha en formato <code>YYYYMMDD</code>.</li>
<li><strong>Expresión:</strong> <code>(DT_I4)(YEAR([Copy of FECHA]) * 10000 + MONTH([Copy of FECHA]) * 100 + DAY([Copy of FECHA]))</code></li>
</ul>
</li>
<li>
<p><strong>Lookup:</strong></p>
<ul>
<li><strong>Descripción:</strong> Enlaza los datos con la tabla <code>DIM_PERSONAL</code> para obtener el <code>ID_PERSONAL</code>.</li>
<li><strong>Consulta SQL:</strong>
    <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="p">[</span><span class="n">ID_PERSONAL</span><span class="p">],</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="k">LEFT</span><span class="p">([</span><span class="n">COD_PERSONA_UNIDAD</span><span class="p">],</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INT</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ANIO_ACADEMICO</span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_PERSONAL</span><span class="p">]</span>
<span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">ID_UNIDAD</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
</code></pre></div></li>
</ul>
</li>
<li>
<p><strong>Derived Column 1:</strong></p>
<ul>
<li><strong>Descripción:</strong> Asigna <code>-1</code> al <code>ID_PERSONAL</code> si no se encuentra un valor correspondiente.</li>
<li><strong>Expresión:</strong> <code>ISNULL(ID_PERSONAL) ? -1 : ID_PERSONAL</code></li>
</ul>
</li>
<li>
<p><strong>Lookup 1:</strong></p>
<ul>
<li><strong>Descripción:</strong> Verifica duplicados en la tabla <code>FACT_DESEMPENHO_DOCENTE</code> para evitar registros repetidos.</li>
<li><strong>Consulta SQL:</strong>
    <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">FACT_DESEMPENHO_DOCENTE</span><span class="p">]</span>
<span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">ID_FECHA</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">[</span><span class="n">ID_PERSONAL</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
</code></pre></div></li>
</ul>
</li>
<li>
<p><strong>Destino de ADO NET:</strong></p>
<ul>
<li><strong>Descripción:</strong> Carga los datos procesados en la tabla <code>FACT_DESEMPENHO_DOCENTE</code>.</li>
<li><strong>Tabla Destino:</strong> <code>"Colegio"."FACT_DESEMPENHO_DOCENTE"</code></li>
<li><strong>Conexión:</strong> <code>DWH_COMFENALCO_Destino</code></li>
</ul>
</li>
</ol>
<h4 id="diagrama-de-secuencia_11">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia_11" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant Excel_Source as Leer EP-EDF-09 (Excel Source)
    participant Data_Conversion as Data Conversion
    participant Derived_Column as Derived Column
    participant Lookup as Lookup
    participant Lookup_1 as Lookup 1
    participant Derived_Column_1 as Derived Column 1
    participant ADO_NET as Destino de ADO NET

    Excel_Source -&gt;&gt; Data_Conversion: Envío de datos
    Data_Conversion -&gt;&gt; Derived_Column: Conversión de tipos
    Derived_Column -&gt;&gt; Lookup: Relaciona datos con DIM_PERSONAL
    Lookup -&gt;&gt; Derived_Column_1: Combina resultados
    Derived_Column_1 -&gt;&gt; Lookup_1: Valida duplicados en FACT_DESEMPENHO_DOCENTE
    Lookup_1 -&gt;&gt; ADO_NET: Inserta datos únicos
    Note right of ADO_NET: Datos procesados y almacenados</code></pre>
<h3 id="componente-procesar-fact_enfermeria">Componente <strong><code>Procesar FACT_ENFERMERIA</code></strong><a class="headerlink" href="#componente-procesar-fact_enfermeria" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_19">Descripción General<a class="headerlink" href="#descripcion-general_19" title="Permanent link">&para;</a></h4>
<p>El componente <code>Procesar FACT_ENFERMERIA</code> gestiona el flujo de datos para transformar, enriquecer y almacenar información relacionada con casos de atención en enfermería. Este flujo extrae datos de un archivo Excel, realiza conversiones y cálculos, enriquece los datos con información adicional, y los carga en una tabla de base de datos mediante un destino ADO.NET.</p>
<h4 id="componentes-del-flujo-de-datos_7"><strong>Componentes del Flujo de Datos:</strong><a class="headerlink" href="#componentes-del-flujo-de-datos_7" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Leer EP-EDF-01 (Excel Source):</strong></p>
<ul>
<li><strong>Descripción:</strong> Fuente de datos que extrae información desde un archivo Excel.</li>
<li><strong>Propiedades:</strong><ul>
<li><strong>Hoja:</strong> <code>Hoja1$</code></li>
<li><strong>Conexión:</strong> <code>Excel_Connection_Fact_Enfermeria</code></li>
<li><strong>Columnas:</strong> <code>TIPO_DOCUMENTO</code>, <code>DOCUMENTO</code>, <code>IDCASO</code>, entre otras.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Data Conversion:</strong></p>
<ul>
<li><strong>Descripción:</strong> Realiza conversiones de tipos de datos de las columnas extraídas.</li>
<li><strong>Columnas Convertidas:</strong><ul>
<li><code>TIPO_DOCUMENTO</code> a <code>wstr(40)</code></li>
<li><code>FECHA_ATENCION</code> a <code>date</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Derived Column:</strong></p>
<ul>
<li><strong>Descripción:</strong> Genera la columna <code>ID_FECHA</code> basada en la fecha de atención en formato <code>YYYYMMDD</code>.</li>
<li><strong>Expresión:</strong> <code>(DT_I4)(YEAR([Copy of FECHA_ATENCION]) * 10000 + MONTH([Copy of FECHA_ATENCION]) * 100 + DAY([Copy of FECHA_ATENCION]))</code></li>
</ul>
</li>
<li>
<p><strong>Lookup:</strong></p>
<ul>
<li><strong>Descripción:</strong> Enlaza los datos con la tabla <code>DIM_POBLACION_MATRICULA</code> para obtener el <code>ID_POBLACION_MATRICULA</code>.</li>
<li><strong>Consulta SQL:</strong>
    <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_POBLACION_MATRICULA</span><span class="p">]</span>
<span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">TIPO_DOCUMENTO</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">[</span><span class="n">DOCUMENTO</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
</code></pre></div></li>
</ul>
</li>
<li>
<p><strong>Derived Column 1:</strong></p>
<ul>
<li><strong>Descripción:</strong> Asigna <code>-1</code> al <code>ID_POBLACION_MATRICULA</code> si no se encuentra un valor correspondiente.</li>
<li><strong>Expresión:</strong> <code>ISNULL(ID_POBLACION_MATRICULA) ? -1 : ID_POBLACION_MATRICULA</code></li>
</ul>
</li>
<li>
<p><strong>Lookup 1:</strong></p>
<ul>
<li><strong>Descripción:</strong> Verifica duplicados en la tabla <code>FACT_ENFERMERIA</code> para evitar registros repetidos.</li>
<li><strong>Consulta SQL:</strong>
    <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">FACT_ENFERMERIA</span><span class="p">]</span>
<span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">ID_CASO</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">[</span><span class="n">ID_FECHA</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">[</span><span class="n">ID_POBLACION_MATRICULA</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
</code></pre></div></li>
</ul>
</li>
<li>
<p><strong>Destino de ADO NET:</strong></p>
<ul>
<li><strong>Descripción:</strong> Carga los datos procesados en la tabla <code>FACT_ENFERMERIA</code>.</li>
<li><strong>Tabla Destino:</strong> <code>"Colegio"."FACT_ENFERMERIA"</code></li>
<li><strong>Conexión:</strong> <code>DWH_COMFENALCO_Destino</code></li>
</ul>
</li>
</ol>
<h4 id="diagrama-de-secuencia_12">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia_12" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant Excel_Source as Leer EP-EDF-01 (Excel Source)
    participant Data_Conversion as Data Conversion
    participant Derived_Column as Derived Column
    participant Lookup as Lookup
    participant Lookup_1 as Lookup 1
    participant Derived_Column_1 as Derived Column 1
    participant ADO_NET as Destino de ADO NET

    Excel_Source -&gt;&gt; Data_Conversion: Envío de datos
    Data_Conversion -&gt;&gt; Derived_Column: Conversión de tipos
    Derived_Column -&gt;&gt; Lookup: Relaciona datos con DIM_POBLACION_MATRICULA
    Lookup -&gt;&gt; Derived_Column_1: Combina resultados
    Derived_Column_1 -&gt;&gt; Lookup_1: Verifica duplicados en FACT_ENFERMERIA
    Lookup_1 -&gt;&gt; ADO_NET: Inserta datos únicos
    Note right of ADO_NET: Almacena datos procesados</code></pre>
<h3 id="componente-procesar-fact_legalizacion">Componente <strong><code>Procesar FACT_LEGALIZACION</code></strong><a class="headerlink" href="#componente-procesar-fact_legalizacion" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_20">Descripción General<a class="headerlink" href="#descripcion-general_20" title="Permanent link">&para;</a></h4>
<p>Este flujo de datos del paquete SSIS tiene como objetivo procesar y cargar datos relacionados con <strong>FACT_LEGALIZACION</strong> desde una fuente de datos Excel hacia una base de datos compatible con ADO.NET. Los datos se someten a diversas transformaciones antes de ser insertados en la tabla destino.</p>
<h4 id="componentes-del-flujo-de-datos_8">Componentes del Flujo de Datos<a class="headerlink" href="#componentes-del-flujo-de-datos_8" title="Permanent link">&para;</a></h4>
<p><strong>1. Leer EP-EDF-10</strong></p>
<ul>
<li><strong>Descripción:</strong> Lee datos desde una hoja de Excel llamada <code>Sheet1$</code> usando un origen de datos Excel.</li>
<li><strong>Propiedades:</strong><ul>
<li>Tiempo de espera: <code>0</code> (sin límite).</li>
<li>Modo de acceso: <code>0</code> (por defecto).</li>
</ul>
</li>
<li><strong>Columnas de salida:</strong><ul>
<li><code>RAZON_SOCIAL</code>: Ancho de 255 caracteres.</li>
<li><code>FECHA</code>: Tipo de dato <code>date</code>.</li>
<li><code>CODIGO_DANE</code>, <code>CODIGO_ICFES</code>: Tipo de dato <code>r8</code>.</li>
<li>Otras columnas incluyen detalles como <code>CALENDARIO</code>, <code>NATURALEZA</code>, <code>CARACTER</code>, <code>TOTAL_ESTUDIANTES</code>, entre otros.</li>
</ul>
</li>
</ul>
<p><strong>2. Data Conversion</strong></p>
<ul>
<li><strong>Descripción:</strong> Convierte tipos de datos y realiza ajustes necesarios en las columnas del flujo de datos para asegurar la compatibilidad con el destino.</li>
<li><strong>Propiedades:</strong><ul>
<li>Utiliza la opción <code>FailComponent</code> para manejar errores.</li>
<li>Genera copias de las columnas leídas con ajustes de longitud y tipo de datos.</li>
</ul>
</li>
<li><strong>Columnas procesadas:</strong><ul>
<li>Ejemplo: <code>Copy of RAZON_SOCIAL</code> (tipo <code>wstr</code>, longitud: 40), <code>Copy of FECHA</code> (tipo <code>date</code>).</li>
</ul>
</li>
</ul>
<p><strong>3. Derived Column</strong></p>
<ul>
<li><strong>Descripción:</strong> Genera nuevas columnas derivadas a partir de transformaciones sobre las columnas existentes.</li>
<li><strong>Propiedades:</strong><ul>
<li>Calcula el campo <code>ID_FECHA</code> combinando valores de <code>Año</code>, <code>Mes</code> y <code>Día</code> provenientes de <code>Copy of FECHA</code>.</li>
<li>Ejemplo de expresión: <code>(DT_I4)(YEAR([Copy of FECHA]) * 10000 + MONTH([Copy of FECHA]) * 100 + DAY([Copy of FECHA]))</code>.</li>
</ul>
</li>
</ul>
<p><strong>4. Lookup</strong></p>
<ul>
<li><strong>Descripción:</strong> Realiza búsquedas en la tabla de destino para verificar si los registros ya existen.</li>
<li><strong>Propiedades:</strong><ul>
<li>Usa la consulta SQL: <code>SELECT * FROM [Colegio].[FACT_LEGALIZACION]</code>.</li>
<li>Maneja filas sin coincidencias enviándolas al flujo de datos.</li>
<li>Coincidencias basadas en <code>RAZON_SOCIAL</code>, <code>CODIGO_DANE</code> y <code>ID_FECHA</code>.</li>
</ul>
</li>
</ul>
<p><strong>5. Destino de ADO.NET</strong></p>
<ul>
<li><strong>Descripción:</strong> Inserta los datos transformados en la tabla destino <code>FACT_LEGALIZACION</code> dentro de la base de datos del Colegio.</li>
<li><strong>Propiedades:</strong><ul>
<li>Nombre de la tabla: <code>"Colegio"."FACT_LEGALIZACION"</code>.</li>
<li>Tamaño del lote: <code>0</code> (uso de tamaño predeterminado).</li>
<li>Tiempo de espera: <code>30</code> segundos.</li>
<li>Usa <code>SqlBulkCopy</code> para mejorar el rendimiento.</li>
</ul>
</li>
</ul>
<h4 id="diagrama-de-secuencia_13">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia_13" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant ExcelSource as Leer EP-EDF-10
    participant DataConversion as Data Conversion
    participant DerivedColumn as Derived Column
    participant Lookup as Lookup
    participant ADODestination as Destino de ADO.NET

    ExcelSource-&gt;&gt;DataConversion: Flujo de datos
    DataConversion-&gt;&gt;DerivedColumn: Datos convertidos
    DerivedColumn-&gt;&gt;Lookup: Datos transformados
    Lookup-&gt;&gt;ADODestination: Datos validados</code></pre>
<h3 id="componente-procesar-fact_permiso_estudiante">Componente <strong><code>Procesar FACT_PERMISO_ESTUDIANTE</code></strong><a class="headerlink" href="#componente-procesar-fact_permiso_estudiante" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_21">Descripción General<a class="headerlink" href="#descripcion-general_21" title="Permanent link">&para;</a></h4>
<p>El flujo de datos del paquete SSIS procesa y carga información relacionada con permisos de estudiantes desde un archivo Excel hacia la base de datos del Colegio en la tabla <code>FACT_PERMISO_ESTUDIANTE</code>. El proceso incluye la validación, transformación y enriquecimiento de los datos.</p>
<h4 id="componentes-del-flujo-de-datos_9">Componentes del Flujo de Datos<a class="headerlink" href="#componentes-del-flujo-de-datos_9" title="Permanent link">&para;</a></h4>
<p><strong>1. Leer EP-EDF-04</strong></p>
<ul>
<li><strong>Descripción:</strong> Origen de datos Excel que lee los registros desde la hoja <code>Hoja1$</code>.</li>
<li><strong>Propiedades:</strong><ul>
<li>Tiempo de espera: <code>0</code> (sin límite).</li>
<li>Modo de acceso: <code>0</code> (predeterminado).</li>
</ul>
</li>
<li><strong>Columnas de salida:</strong> Incluye datos como <code>FECHA</code>, <code>BP_ESTUDIANTE</code>, <code>NOMBRE_ESTUDIANTE</code>, <code>GRADO</code>, <code>CURSO</code>, entre otros.</li>
</ul>
<p><strong>2. Data Conversion</strong></p>
<ul>
<li><strong>Descripción:</strong> Convierte tipos de datos y ajusta las columnas para la compatibilidad con los pasos posteriores.</li>
<li><strong>Propiedades:</strong><ul>
<li>Asigna un prefijo <code>Copy of</code> a las columnas convertidas.</li>
<li>Convierte columnas como <code>BP_ESTUDIANTE</code> (tipo <code>wstr</code>) y <code>FECHA</code> (tipo <code>date</code>).</li>
</ul>
</li>
<li><strong>Manejo de errores:</strong> Disposición <code>FailComponent</code>.</li>
</ul>
<p><strong>3. Derived Column</strong></p>
<ul>
<li><strong>Descripción:</strong> Genera nuevas columnas derivadas utilizando expresiones matemáticas y lógicas.</li>
<li><strong>Columnas generadas:</strong><ul>
<li><code>ID_FECHA</code>: Calculada como una combinación de <code>Año</code>, <code>Mes</code> y <code>Día</code>.</li>
<li><code>ANIO_ACADEMICO</code>: Extraído del año de la columna <code>Copy of FECHA</code>.</li>
</ul>
</li>
</ul>
<p><strong>4. Lookup</strong></p>
<ul>
<li><strong>Descripción:</strong> Busca información adicional en la tabla de dimensiones <code>DIM_POBLACION_MATRICULA</code>.</li>
<li><strong>Propiedades:</strong><ul>
<li>Consulta SQL: <code>SELECT * FROM [Colegio].[DIM_POBLACION_MATRICULA]</code>.</li>
<li>Filtra filas basándose en la columna <code>BP_ESTUDIANTE</code>.</li>
</ul>
</li>
</ul>
<p><strong>5. Lookup 1 y Lookup 2</strong></p>
<ul>
<li><strong>Descripción:</strong> <ul>
<li><code>Lookup 1</code>: Busca en <code>DIM_CURSO</code> para obtener el <code>ID_CURSO</code>.</li>
<li><code>Lookup 2</code>: Busca en <code>DIM_GRADO</code> para obtener el <code>ID_GRADO</code>.</li>
</ul>
</li>
<li><strong>Propiedades:</strong><ul>
<li>Ambas operaciones utilizan columnas como <code>CURSO</code> y <code>GRADO</code> para realizar las coincidencias.</li>
</ul>
</li>
</ul>
<p><strong>6. Lookup 3</strong></p>
<ul>
<li><strong>Descripción:</strong> Verifica si ya existen registros en la tabla destino <code>FACT_PERMISO_ESTUDIANTE</code> basándose en las columnas <code>HORA</code>, <code>ID_FECHA</code> e <code>ID_POBLACION_MATRICULA</code>.</li>
<li><strong>Propiedades:</strong><ul>
<li>Consulta SQL: <code>SELECT * FROM [Colegio].[FACT_PERMISO_ESTUDIANTE]</code>.</li>
</ul>
</li>
</ul>
<p><strong>7. Destino de ADO.NET</strong></p>
<ul>
<li><strong>Descripción:</strong> Inserta los datos procesados en la tabla <code>FACT_PERMISO_ESTUDIANTE</code>.</li>
<li><strong>Propiedades:</strong><ul>
<li>Tabla de destino: <code>"Colegio"."FACT_PERMISO_ESTUDIANTE"</code>.</li>
<li>Inserción masiva habilitada con <code>SqlBulkCopy</code>.</li>
</ul>
</li>
</ul>
<h4 id="diagrama-de-secuencia_14">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia_14" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant ExcelSource as Leer EP-EDF-04
    participant DataConversion as Data Conversion
    participant DerivedColumn as Derived Column
    participant Lookup1 as Lookup DIM_POBLACION_MATRICULA
    participant Lookup2 as Lookup DIM_CURSO
    participant Lookup3 as Lookup DIM_GRADO
    participant LookupFinal as Lookup FACT_PERMISO_ESTUDIANTE
    participant Destination as Destino ADO.NET

    ExcelSource-&gt;&gt;DataConversion: Datos leídos
    DataConversion-&gt;&gt;DerivedColumn: Datos convertidos
    DerivedColumn-&gt;&gt;Lookup1: Validación de BP_ESTUDIANTE
    Lookup1-&gt;&gt;Lookup2: Validación de CURSO
    Lookup2-&gt;&gt;Lookup3: Validación de GRADO
    Lookup3-&gt;&gt;Destination: Inserción en tabla destino</code></pre>
<h3 id="componente-procesar-fact_psiorientacion">Componente <strong><code>Procesar FACT_PSIORIENTACION</code></strong><a class="headerlink" href="#componente-procesar-fact_psiorientacion" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_22">Descripción General<a class="headerlink" href="#descripcion-general_22" title="Permanent link">&para;</a></h4>
<p>El flujo de datos del paquete SSIS procesa y carga información de orientación psicológica de estudiantes desde un archivo Excel hacia la tabla de destino <code>FACT_PSICORIENTACION</code> en la base de datos. Incluye transformaciones de datos, validaciones y enriquecimientos utilizando varias transformaciones de SSIS.</p>
<h4 id="componentes-del-flujo-de-datos_10">Componentes del Flujo de Datos<a class="headerlink" href="#componentes-del-flujo-de-datos_10" title="Permanent link">&para;</a></h4>
<p><strong>1. Leer EP-EDF-11</strong></p>
<ul>
<li><strong>Descripción:</strong> Origen de datos Excel que lee la hoja <code>Hoja1$</code> para obtener la información.</li>
<li><strong>Propiedades:</strong><ul>
<li><strong>Tiempo de espera:</strong> 0 (sin límite).</li>
<li><strong>Modo de acceso:</strong> Predeterminado.</li>
</ul>
</li>
<li><strong>Columnas de salida:</strong><ul>
<li><code>BP_ESTUDIANTE</code>, <code>IDCASO</code>, <code>ANIO_ACADEMICO</code>, <code>TIPO_DOCUMENTO</code>, <code>DOCUMENTO</code>, <code>FECHA_ATENCION</code>, <code>FECHA_SOLUCION</code>, <code>ESTADO</code>, <code>QUIEN_REMITE</code>, <code>NOTIFICACION_A_PADRES</code>, <code>MOTIVO_ATENCION</code>.</li>
</ul>
</li>
</ul>
<p><strong>2. Data Conversion</strong></p>
<ul>
<li><strong>Descripción:</strong> Conversión de tipos de datos y ajuste de columnas.</li>
<li><strong>Propiedades:</strong><ul>
<li>Agrega un prefijo <code>Copy of</code> a las columnas convertidas.</li>
<li>Convierte tipos de datos a <code>wstr</code>, <code>i4</code>, o <code>date</code> según corresponda.</li>
</ul>
</li>
<li><strong>Manejo de errores:</strong> <ul>
<li>Disposición de error: <code>FailComponent</code>.</li>
</ul>
</li>
</ul>
<p><strong>3. Derived Column</strong></p>
<ul>
<li><strong>Descripción:</strong> Crea nuevas columnas derivadas a partir de las columnas de entrada.</li>
<li><strong>Columnas creadas:</strong><ul>
<li><code>ID_FECHA</code>: Construido a partir del año, mes y día de <code>Copy of FECHA_ATENCION</code>.</li>
<li><code>ANIO_ACADEMICO</code>: Extraído del año de <code>Copy of FECHA_ATENCION</code>.</li>
</ul>
</li>
</ul>
<p><strong>4. Lookup</strong></p>
<ul>
<li><strong>Descripción:</strong> Busca en la tabla <code>DIM_POBLACION_MATRICULA</code> para enriquecer los datos con el identificador <code>ID_POBLACION_MATRICULA</code>.</li>
<li><strong>Consulta SQL:</strong> <code>SELECT * FROM [Colegio].[DIM_POBLACION_MATRICULA]</code>.</li>
<li><strong>Condiciones de búsqueda:</strong> <code>TIPO_DOCUMENTO</code> y <code>DOCUMENTO</code>.</li>
</ul>
<hr />
<p><strong>5. Derived Column 1</strong></p>
<ul>
<li><strong>Descripción:</strong> Valida y ajusta el valor de <code>ID_POBLACION_MATRICULA</code> derivado.</li>
<li><strong>Expresión derivada:</strong><ul>
<li>Si el valor de <code>ID_POBLACION_MATRICULA</code> es nulo, asigna <code>-1</code>.</li>
</ul>
</li>
</ul>
<hr />
<p><strong>6. Lookup 1</strong></p>
<ul>
<li><strong>Descripción:</strong> Valida si el registro ya existe en la tabla <code>FACT_PSICORIENTACION</code> en función de <code>ID_CASO</code>, <code>ID_FECHA</code>, y <code>ID_POBLACION_MATRICULA</code>.</li>
<li><strong>Consulta SQL:</strong> 
  <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">FACT_PSICORIENTACION</span><span class="p">]</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">ID_CASO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">ID_FECHA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">ID_POBLACION_MATRICULA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
</code></pre></div></li>
</ul>
<p><strong>7. Destino de ADO.NET</strong></p>
<ul>
<li><strong>Descripción:</strong> Inserta los datos procesados en la tabla <code>FACT_PSICORIENTACION</code>.</li>
<li><strong>Propiedades:</strong><ul>
<li><strong>Tabla destino:</strong> <code>"Colegio"."FACT_PSICORIENTACION"</code>.</li>
<li><strong>Tamaño de lote:</strong> 0 (predeterminado, utiliza el tamaño del buffer interno).</li>
<li><strong>Tiempo de espera del comando:</strong> 30 segundos.</li>
<li><strong>Uso de <code>SqlBulkCopy</code>:</strong> Activado para mejorar el rendimiento.</li>
</ul>
</li>
</ul>
<h4 id="diagrama-de-secuencia_15">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia_15" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant ExcelSource as Leer EP-EDF-11
    participant DataConversion as Data Conversion
    participant DerivedColumn as Derived Column
    participant Lookup1 as Lookup DIM_POBLACION_MATRICULA
    participant DerivedColumn2 as Derived Column Ajustado
    participant Lookup2 as Lookup FACT_PSICORIENTACION
    participant Destination as Destino ADO.NET

    ExcelSource-&gt;&gt;DataConversion: Leer datos desde Excel
    DataConversion-&gt;&gt;DerivedColumn: Convertir datos y crear ID_FECHA
    DerivedColumn-&gt;&gt;Lookup1: Validar información con DIM_POBLACION_MATRICULA
    Lookup1-&gt;&gt;DerivedColumn2: Validar ID_POBLACION_MATRICULA
    DerivedColumn2-&gt;&gt;Lookup2: Verificar existencia en FACT_PSICORIENTACION
    Lookup2-&gt;&gt;Destination: Insertar en la tabla destino</code></pre>
<h3 id="componente-procesar-fact_reemplazo_docente">Componente <strong><code>Procesar FACT_REEMPLAZO_DOCENTE</code></strong><a class="headerlink" href="#componente-procesar-fact_reemplazo_docente" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_23">Descripción General<a class="headerlink" href="#descripcion-general_23" title="Permanent link">&para;</a></h4>
<p>Este paquete SSIS realiza la extracción, transformación y carga de datos relacionados con la facturación del reemplazo de docentes. Incluye tareas de conversión de datos, columnas derivadas, búsquedas en tablas de dimensiones y la carga en un destino ADO.NET.</p>
<h4 id="componentes-del-flujo-de-datos_11">Componentes del Flujo de Datos<a class="headerlink" href="#componentes-del-flujo-de-datos_11" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Leer EP-EDF-03</strong><br />
<strong>Descripción</strong>: Fuente de datos que lee información desde un archivo Excel en la hoja "Hoja1$".<br />
<strong>Propiedades</strong>:<br />
        - <code>CommandTimeout</code>: 0<br />
        - <code>OpenRowset</code>: "Hoja1$"<br />
<strong>Columnas de Salida</strong>:  ID_REEMPLAZO, TIPO_DOCUMENTO_DOCENTE_AUSENTE, DOCUMENTO_DOCENTE_AUSENTE, GRADO, FECHA, BLOQUE_HORARIO, NUMERO_HORAS, CURSO, DOCENTE_AUSENTE, DOCENTE_REEMPLAZA, TIPO_DOCUMENTO_DOCENTE_REEMPLAZA, DOCUMENTO_DOCENTE_REEMPLAZA</li>
<li>
<p><strong>Data Conversion</strong><br />
<strong>Descripción</strong>: Realiza conversiones de tipos de datos para columnas específicas.<br />
<strong>Columnas Transformadas</strong>:  </p>
<ul>
<li><code>ANIO_ACADEMICO → DT_I4</code></li>
<li><code>TIPO_DOCUMENTO_DOCENTE_AUSENTE → wstr (longitud 20)</code></li>
<li><code>DOCUMENTO_DOCENTE_AUSENTE → wstr (longitud 40)</code></li>
<li><code>FECHA → date</code></li>
<li><code>BLOQUE_HORARIO → wstr (longitud 40)</code></li>
</ul>
</li>
<li>
<p><strong>Derived Column</strong><br />
<strong>Descripción</strong>: Genera nuevas columnas basadas en expresiones.<br />
<strong>Columnas Derivadas</strong>:<br />
        ID_FECHA: Calculado como <code>(DT_I4)(YEAR([Copy of FECHA]) * 10000 + MONTH([Copy of FECHA]) * 100 + DAY([Copy of FECHA]))</code>.</p>
</li>
<li>
<p><strong>Lookup (DIM_PERSONAL)</strong><br />
<strong>Descripción</strong>: Busca información de personal docente ausente en la tabla <code>[DWH_COMFENALCO].[Transversal].[DIM_PERSONAL]</code>.<br />
<strong>SQL Utilizado</strong>:<br />
        <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="p">[</span><span class="n">ID_PERSONAL</span><span class="p">],</span>
<span class="w">    </span><span class="k">CAST</span><span class="p">(</span><span class="k">LEFT</span><span class="p">([</span><span class="n">COD_PERSONA_UNIDAD</span><span class="p">],</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INT</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ANIO_ACADEMICO</span><span class="p">,</span>
<span class="w">    </span><span class="p">[</span><span class="n">ID_UNIDAD</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">TIPO_DOCUMENTO</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">DOCUMENTO</span><span class="p">]</span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_PERSONAL</span><span class="p">]</span>
<span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">ID_UNIDAD</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</code></pre></div>
    <strong>Columnas Vinculadas</strong>:<br />
        - Copy of TIPO_DOCUMENTO_DOCENTE_AUSENTE → TIPO_DOCUMENTO<br />
        - Copy of DOCUMENTO_DOCENTE_AUSENTE → DOCUMENTO<br />
        - Copy of ANIO_ACADEMICO → ANIO_ACADEMICO  </p>
</li>
<li>
<p><strong>Lookup (DIM_GRADO)</strong><br />
<strong>Descripción</strong>: Busca información del grado en la tabla <code>[Colegio].[DIM_GRADO]</code>.<br />
<strong>SQL Utilizado</strong>:<br />
        <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_GRADO</span><span class="p">];</span>
</code></pre></div>
    <strong>Columnas Vinculadas</strong>:<br />
        - Copy of GRADO → DESC_GRADO  </p>
</li>
<li>
<p><strong>Destino ADO.NET</strong><br />
<strong>Descripción</strong>: Carga los datos transformados en la tabla <code>"Colegio"."FACT_REEMPLAZO_DOCENTE"</code>.<br />
<strong>Propiedades</strong>:<br />
        - <code>BatchSize</code>: 0<br />
        - <code>CommandTimeout</code>: 30<br />
        - <code>UseBulkInsertWhenPossible</code>: true<br />
<strong>Columnas de Entrada</strong>:  ID_FECHA  , ID_PERSONAL_AUSENTE  , ID_PERSONAL_REEMPLAZA  , ID_CURSO  , ID_GRADO  , ANIO_ACADEMICO  , FECHA  </p>
</li>
</ul>
<h4 id="diagrama-de-secuencia_16">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia_16" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant ExcelSource as Leer EP-EDF-03
    participant DataConversion as Data Conversion
    participant DerivedColumn as Derived Column
    participant LookupDimPersonal as Lookup DIM_PERSONAL
    participant LookupDimGrado as Lookup DIM_GRADO
    participant ADONETDestination as Destino ADO.NET

    ExcelSource -&gt;&gt; DataConversion: Transformación de datos
    DataConversion -&gt;&gt; DerivedColumn: Generación de columnas derivadas
    DerivedColumn -&gt;&gt; LookupDimPersonal: Búsqueda de personal
    LookupDimPersonal -&gt;&gt; LookupDimGrado: Búsqueda de grado
    LookupDimGrado -&gt;&gt; ADONETDestination: Carga de datos</code></pre>
<h3 id="componente-procesar-fact_reserva_espacios">Componente <strong><code>Procesar FACT_RESERVA_ESPACIOS</code></strong><a class="headerlink" href="#componente-procesar-fact_reserva_espacios" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_24">Descripción General<a class="headerlink" href="#descripcion-general_24" title="Permanent link">&para;</a></h4>
<p>Este paquete SSIS procesa los datos relacionados con la reserva de espacios educativos. Realiza la extracción desde un archivo Excel, transforma los datos mediante conversiones y cálculos, realiza búsquedas de información adicional en tablas de dimensiones y carga los datos transformados en una tabla de destino en SQL Server.</p>
<h4 id="componentes-del-flujo-de-datos_12">Componentes del Flujo de Datos<a class="headerlink" href="#componentes-del-flujo-de-datos_12" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong>Leer EP-EDF-12</strong></p>
<ul>
<li><strong>Descripción</strong>: Este componente extrae los datos desde un archivo Excel. Utiliza la hoja <code>Hoja1$</code>.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>CommandTimeout</code>: 0</li>
<li><code>OpenRowset</code>: Hoja1$</li>
</ul>
</li>
<li><strong>Columnas de Salida</strong>:<code>ANIO_ACADEMICO</code>, <code>ID_RESERVA</code>, <code>FECHA_SOLICITUD</code>, <code>FECHA_RESERVA</code>, <code>TIPO_DOCUMENTO_DOCENTO</code>, <code>DOCUMENTO_DOCENTE</code>, <code>CORREO_DOCENTE</code>, <code>HORA_INICIO</code>, <code>HORA_FIN</code>, <code>ACTIVIDAD_PLANEADA</code>, <code>PLACA_PORTATIL</code>, <code>VIDEOBEAM</code></li>
</ul>
</li>
<li>
<p><strong>Data Conversion</strong></p>
<ul>
<li><strong>Descripción</strong>: Realiza conversiones de tipos de datos para asegurar la compatibilidad con los componentes posteriores.</li>
<li><strong>Transformaciones</strong>:<ul>
<li>ANIO_ACADEMICO → <code>DT_I4</code></li>
<li>ID_RESERVA → <code>DT_I4</code></li>
<li>FECHA_SOLICITUD → <code>DT_DATE</code></li>
<li>FECHA_RESERVA → <code>DT_DATE</code></li>
<li>TIPO_DOCUMENTO_DOCENTE → <code>wstr</code> (40)</li>
<li>DOCUMENTO_DOCENTE → <code>wstr</code> (20)</li>
<li>CORREO_DOCENTE → <code>wstr</code> (200)</li>
<li>HORA_INICIO → <code>wstr</code> (40)</li>
<li>HORA_FIN → <code>wstr</code> (40)</li>
<li>ACTIVIDAD_PLANEADA → <code>wstr</code> (40)</li>
<li>PLACA_PORTATIL → <code>wstr</code> (40)</li>
<li>VIDEOBEAM → <code>wstr</code> (40)</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Derived Column</strong></p>
<ul>
<li><strong>Descripción</strong>: Genera nuevas columnas a partir de cálculos con las columnas existentes.</li>
<li><strong>Transformaciones</strong>:<ul>
<li><code>ID_FECHA</code>: <code>(DT_I4)(YEAR([Copy of FECHA_RESERVA]) * 10000 + MONTH([Copy of FECHA_RESERVA]) * 100 + DAY([Copy of FECHA_RESERVA]))</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Lookup (DIM_PERSONAL)</strong></p>
<ul>
<li><strong>Descripción</strong>: Realiza una búsqueda en la tabla <code>[DWH_COMFENALCO].[Transversal].[DIM_PERSONAL]</code> para obtener información adicional del personal docente.</li>
<li><strong>SQL Utilizado</strong>:
    <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="p">[</span><span class="n">ID_PERSONAL</span><span class="p">],</span>
<span class="w">       </span><span class="k">CAST</span><span class="p">(</span><span class="k">LEFT</span><span class="p">([</span><span class="n">COD_PERSONA_UNIDAD</span><span class="p">],</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INT</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ANIO_ACADEMICO</span><span class="p">,</span>
<span class="w">       </span><span class="p">[</span><span class="n">ID_UNIDAD</span><span class="p">],</span>
<span class="w">       </span><span class="p">[</span><span class="n">TIPO_DOCUMENTO</span><span class="p">],</span>
<span class="w">       </span><span class="p">[</span><span class="n">DOCUMENTO</span><span class="p">]</span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_PERSONAL</span><span class="p">]</span>
<span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">ID_UNIDAD</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</code></pre></div></li>
<li><strong>Columnas Vinculadas</strong>:<ul>
<li>Copy of ANIO_ACADEMICO → ANIO_ACADEMICO</li>
<li>Copy of TIPO_DOCUMENTO_DOCENTE → TIPO_DOCUMENTO</li>
<li>Copy of DOCUMENTO_DOCENTE → DOCUMENTO</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Destino ADO.NET</strong></p>
<ul>
<li><strong>Descripción</strong>: Carga los datos transformados en la tabla <code>"Colegio"."FACT_RESERVA_ESPACIOS"</code>.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>BatchSize</code>: 0</li>
<li><code>CommandTimeout</code>: 30</li>
<li><code>UseBulkInsertWhenPossible</code>: true</li>
</ul>
</li>
<li><strong>Columnas de Entrada</strong>:
    <code>ID_FECHA</code>, <code>ID_PERSONAL</code>, <code>Copy of ID_RESERVA</code>, <code>Copy of DOCUMENTO_DOCENTE</code>, <code>Copy of FECHA_SOLICITUD</code>, <code>Copy of FECHA_RESERVA</code>, <code>Copy of CORREO_DOCENTE</code>, <code>Copy of HORA_INICIO</code>, <code>Copy of HORA_FIN</code>, <code>Copy of ACTIVIDAD_PLANEADA</code>, <code>Copy of PLACA_PORTATIL</code>, <code>Copy of VIDEOBEAM</code></li>
</ul>
</li>
</ul>
<h4 id="diagrama-de-secuencia_17">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia_17" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant ExcelSource as Leer EP-EDF-12
    participant DataConversion as Data Conversion
    participant DerivedColumn as Derived Column
    participant LookupDimPersonal as Lookup DIM_PERSONAL
    participant ADONETDestination as Destino ADO.NET

    ExcelSource -&gt;&gt; DataConversion: Transformación de datos
    DataConversion -&gt;&gt; DerivedColumn: Generación de columnas derivadas
    DerivedColumn -&gt;&gt; LookupDimPersonal: Búsqueda de datos adicionales
    LookupDimPersonal -&gt;&gt; ADONETDestination: Carga de datos transformados</code></pre>
<h3 id="componente-procesar-fact_saber11_colegios">Componente <strong><code>Procesar FACT_SABER11_COLEGIOS</code></strong><a class="headerlink" href="#componente-procesar-fact_saber11_colegios" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_25">Descripción General<a class="headerlink" href="#descripcion-general_25" title="Permanent link">&para;</a></h4>
<p>Este paquete de SSIS procesa datos relacionados con las evaluaciones del SABER 11 para colegios, extrayendo información de un archivo Excel, transformando y enriqueciendo los datos con cálculos derivados y búsquedas, y cargándolos en una tabla de destino en SQL Server.</p>
<h4 id="componentes-del-flujo-de-datos_13">Componentes del Flujo de Datos<a class="headerlink" href="#componentes-del-flujo-de-datos_13" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong>Leer EP-EDF-08</strong></p>
<ul>
<li><strong>Descripción</strong>: Extrae datos desde un archivo Excel ubicado en <code>Hoja1$</code>.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>CommandTimeout</code>: 0</li>
<li><code>OpenRowset</code>: Hoja1$</li>
</ul>
</li>
<li><strong>Columnas de Salida</strong>:<ul>
<li><code>ANIO_ACADEMICO</code> (año académico del registro)</li>
<li><code>ID_REGISTRO</code> (identificador del registro)</li>
<li><code>CODIDGO_DANE_ESTABLECIMIENTO_EDUCATIVO</code> (código DANE del establecimiento educativo)</li>
<li><code>NOMBRE_ESTABLECIMIENTO_EDUCATIVO</code> (nombre del establecimiento)</li>
<li><code>RESULTADO</code> (resultado del examen SABER 11)</li>
<li><code>CATEGORIA_SABER11</code> (categoría del colegio según el SABER 11)</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Data Conversion</strong></p>
<ul>
<li><strong>Descripción</strong>: Realiza conversiones de tipo de datos para asegurar la compatibilidad con los siguientes pasos del flujo de datos.</li>
<li><strong>Transformaciones</strong>:<ul>
<li><code>ANIO_ACADEMICO</code> → <code>DT_I4</code></li>
<li><code>ID_REGISTRO</code> → <code>wstr</code> (255)</li>
<li><code>CODIDGO_DANE_ESTABLECIMIENTO_EDUCATIVO</code> → <code>wstr</code> (40)</li>
<li><code>NOMBRE_ESTABLECIMIENTO_EDUCATIVO</code> → <code>wstr</code> (200)</li>
<li><code>RESULTADO</code> → <code>wstr</code> (40)</li>
<li><code>CATEGORIA_SABER11</code> → <code>wstr</code> (40)</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Lookup</strong></p>
<ul>
<li><strong>Descripción</strong>: Realiza una búsqueda en la tabla <code>[DWH_COMFENALCO].[Colegio].[FACT_SABER11_COLEGIOS]</code> para enriquecer los datos con información adicional.</li>
<li><strong>SQL Utilizado</strong>:
    <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="p">[</span><span class="n">ID_REGISTRO</span><span class="p">],</span>
<span class="w">       </span><span class="p">[</span><span class="n">ID_FECHA</span><span class="p">],</span>
<span class="w">       </span><span class="k">CAST</span><span class="p">([</span><span class="n">ANIO_ACADEMICO</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INT</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ANIO_ACADEMICO</span><span class="p">,</span>
<span class="w">       </span><span class="p">[</span><span class="n">COD_ESTABLECIMIENTO_EDUCATIVO</span><span class="p">],</span>
<span class="w">       </span><span class="p">[</span><span class="n">NOMBRE_EE</span><span class="p">],</span>
<span class="w">       </span><span class="p">[</span><span class="n">RESULTADO</span><span class="p">],</span>
<span class="w">       </span><span class="p">[</span><span class="n">CATEGORIA_SABER11</span><span class="p">]</span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">FACT_SABER11_COLEGIOS</span><span class="p">];</span>
</code></pre></div></li>
<li><strong>Columnas Vinculadas</strong>:<ul>
<li><code>CODIDGO_DANE_ESTABLECIMIENTO_EDUCATIVO</code> → <code>COD_ESTABLECIMIENTO_EDUCATIVO</code></li>
<li><code>ANIO_ACADEMICO</code> → <code>ANIO_ACADEMICO</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Derived Column</strong></p>
<ul>
<li><strong>Descripción</strong>: Calcula una columna derivada para el identificador de fecha.</li>
<li><strong>Transformaciones</strong>:<ul>
<li><code>ID_FECHA</code>: <code>(DT_I4)((DT_STR,4,1252)ANIO_ACADEMICO + "1201")</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Destino ADO.NET</strong></p>
<ul>
<li><strong>Descripción</strong>: Carga los datos procesados en la tabla de destino <code>"Colegio"."FACT_SABER11_COLEGIOS"</code>.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>BatchSize</code>: 0</li>
<li><code>CommandTimeout</code>: 30</li>
<li><code>UseBulkInsertWhenPossible</code>: true</li>
</ul>
</li>
<li><strong>Columnas de Entrada</strong>:<ul>
<li><code>ID_FECHA</code> (identificador único para la fecha derivada)</li>
<li><code>ANIO_ACADEMICO</code> (año académico)</li>
<li><code>CODIDGO_DANE_ESTABLECIMIENTO_EDUCATIVO</code> (código DANE del establecimiento)</li>
<li><code>NOMBRE_ESTABLECIMIENTO_EDUCATIVO</code> (nombre del establecimiento)</li>
<li><code>RESULTADO</code> (resultado del examen)</li>
<li><code>CATEGORIA_SABER11</code> (categoría según el examen SABER 11)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="diagrama-de-secuencia_18">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia_18" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant ExcelSource as Leer EP-EDF-08
    participant DataConversion as Data Conversion
    participant Lookup as Lookup SABER11
    participant DerivedColumn as Derived Column
    participant ADONETDestination as Destino ADO.NET

    ExcelSource -&gt;&gt; DataConversion: Transformación de datos
    DataConversion -&gt;&gt; Lookup: Enriquecimiento de datos
    Lookup -&gt;&gt; DerivedColumn: Generación de columnas derivadas
    DerivedColumn -&gt;&gt; ADONETDestination: Carga de datos transformados</code></pre>
<h3 id="componente-procesar-fact_saber11_individual">Componente <strong><code>Procesar FACT_SABER11_INDIVIDUAL</code></strong><a class="headerlink" href="#componente-procesar-fact_saber11_individual" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_26">Descripción General<a class="headerlink" href="#descripcion-general_26" title="Permanent link">&para;</a></h4>
<p>Este paquete de SSIS procesa datos individuales del SABER 11, extrayendo información desde un archivo Excel, transformando y enriqueciendo los datos mediante conversiones, columnas derivadas y búsquedas, para finalmente almacenarlos en una tabla de destino en SQL Server.</p>
<h4 id="componentes-del-flujo-de-datos_14">Componentes del Flujo de Datos<a class="headerlink" href="#componentes-del-flujo-de-datos_14" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Leer EP-EDF-07</strong></p>
<ul>
<li><strong>Descripción</strong>: Extrae datos desde un archivo Excel ubicado en <code>Hoja1$</code>.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>CommandTimeout</code>: 0</li>
<li><code>OpenRowset</code>: Hoja1$</li>
</ul>
</li>
<li><strong>Columnas de Salida</strong>:
<code>ANIO_ACADEMICO</code>, <code>ID_REGISTRO</code>, <code>RESULTADO</code>, <code>BP_ESTUDIANTE</code>, <code>TIPO_DOCUMENTO</code>, <code>DOCUMENTO</code>, <code>FECHA</code>, <code>TEMATICA</code></li>
</ul>
</li>
<li>
<p><strong>Data Conversion</strong></p>
<ul>
<li><strong>Descripción</strong>: Convierte los tipos de datos de las columnas para asegurar la compatibilidad con el resto del flujo.</li>
<li><strong>Transformaciones</strong>:<ul>
<li><code>ANIO_ACADEMICO</code> → <code>DT_I4</code></li>
<li><code>RESULTADO</code> → <code>wstr</code> (40)</li>
<li><code>BP_ESTUDIANTE</code> → <code>wstr</code> (40)</li>
<li><code>TIPO_DOCUMENTO</code> → <code>wstr</code> (40)</li>
<li><code>DOCUMENTO</code> → <code>wstr</code> (20)</li>
<li><code>FECHA</code> → <code>date</code></li>
<li><code>TEMATICA</code> → <code>wstr</code> (40)</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Derived Column</strong></p>
<ul>
<li><strong>Descripción</strong>: Genera un identificador único para las fechas en formato <code>YYYYMMDD</code>.</li>
<li><strong>Transformaciones</strong>:<ul>
<li><code>ID_FECHA</code>: <code>(DT_I4)(YEAR([FECHA]) * 10000 + MONTH([FECHA]) * 100 + DAY([FECHA]))</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Lookup (DIM_POBLACION_MATRICULA)</strong></p>
<ul>
<li><strong>Descripción</strong>: Enriquecer los datos con información de la tabla <code>[Colegio].[DIM_POBLACION_MATRICULA]</code>.</li>
<li><strong>Consulta SQL</strong>:
    <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_POBLACION_MATRICULA</span><span class="p">]</span>
</code></pre></div></li>
<li><strong>Columnas Vinculadas</strong>:<ul>
<li><code>BP_ESTUDIANTE</code> → <code>PARTNER</code></li>
</ul>
</li>
<li><strong>Salida</strong>:<ul>
<li><code>ID_POBLACION_MATRICULA</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Lookup (FACT_SABER11_INDIVIDUAL)</strong></p>
<ul>
<li><strong>Descripción</strong>: Verifica si los datos ya existen en la tabla de destino <code>[Colegio].[FACT_SABER11_INDIVIDUAL]</code>.</li>
<li><strong>Consulta SQL</strong>:
    <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">ID_REGISTRO</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">ID_FECHA</span><span class="p">],</span>
<span class="w">    </span><span class="k">CAST</span><span class="p">([</span><span class="n">ANIO_ACADEMICO</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">INT</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ANIO_ACADEMICO</span><span class="p">,</span>
<span class="w">    </span><span class="p">[</span><span class="n">ID_POBLACION_MATRICULA</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">TEMATICA</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">RESULTADO</span><span class="p">]</span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">FACT_SABER11_INDIVIDUAL</span><span class="p">]</span>
</code></pre></div></li>
<li><strong>Columnas Vinculadas</strong>:<ul>
<li><code>ANIO_ACADEMICO</code></li>
<li><code>TEMATICA</code></li>
<li><code>ID_POBLACION_MATRICULA</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Derived Column (Validación de ID_POBLACION_MATRICULA)</strong></p>
<ul>
<li><strong>Descripción</strong>: Agrega una validación para la columna <code>ID_POBLACION_MATRICULA</code>.</li>
<li><strong>Transformaciones</strong>:<ul>
<li><code>ID_POBLACION_MATRICULA</code>: <code>ISNULL(ID_POBLACION_MATRICULA) ? -1 : ID_POBLACION_MATRICULA</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Destino ADO.NET</strong></p>
<ul>
<li><strong>Descripción</strong>: Inserta los datos procesados en la tabla <code>"Colegio"."FACT_SABER11_INDIVIDUAL"</code>.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>TableOrViewName</code>: <code>"Colegio"."FACT_SABER11_INDIVIDUAL"</code></li>
<li><code>BatchSize</code>: 0</li>
<li><code>CommandTimeout</code>: 30</li>
<li><code>UseBulkInsertWhenPossible</code>: true</li>
</ul>
</li>
<li><strong>Columnas de Entrada</strong>:<ul>
<li><code>ID_FECHA</code></li>
<li><code>ID_POBLACION_MATRICULA</code></li>
<li><code>ANIO_ACADEMICO</code></li>
<li><code>TEMATICA</code></li>
<li><code>RESULTADO</code></li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="diagrama-de-secuencia_19">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia_19" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant ExcelSource as Leer EP-EDF-07
    participant DataConversion as Data Conversion
    participant DerivedColumn as Derived Column (Fecha)
    participant LookupDIM as Lookup DIM_POBLACION_MATRICULA
    participant LookupFACT as Lookup FACT_SABER11_INDIVIDUAL
    participant DerivedColumn2 as Derived Column (Validación)
    participant ADONETDestination as Destino ADO.NET

    ExcelSource -&gt;&gt; DataConversion: Convertir tipos de datos
    DataConversion -&gt;&gt; DerivedColumn: Crear ID_FECHA
    DerivedColumn -&gt;&gt; LookupDIM: Enriquecer datos con ID_POBLACION_MATRICULA
    LookupDIM -&gt;&gt; LookupFACT: Verificar existencia en FACT_SABER11_INDIVIDUAL
    LookupFACT -&gt;&gt; DerivedColumn2: Validar ID_POBLACION_MATRICULA
    DerivedColumn2 -&gt;&gt; ADONETDestination: Insertar datos en tabla de destino</code></pre>
<h3 id="componente-procesar-fact_servicio_social">Componente <strong><code>Procesar FACT_SERVICIO_SOCIAL</code></strong><a class="headerlink" href="#componente-procesar-fact_servicio_social" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_27">Descripción General<a class="headerlink" href="#descripcion-general_27" title="Permanent link">&para;</a></h4>
<p>Este paquete de SSIS procesa datos relacionados con el servicio social de estudiantes, transformando y enriqueciendo la información desde un archivo Excel para almacenarla en una base de datos relacional. Incluye conversiones de datos, búsqueda de información relacionada y validaciones, y finalmente inserta los datos en una tabla de destino.</p>
<h4 id="componentes-del-flujo-de-datos_15">Componentes del Flujo de Datos<a class="headerlink" href="#componentes-del-flujo-de-datos_15" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Leer EP-EDF-13</strong></p>
<ul>
<li><strong>Descripción</strong>: Extrae datos desde un archivo Excel, ubicado en la hoja <code>Hoja1$</code>.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>CommandTimeout</code>: 0</li>
<li><code>OpenRowset</code>: Hoja1$</li>
</ul>
</li>
<li><strong>Columnas de Salida</strong>:<ul>
<li><code>ANIO_ACADEMICO</code>, <code>BP_ESTUDIANTE</code>, <code>TIPO_DOCUMENTO</code>, <code>DOCUMENTO</code>, <code>GRADO</code>, <code>CURSO</code>, <code>HORARIO</code>, <code>PROYECTO</code>, <code>PAZ_Y_SALVO</code>, <code>HORAS_EJECUTADAS</code>, <code>AUTORIZACION_ACUDIENTE</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Data Conversion</strong></p>
<ul>
<li><strong>Descripción</strong>: Convierte las columnas para asegurar compatibilidad en el flujo.</li>
<li><strong>Transformaciones</strong>:<ul>
<li><code>ANIO_ACADEMICO</code> → <code>DT_I4</code></li>
<li><code>TIPO_DOCUMENTO</code>, <code>DOCUMENTO</code>, <code>GRADO</code>, <code>CURSO</code>, <code>HORARIO</code>, <code>PROYECTO</code>, <code>PAZ_Y_SALVO</code>, <code>HORAS_EJECUTADAS</code>, <code>AUTORIZACION_ACUDIENTE</code> → <code>wstr</code></li>
</ul>
</li>
<li><strong>Columnas Convertidas</strong>: Todas las columnas del componente de entrada.</li>
</ul>
</li>
<li>
<p><strong>Lookup: DIM_POBLACION_MATRICULA</strong></p>
<ul>
<li><strong>Descripción</strong>: Busca el identificador de población en la tabla <code>[Colegio].[DIM_POBLACION_MATRICULA]</code> usando <code>BP_ESTUDIANTE</code>.</li>
<li><strong>Consulta SQL</strong>:
    <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_POBLACION_MATRICULA</span><span class="p">]</span>
<span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">PARTNER</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
</code></pre></div></li>
<li><strong>Columnas de Salida</strong>: <code>ID_POBLACION_MATRICULA</code></li>
</ul>
</li>
<li>
<p><strong>Lookup: DIM_CURSO</strong></p>
<ul>
<li><strong>Descripción</strong>: Busca el identificador del curso en la tabla <code>[Colegio].[DIM_CURSO]</code> usando <code>DESC_CURSO</code>.</li>
<li><strong>Consulta SQL</strong>:
    <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_CURSO</span><span class="p">]</span>
<span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">DESC_CURSO</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
</code></pre></div></li>
<li><strong>Columnas de Salida</strong>: <code>ID_CURSO</code></li>
</ul>
</li>
<li>
<p><strong>Lookup: DIM_GRADO</strong></p>
<ul>
<li><strong>Descripción</strong>: Busca el identificador del grado en la tabla <code>[Colegio].[DIM_GRADO]</code> usando <code>DESC_GRADO</code>.</li>
<li><strong>Consulta SQL</strong>:
    <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_GRADO</span><span class="p">]</span>
<span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">DESC_GRADO</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
</code></pre></div></li>
<li><strong>Columnas de Salida</strong>: <code>ID_GRADO</code></li>
</ul>
</li>
<li>
<p><strong>Lookup: FACT_SERVICIO_SOCIAL</strong></p>
<ul>
<li><strong>Descripción</strong>: Verifica la existencia de registros en la tabla <code>[Colegio].[FACT_SERVICIO_SOCIAL]</code>.</li>
<li><strong>Consulta SQL</strong>:
    <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="p">[</span><span class="n">ID_REGISTRO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">ANIO_ACADEMICO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">ID_POBLACION_MATRICULA</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">ID_CURSO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">ID_GRADO</span><span class="p">]</span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">FACT_SERVICIO_SOCIAL</span><span class="p">]</span>
<span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">ANIO_ACADEMICO</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">[</span><span class="n">ID_POBLACION_MATRICULA</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">[</span><span class="n">ID_CURSO</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">[</span><span class="n">ID_GRADO</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
</code></pre></div></li>
</ul>
</li>
<li>
<p><strong>Derived Column</strong></p>
<ul>
<li><strong>Descripción</strong>: Agrega validaciones para columnas enriquecidas.</li>
<li><strong>Transformaciones</strong>:<ul>
<li><code>ID_POBLACION_MATRICULA</code>: <code>ISNULL(ID_POBLACION_MATRICULA) ? -1 : ID_POBLACION_MATRICULA</code></li>
<li><code>ID_CURSO</code>: <code>ISNULL(ID_CURSO) ? -1 : ID_CURSO</code></li>
<li><code>ID_GRADO</code>: <code>ISNULL(ID_GRADO) ? -1 : ID_GRADO</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Destino ADO.NET</strong></p>
<ul>
<li><strong>Descripción</strong>: Inserta los datos procesados en la tabla <code>"Colegio"."FACT_SERVICIO_SOCIAL"</code>.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>TableOrViewName</code>: <code>"Colegio"."FACT_SERVICIO_SOCIAL"</code></li>
<li><code>BatchSize</code>: 0</li>
<li><code>CommandTimeout</code>: 30</li>
<li><code>UseBulkInsertWhenPossible</code>: true</li>
</ul>
</li>
</ul>
</li>
</ol>
<h4 id="diagrama-de-secuencia_20">Diagrama de Secuencia<a class="headerlink" href="#diagrama-de-secuencia_20" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant ExcelSource as Leer EP-EDF-13
    participant DataConversion as Data Conversion
    participant Lookup1 as Lookup DIM_POBLACION_MATRICULA
    participant Lookup2 as Lookup DIM_CURSO
    participant Lookup3 as Lookup DIM_GRADO
    participant Lookup4 as Lookup FACT_SERVICIO_SOCIAL
    participant DerivedColumn as Derived Column
    participant ADO as Destino ADO.NET

    ExcelSource -&gt;&gt; DataConversion: Convertir datos
    DataConversion -&gt;&gt; Lookup1: Buscar ID_POBLACION_MATRICULA
    Lookup1 -&gt;&gt; Lookup2: Buscar ID_CURSO
    Lookup2 -&gt;&gt; Lookup3: Buscar ID_GRADO
    Lookup3 -&gt;&gt; Lookup4: Verificar existencia
    Lookup4 -&gt;&gt; DerivedColumn: Validar IDs
    DerivedColumn -&gt;&gt; ADO: Insertar datos en FACT_SERVICIO_SOCIAL</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
        <script src="../../js/mkdocs_pagetree_plugin.js"></script>
      
        <script src="../../js/init_mermaid.js"></script>
      
    
  </body>
</html>