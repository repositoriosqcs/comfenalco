
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../00-SCRAPING/">
      
      
        <link rel="next" href="../02-TRANSVERSAL_FACT/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>01. TRANSVERSAL_DIMENSIONES - COMFENALCO</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2afb09e1.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/mkdocs_pagetree_plugin.css">
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="23abf7" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#transversal_dimensiones" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="COMFENALCO" class="md-header__button md-logo" aria-label="COMFENALCO" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            COMFENALCO
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              01. TRANSVERSAL_DIMENSIONES
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="COMFENALCO" class="md-nav__button md-logo" aria-label="COMFENALCO" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    COMFENALCO
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    00. INICIO
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            00. INICIO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    INTRODUCCIÓN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../instalacion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    INSTALACIÓN Y CONFIGURACIÓN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Conexiones_BD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CONEXIÓN A BASE DE DATOS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../buenaspracticas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    BUENAS PRÁCTICAS
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    01. SCRIPTS SQL
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            01. SCRIPTS SQL
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.scripts/00.Inicio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introducción
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.scripts/00.Eliminar_todo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    00. Eliminar Todo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.scripts/01.Transversal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01. Transversal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.scripts/02.Cedesarrollo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02. Cedesarrollo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.scripts/03.Proteccion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    03. Proteccion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.scripts/04.Colegio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    04. Colegio
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../01.scripts/05.Tablas_Stage_Area/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    05. Tablas Stage Area
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    02. ESTRUCTURA SHAREPOINT
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            02. ESTRUCTURA SHAREPOINT
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04.sharepoint/estructura_sharepoint/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Estructura carpeta Sharepoint
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../04.sharepoint/estructura_archivos_actualizacion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Estructura Archivos Actualizacion
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    03. BI COMFENALCO
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            03. BI COMFENALCO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00.params/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduccion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../00-SCRAPING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    00. WEB SCRAPING
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    01. TRANSVERSAL_DIMENSIONES
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    01. TRANSVERSAL_DIMENSIONES
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#proposito-del-paquete" class="md-nav__link">
    <span class="md-ellipsis">
      Propósito del Paquete
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#descripcion-del-paquete" class="md-nav__link">
    <span class="md-ellipsis">
      Descripción del Paquete
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tablas-y-columnas-clave" class="md-nav__link">
    <span class="md-ellipsis">
      Tablas y Columnas Clave
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diagramas" class="md-nav__link">
    <span class="md-ellipsis">
      Diagramas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#componentes-clave-del-paquete" class="md-nav__link">
    <span class="md-ellipsis">
      Componentes Clave del Paquete
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Componentes Clave del Paquete">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#componente-guardar-las-llaves-foraneas" class="md-nav__link">
    <span class="md-ellipsis">
      Componente: Guardar las Llaves Foráneas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-cargar_dim_cuenta_contable" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Cargar_DIM_CUENTA_CONTABLE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-cargar-valores-nulos-por-defecto-para-todos-los-esquemas" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Cargar Valores nulos por defecto para todos los esquemas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-cargar_dim_unidades_organizativas" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Cargar_DIM_UNIDADES_ORGANIZATIVAS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-descargar_am-tra-08" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Descargar_AM-TRA-08
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar_dim_servicios" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar_DIM_SERVICIOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-cargar_dim_sedes" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Cargar_DIM_SEDES
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-descargar_ep-tra-12" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Descargar_EP-TRA-12
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar_dim_capacidad_fisica" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar_DIM_CAPACIDAD_FISICA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-tabla-temporal-dim_estudiantes-educacion-continua-y-tecnica" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Tabla Temporal DIM_ESTUDIANTES Educación Continua y Técnica
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componende-agregar-registros-con-id-1-para-tablas-de-poblacion" class="md-nav__link">
    <span class="md-ellipsis">
      Componende Agregar registros con ID -1 para tablas de población
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-vaciar-tabla-temporal-de-poblacion-educacion" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Vaciar tabla temporal de Poblacion Educacion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-poblacion-prs" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar Poblacion PRS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-identificar-poblacion-educacion" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Identificar Poblacion Educación
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-dim_beneficiarios" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar DIM_BENEFICIARIOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-dim_beneficiarios-por-bp" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar DIM_BENEFICIARIOS por BP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-dim_afiliados" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar DIM_AFILIADOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procesar-dim-afiliados-desde-beneficiarios" class="md-nav__link">
    <span class="md-ellipsis">
      Procesar DIM AFILIADOS desde BENEFICIARIOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-dim_empresas" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar DIM_EMPRESAS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-dim_empresas-desde-afiliados" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar DIM_EMPRESAS desde AFILIADOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar_dim_aportante_no_afiliado" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar_DIM_APORTANTE_NO_AFILIADO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-descargar_ep-tra-05" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Descargar_EP-TRA-05
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar_dim_personal" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar_DIM_PERSONAL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-TRANSVERSAL_FACT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02. TRANSVERSAL_FACT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-COLEGIO_DIMENSIONES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    03. COLEGIO_DIMENSIONES
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-COLEGIO_FACT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    04. COLEGIO_FACT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-CEDESARROLLO_DIMENSIONES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    05. CEDESARROLLO_DIMENSIONES
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-CEDESARROLLO_FACT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    06. CEDESARROLLO_FACT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-PROTECCION_DIMENSIONES/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    07. PROTECCION_DIMENSIONES
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../08-PROTECCION_FACT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    08. PROTECCION_FACT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../09-ETLS_CUBO/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    09. ETLS_CUBO
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    04. COMFENALCO EDUCACION
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            04. COMFENALCO EDUCACION
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    01 SCRIPTS
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1">
            <span class="md-nav__icon md-icon"></span>
            01 SCRIPTS
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_00.Introduccion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introducción
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2" id="__nav_5_1_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    01. Q10
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2">
            <span class="md-nav__icon md-icon"></span>
            01. Q10
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2_1" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_1" id="__nav_5_1_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    0.1. Educación Tecnica
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_1">
            <span class="md-nav__icon md-icon"></span>
            0.1. Educación Tecnica
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/01.Docentes_Cedesarrollo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    0.1. Docentes Cedesarrollo.py
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/02.Disenio_curricular/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    0.2. Diseño Curricular.py
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/03.Listado_matriculas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    0.3. Listado Matrículas.py
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/04.Ingresos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    0.4. Ingresos.py
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/05.Historico_notas_Cedesarrollo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    0.5. Histórico notas.py
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/06.Egresados_graduados_Cedesarrollo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    0.6. Egresados.py
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_01.educaciontecnica/07.Desertores/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    0.7. Desertores.py
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2_2" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_2" id="__nav_5_1_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    0.2. Educación Continua
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_2">
            <span class="md-nav__icon md-icon"></span>
            0.2. Educación Continua
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.educacioncontinua/01.Docentes_desarrollo_empresarial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    0.1. Docentes Desarrollo Empresarial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.educacioncontinua/02.Preinscritos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    0.2. Preinscritos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.educacioncontinua/03.Listado_matriculas_emp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    0.3. Listado Matrículas Empresarial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.educacioncontinua/04.Consolidado_inasistencias/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    0.4. Consolidado Inasistencias
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.educacioncontinua/05.Estudiantes_inasistencias/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    0.5. Estudiantes Inasistencias
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.educacioncontinua/06.Egresados_graduados_empresarial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    0.6. Egresados Graduados Empresarial
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_2_3" >
        
          
          <label class="md-nav__link" for="__nav_5_1_2_3" id="__nav_5_1_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Sharepoint
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_5_1_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_2_3">
            <span class="md-nav__icon md-icon"></span>
            Sharepoint
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_01_procesar_docentes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cede_01 procesar_docentes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_02_procesar_Dise%C3%B1o_Curricular/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cede_02 procesar_Diseño_Curricular
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_03_procesar_listado_matriculas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cede_03 procesar_listado_matriculas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_04_procesar_cede_Ingresos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cede_04 procesar_Ingresos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_05_cede_Historico_Notas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cede_05 cede_Historico_Notas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_06_cede_Egresados_Graduados/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cede_06 cede_Egresados_Graduados
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/cede_07_Cancelados_Desertores/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cede_07 Cancelados Desertores
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/emp_01_Docentes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    emp_01 Docentes Empresarial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/emp_02_listado_matriculas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    emp_02 Listado Matrículas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/emp_03_preinscritos/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    emp_03 Preinscritos Empresarial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/emp_04_egresados_Graduados/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    emp_04 Egresados Graduados
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/emp_05_Estudiantes_inasistencias/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    emp_05 Estudiantes Inasistencias
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_01.q10_02.Sharepoint/emp_06_consolidado_Inasistencias/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    emp_06 Consolidado Inasistencias
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_3" >
        
          
          <label class="md-nav__link" for="__nav_5_1_3" id="__nav_5_1_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    02. C4C
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_3">
            <span class="md-nav__icon md-icon"></span>
            02. C4C
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_02.C4C/01.C4C_webscraping_v4_Actualizable/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3.1. Webscraping Actualizable
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/00.etl_02.C4C/02.C4C_webscraping_v4_Historico/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3.2. Webscraping Histórico
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_1_4" >
        
          
          <label class="md-nav__link" for="__nav_5_1_4" id="__nav_5_1_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_5_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_1_4">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/Funciones/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funciones.py
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/download/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Download.py
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/Funciones_DM/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funciones_DM.py
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/c4c_from_sharepoint/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    c4c_from_sharepoint
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/dim_Estudiantes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dim_Estudiantes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/dim_periodo_academico/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    dim_periodo_academico
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/fact_facturacion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fact_facturacion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/fact_graduados/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fact_graduados
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/fact_cotizacion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fact_cotizacion
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../00.etl/Utils/fact_listado_matriculas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fact_listado_matriculas
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    05. CUBO
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            05. CUBO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03.Cubo/00.Introduccion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introducción
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03.Cubo/01.Origen/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01. ORIGEN Y MEDIDAS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03.Cubo/02.Tablas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    02. TABLAS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../03.Cubo/03.ETL/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    03. ETL
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    06. POWER BI
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            06. POWER BI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05.Power_BI/00.Introduccion/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introducción
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../05.Power_BI/01.Dashboard/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01. DASHBOARD
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#proposito-del-paquete" class="md-nav__link">
    <span class="md-ellipsis">
      Propósito del Paquete
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#descripcion-del-paquete" class="md-nav__link">
    <span class="md-ellipsis">
      Descripción del Paquete
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tablas-y-columnas-clave" class="md-nav__link">
    <span class="md-ellipsis">
      Tablas y Columnas Clave
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diagramas" class="md-nav__link">
    <span class="md-ellipsis">
      Diagramas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#componentes-clave-del-paquete" class="md-nav__link">
    <span class="md-ellipsis">
      Componentes Clave del Paquete
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Componentes Clave del Paquete">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#componente-guardar-las-llaves-foraneas" class="md-nav__link">
    <span class="md-ellipsis">
      Componente: Guardar las Llaves Foráneas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-cargar_dim_cuenta_contable" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Cargar_DIM_CUENTA_CONTABLE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-cargar-valores-nulos-por-defecto-para-todos-los-esquemas" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Cargar Valores nulos por defecto para todos los esquemas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-cargar_dim_unidades_organizativas" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Cargar_DIM_UNIDADES_ORGANIZATIVAS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-descargar_am-tra-08" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Descargar_AM-TRA-08
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar_dim_servicios" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar_DIM_SERVICIOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-cargar_dim_sedes" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Cargar_DIM_SEDES
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-descargar_ep-tra-12" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Descargar_EP-TRA-12
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar_dim_capacidad_fisica" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar_DIM_CAPACIDAD_FISICA
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-tabla-temporal-dim_estudiantes-educacion-continua-y-tecnica" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Tabla Temporal DIM_ESTUDIANTES Educación Continua y Técnica
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componende-agregar-registros-con-id-1-para-tablas-de-poblacion" class="md-nav__link">
    <span class="md-ellipsis">
      Componende Agregar registros con ID -1 para tablas de población
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-vaciar-tabla-temporal-de-poblacion-educacion" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Vaciar tabla temporal de Poblacion Educacion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-poblacion-prs" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar Poblacion PRS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-identificar-poblacion-educacion" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Identificar Poblacion Educación
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-dim_beneficiarios" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar DIM_BENEFICIARIOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-dim_beneficiarios-por-bp" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar DIM_BENEFICIARIOS por BP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-dim_afiliados" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar DIM_AFILIADOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#procesar-dim-afiliados-desde-beneficiarios" class="md-nav__link">
    <span class="md-ellipsis">
      Procesar DIM AFILIADOS desde BENEFICIARIOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-dim_empresas" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar DIM_EMPRESAS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar-dim_empresas-desde-afiliados" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar DIM_EMPRESAS desde AFILIADOS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar_dim_aportante_no_afiliado" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar_DIM_APORTANTE_NO_AFILIADO
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-descargar_ep-tra-05" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Descargar_EP-TRA-05
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#componente-procesar_dim_personal" class="md-nav__link">
    <span class="md-ellipsis">
      Componente Procesar_DIM_PERSONAL
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<!-- markdownlint-disable -->

<h1 id="transversal_dimensiones">TRANSVERSAL_DIMENSIONES<a class="headerlink" href="#transversal_dimensiones" title="Permanent link">&para;</a></h1>
<p>El paquete SSIS <strong>"01-TRANSVERSAL_DIMENSIONES"</strong> está diseñado para gestionar flujos ETL enfocados en la consolidación y estructuración de datos de dimensiones transversales, como cuentas contables, infraestructura, sedes, población educativa, y personal. Este paquete asegura la integración eficiente de información desde múltiples fuentes en el Data Warehouse <code>DWH_COMFENALCO</code>, permitiendo análisis detallados y toma de decisiones estratégicas.</p>
<hr />
<h2 id="proposito-del-paquete">Propósito del Paquete<a class="headerlink" href="#proposito-del-paquete" title="Permanent link">&para;</a></h2>
<p>El objetivo principal del paquete es centralizar, transformar y cargar datos relacionados con dimensiones transversales que impactan diferentes áreas operativas, asegurando su consistencia y calidad para análisis en plataformas de inteligencia de negocios.</p>
<hr />
<h2 id="descripcion-del-paquete">Descripción del Paquete<a class="headerlink" href="#descripcion-del-paquete" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Extracción de Datos</strong>:</p>
<ul>
<li>Fuentes utilizadas:<ul>
<li><strong>Bases de Datos</strong>:<ul>
<li><code>DIM_CUENTA_CONTABLE</code></li>
<li><code>DIM_UNIDADES_ORGANIZATIVAS</code></li>
<li><code>DIM_SEDES</code></li>
</ul>
</li>
<li><strong>Archivos Excel</strong>:<ul>
<li>Información sobre población educativa, infraestructura, y personal.</li>
</ul>
</li>
</ul>
</li>
<li>Herramientas:<ul>
<li><strong>ADO.NET</strong> y <strong>OLE DB</strong> para conexiones eficientes.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Transformación de Datos</strong>:</p>
<ul>
<li><strong>Columnas Derivadas (<code>Derived Column</code>)</strong>:<ul>
<li>Crea claves auxiliares y campos calculados.</li>
</ul>
</li>
<li><strong>Validaciones (<code>Lookup</code>)</strong>:<ul>
<li>Garantiza consistencia mediante búsquedas en tablas maestras.</li>
</ul>
</li>
<li><strong>Clasificación (<code>Conditional Split</code>)</strong>:<ul>
<li>Segmentación de datos según condiciones específicas.</li>
</ul>
</li>
<li><strong>Conversión de Tipos (<code>Data Conversion</code>)</strong>:<ul>
<li>Asegura compatibilidad entre columnas de entrada y destino.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Carga de Datos en el Data Warehouse</strong>:</p>
<ul>
<li>Tablas procesadas:<ul>
<li><code>DIM_CUENTA_CONTABLE</code></li>
<li><code>DIM_PERSONAL</code></li>
<li><code>DIM_INFRAESTRUCTURA_CCF</code></li>
<li><code>DIM_SEDES</code></li>
</ul>
</li>
<li>Inserciones masivas habilitadas para maximizar el rendimiento.</li>
</ul>
</li>
<li>
<p><strong>Automatización y Scripts</strong>:</p>
<ul>
<li>Scripts Python para integrar flujos de trabajo automatizados y procesar datos de SharePoint.</li>
</ul>
</li>
</ol>
<h2 id="tablas-y-columnas-clave">Tablas y Columnas Clave<a class="headerlink" href="#tablas-y-columnas-clave" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>DIM_CUENTA_CONTABLE</strong>:</p>
<ul>
<li><code>ID_CUENTA</code>: Identificador único.</li>
<li><code>CUENTA_NUMERO</code>: Número de cuenta.</li>
<li><code>DESCRIPCION</code>: Descripción de la cuenta.</li>
</ul>
</li>
<li>
<p><strong>DIM_PERSONAL</strong>:</p>
<ul>
<li><code>ID_PERSONAL</code>: Identificador único.</li>
<li><code>NOMBRE</code>: Nombre del personal.</li>
<li><code>DIRECCION</code>: Dirección.</li>
</ul>
</li>
<li>
<p><strong>DIM_INFRAESTRUCTURA_CCF</strong>:</p>
<ul>
<li><code>ID_INFRAESTRUCTURA</code>: Identificador único.</li>
<li><code>DESCRIPCION</code>: Descripción de la infraestructura.</li>
</ul>
</li>
<li>
<p><strong>DIM_SEDES</strong>:</p>
<ul>
<li><code>ID_SEDE</code>: Identificador único.</li>
<li><code>NOMBRE_SEDE</code>: Nombre de la sede.</li>
</ul>
</li>
</ol>
<h2 id="diagramas">Diagramas<a class="headerlink" href="#diagramas" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Diagrama de Flujo de Datos</strong></li>
</ol>
<pre class="mermaid"><code>sequenceDiagram
    participant SSIS as SSIS Package
    participant DB as Base de Datos
    participant Excel as Archivos Excel
    participant Python as Scripts Python
    participant DWH as Data Warehouse

    SSIS -&gt;&gt; DB: Extrae datos de cuentas, personal, y sedes
    SSIS -&gt;&gt; Excel: Procesa datos de infraestructura y población
    SSIS -&gt;&gt; Python: Ejecuta scripts para descargas
    SSIS -&gt;&gt; DWH: Carga datos en tablas destino</code></pre>
<ol>
<li><strong>Diagrama de Transformaciones y Validaciones</strong></li>
</ol>
<pre class="mermaid"><code>graph TD
    A1[Datos de cuentas y sedes] --&gt; T1[Conversión de Datos]
    A2[Datos de infraestructura y población] --&gt; T2[Derived Column: Claves Auxiliares]
    T1 --&gt; L1[Lookup en Tablas Maestras]
    T2 --&gt; C1[Clasificación por Condicional Split]
    L1 --&gt; C2[Cargar datos transformados]</code></pre>
<ol>
<li><strong>Diagrama ER para Tablas de Dimensiones</strong></li>
</ol>
<pre class="mermaid"><code>erDiagram
    DIM_CUENTA_CONTABLE {
        int ID_CUENTA
        string CUENTA_NUMERO
        string DESCRIPCION
    }
    DIM_PERSONAL {
        int ID_PERSONAL
        string NOMBRE
        string DIRECCION
    }
    DIM_INFRAESTRUCTURA_CCF {
        int ID_INFRAESTRUCTURA
        string DESCRIPCION
    }
    DIM_SEDES {
        int ID_SEDE
        string NOMBRE_SEDE
    }
    DIM_CUENTA_CONTABLE ||--|| DIM_PERSONAL : "Asociación por Clave Foránea"
    DIM_INFRAESTRUCTURA_CCF ||--|| DIM_SEDES : "Relación Infraestructura-Sede"</code></pre>
<h2 id="componentes-clave-del-paquete">Componentes Clave del Paquete<a class="headerlink" href="#componentes-clave-del-paquete" title="Permanent link">&para;</a></h2>
<h3 id="componente-guardar-las-llaves-foraneas">Componente: <strong><code>Guardar las Llaves Foráneas</code></strong><a class="headerlink" href="#componente-guardar-las-llaves-foraneas" title="Permanent link">&para;</a></h3>
<p><strong>Propósito</strong>
Esta tarea dentro de la solución SSIS tiene como objetivo:</p>
<ol>
<li>
<p><strong>Crear tablas persistentes</strong> para almacenar definiciones de llaves foráneas en varios esquemas: <code>Transversal</code>, <code>Cedesarrollo</code>, <code>Proteccion</code> y <code>Colegio</code>.</p>
</li>
<li>
<p><strong>Insertar las definiciones de llaves foráneas</strong> en las tablas persistentes a partir de la metadata del sistema (<code>sys.foreign_keys</code> y tablas relacionadas).</p>
</li>
<li>
<p><strong>Eliminar restricciones de llaves foráneas</strong> existentes en los esquemas mencionados, preparándose para un entorno donde no se necesiten dichas restricciones durante procesos específicos (e.g., migración o transformación de datos).</p>
</li>
</ol>
<h4 id="detalles-tecnicos"><strong>Detalles Técnicos</strong><a class="headerlink" href="#detalles-tecnicos" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Tipo de Tarea</strong>: </p>
<ul>
<li><code>Microsoft.ExecuteSQLTask</code> (Tarea Ejecutar SQL).</li>
</ul>
</li>
<li>
<p><strong>Descripción</strong>:</p>
<ul>
<li>La tarea ejecuta comandos SQL que realizan varias operaciones en los esquemas <code>Transversal</code>, <code>Cedesarrollo</code>, <code>Proteccion</code> y <code>Colegio</code>.</li>
</ul>
</li>
<li>
<p><strong>Identificador de la Tarea</strong>:</p>
<ul>
<li><strong>DTSID</strong>: <code>{86fe2b15-f28c-4064-b542-2d2ad2594a04}</code>.</li>
</ul>
</li>
<li>
<p><strong>Nombre de la Tarea</strong>:</p>
<ul>
<li><code>Guardar las llaves foraneas</code>.</li>
</ul>
</li>
<li>
<p><strong>Conexión Utilizada</strong>:</p>
<ul>
<li>Referenciada por el ID: <code>{57F24C4D-9B0A-4EBB-AE46-43F9B341582B}</code>.</li>
</ul>
</li>
</ol>
<hr />
<h4 id="descripcion-del-codigo-sql"><strong>Descripción del Código SQL</strong><a class="headerlink" href="#descripcion-del-codigo-sql" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Creación de Tablas Persistentes</strong>:</p>
<ul>
<li>Para cada esquema (<code>Transversal</code>, <code>Cedesarrollo</code>, <code>Proteccion</code>, <code>Colegio</code>), se verifica la existencia previa de la tabla y se elimina si ya existe:
 <div class="highlight"><pre><span></span><code><span class="k">IF</span><span class="w"> </span><span class="n">OBJECT_ID</span><span class="p">(</span><span class="s1">&#39;dbo.ForeignKeys_&lt;Esquema&gt;&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;U&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span>
<span class="w">    </span><span class="k">DROP</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">ForeignKeys_</span><span class="o">&lt;</span><span class="n">Esquema</span><span class="o">&gt;</span><span class="p">;</span>
</code></pre></div></li>
<li>Posteriormente, se crea una nueva tabla con la estructura necesaria para almacenar las definiciones de las llaves foráneas:
 <div class="highlight"><pre><span></span><code><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">ForeignKeys_</span><span class="o">&lt;</span><span class="n">Esquema</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="n">TableName</span><span class="w"> </span><span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">256</span><span class="p">),</span>
<span class="w">    </span><span class="n">ConstraintName</span><span class="w"> </span><span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">256</span><span class="p">),</span>
<span class="w">    </span><span class="n">ColumnName</span><span class="w"> </span><span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">256</span><span class="p">),</span>
<span class="w">    </span><span class="n">ReferencedTableName</span><span class="w"> </span><span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">256</span><span class="p">),</span>
<span class="w">    </span><span class="n">ReferencedColumnName</span><span class="w"> </span><span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
<span class="p">);</span>
</code></pre></div></li>
</ul>
</li>
<li>
<p><strong>Inserción de Definiciones de Llaves Foráneas</strong>:
    .foreign_key_columns<code>,</code>sys.tables<code>,</code>sys.columns<code>,</code>sys.schemas`) y se insertan en las tablas persistentes:
    <div class="highlight"><pre><span></span><code><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">dbo</span><span class="p">.</span><span class="n">ForeignKeys_</span><span class="o">&lt;</span><span class="n">Esquema</span><span class="o">&gt;</span><span class="w"> </span><span class="p">(</span><span class="n">TableName</span><span class="p">,</span><span class="w"> </span><span class="n">ConstraintName</span><span class="p">,</span><span class="w"> </span><span class="n">ColumnName</span><span class="p">,</span><span class="w"> </span><span class="n">ReferencedTableName</span><span class="p">,</span><span class="w"> </span><span class="n">ReferencedColumnName</span><span class="p">)</span>
<span class="k">SELECT</span><span class="w"> </span>
<span class="w">    </span><span class="n">t</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">TableName</span><span class="p">,</span>
<span class="w">    </span><span class="n">f</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ConstraintName</span><span class="p">,</span>
<span class="w">    </span><span class="k">c</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ColumnName</span><span class="p">,</span>
<span class="w">    </span><span class="n">rt</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ReferencedTableName</span><span class="p">,</span>
<span class="w">    </span><span class="n">rc</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ReferencedColumnName</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">sys</span><span class="p">.</span><span class="n">foreign_keys</span><span class="w"> </span><span class="n">f</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">sys</span><span class="p">.</span><span class="n">foreign_key_columns</span><span class="w"> </span><span class="n">fc</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">object_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fc</span><span class="p">.</span><span class="n">constraint_object_id</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">sys</span><span class="p">.</span><span class="n">tables</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">parent_object_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">object_id</span>
<span class="p">...</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&lt;Esquema&gt;&#39;</span><span class="p">;</span>
</code></pre></div></p>
</li>
<li>
<p><strong>Eliminación de Restricciones de Llaves Foráneas</strong>:
    Se generan dinámicamente comandos SQL para eliminar todas las restricciones de llaves foráneas en las tablas de cada esquema:
        <div class="highlight"><pre><span></span><code><span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="w"> </span><span class="n">NVARCHAR</span><span class="p">(</span><span class="k">MAX</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;ALTER TABLE &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">QUOTENAME</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">QUOTENAME</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; DROP CONSTRAINT &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">QUOTENAME</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;; &#39;</span>
<span class="k">FROM</span><span class="w"> </span><span class="n">sys</span><span class="p">.</span><span class="n">foreign_keys</span><span class="w"> </span><span class="n">f</span>
<span class="p">...</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&lt;Esquema&gt;&#39;</span><span class="p">;</span>
<span class="k">EXEC</span><span class="w"> </span><span class="n">sp_executesql</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="p">;</span>
</code></pre></div></p>
</li>
</ol>
<hr />
<h4 id="esquemas-procesados"><strong>Esquemas Procesados</strong><a class="headerlink" href="#esquemas-procesados" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>Transversal</strong>.</li>
<li><strong>Cedesarrollo</strong>.</li>
<li><strong>Proteccion</strong>.</li>
<li><strong>Colegio</strong>.</li>
</ol>
<hr />
<h4 id="ventajas-de-la-implementacion"><strong>Ventajas de la Implementación</strong><a class="headerlink" href="#ventajas-de-la-implementacion" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>Centralización de definiciones</strong>: Las tablas persistentes almacenan todas las llaves foráneas en un lugar accesible para auditorías o referencias futuras.</li>
<li><strong>Flexibilidad</strong>: Elimina restricciones en los esquemas, permitiendo procesos más ágiles como migraciones de datos.</li>
<li><strong>Reutilización</strong>: La lógica puede ser ajustada para nuevos esquemas simplemente actualizando el código SQL y parámetros en el SSIS.</li>
</ol>
<hr />
<h4 id="diagrama-de-flujo-de-proceso-de-datos"><strong>Diagrama de flujo de proceso de datos</strong><a class="headerlink" href="#diagrama-de-flujo-de-proceso-de-datos" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant SQL_TASK
    participant TRANSVERSAL_SCHEMA
    participant CEDESARROLLO_SCHEMA
    participant PROTECCION_SCHEMA
    participant COLEGIO_SCHEMA

    SQL_TASK-&gt;&gt;TRANSVERSAL_SCHEMA: Crear tablas y definir llaves foráneas
    SQL_TASK-&gt;&gt;CEDESARROLLO_SCHEMA: Crear tablas y definir llaves foráneas
    SQL_TASK-&gt;&gt;PROTECCION_SCHEMA: Crear tablas y definir llaves foráneas
    SQL_TASK-&gt;&gt;COLEGIO_SCHEMA: Crear tablas y definir llaves foráneas</code></pre>
<h3 id="componente-cargar_dim_cuenta_contable">Componente <strong><code>Cargar_DIM_CUENTA_CONTABLE</code></strong><a class="headerlink" href="#componente-cargar_dim_cuenta_contable" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general">Descripción General<a class="headerlink" href="#descripcion-general" title="Permanent link">&para;</a></h4>
<p>El componente <code>Cargar_DIM_CUENTA_CONTABLE</code> es una tarea de flujo de datos en un paquete SSIS que se encarga de cargar datos en la dimensión <code>DIM_CUENTA_CONTABLE</code>. Este componente realiza operaciones de extracción, transformación y carga (ETL) de alto rendimiento.</p>
<h4 id="componentes-y-funcionalidades">Componentes y Funcionalidades<a class="headerlink" href="#componentes-y-funcionalidades" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Variables y Opciones de Registro</strong></p>
<ul>
<li>No se definen variables específicas.</li>
<li>Opciones de registro configuradas con <code>DTS:FilterKind="0"</code>.</li>
</ul>
</li>
<li>
<p><strong>Pipeline</strong></p>
<ul>
<li><strong>Versión:</strong> 1</li>
</ul>
</li>
<li>
<p><strong>Componentes del Pipeline</strong></p>
<ul>
<li>
<p><strong>Conditional Split</strong></p>
<ul>
<li><strong>Descripción:</strong> Divide las filas de datos en diferentes salidas según el contenido de los datos utilizando expresiones SSIS.</li>
<li><strong>Entradas:</strong> <ul>
<li>Columnas de entrada incluyen <code>CUENTA_NUMERO</code>, <code>CUENTA</code>, <code>CUENTA_HOMOLOGA</code>, <code>DESCRIPCION</code>, <code>TIPO_CUENTA</code>, <code>TIPO_OPERACION</code>, <code>GRUPO_CUENTA</code>, <code>SUBGRUPO_CUENTA</code>, <code>GRUPO_OPERACION</code>, <code>FEC_PROCESO</code>, <code>UDATE</code>, <code>CUENTA_SSF</code>, <code>DESCRIPCION_SSF</code>, <code>NUMERO_PROCESO_SQL</code>, <code>CLASIFICACION</code>, <code>USUARIO_PROCESO</code>, <code>ESTADO_REGISTRO</code>, <code>ID_CUENTA</code>.</li>
</ul>
</li>
<li><strong>Salidas:</strong><ul>
<li><code>Agregar</code>: Filtra filas donde <code>ID_CUENTA</code> es nulo.</li>
<li><code>Modificar</code>: Filtra filas donde hay diferencias entre las columnas de origen y las columnas de búsqueda.</li>
<li><code>Sin Cambios</code>: Salida por defecto para filas sin cambios.</li>
<li><code>Conditional Split Error Output</code>: Salida de error.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Destino de ADO NET</strong></p>
<ul>
<li><strong>Descripción:</strong> Carga datos en una base de datos compatible con ADO.NET.</li>
<li><strong>Propiedades:</strong><ul>
<li><code>TableOrViewName</code>: <code>"Transversal"."DIM_CUENTA_CONTABLE"</code></li>
<li><code>BatchSize</code>: 0</li>
<li><code>CommandTimeout</code>: 30</li>
<li><code>UseBulkInsertWhenPossible</code>: true</li>
</ul>
</li>
<li><strong>Conexión:</strong> <code>DWH_COMFENALCO_Destino</code></li>
<li><strong>Entradas:</strong> Columnas de entrada incluyen <code>ID_CUENTA</code>, <code>CUENTA_NUMERO</code>, <code>CUENTA</code>, <code>CUENTA_HOMOLOGA</code>, <code>DESCRIPCION</code>, <code>TIPO_CUENTA</code>, <code>TIPO_OPERACION</code>, <code>GRUPO_CUENTA</code>, <code>SUBGRUPO_CUENTA</code>, <code>GRUPO_OPERACION</code>, <code>FEC_PROCESO</code>, <code>UDATE</code>, <code>CUENTA_SSF</code>, <code>DESCRIPCION_SSF</code>, <code>NUMERO_PROCESO_SQL</code>, <code>CLASIFICACION</code>, <code>USUARIO_PROCESO</code>, <code>ESTADO_REGISTRO</code>.</li>
<li><strong>Salidas:</strong><ul>
<li><code>Salida de error de destino de ADO NET</code>: Salida de error.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>DIM_CUENTA_CONTABLE_ORIG</strong></p>
<ul>
<li><strong>Descripción:</strong> Consume datos de SQL Server utilizando una instrucción Transact-SQL.</li>
<li><strong>Propiedades:</strong><ul>
<li><code>SqlCommand</code>: <code>SELECT [ID_CUENTA], [CUENTA_NUMERO], [CUENTA], [CUENTA_HOMOLOGA], [DESCRIPCION], [TIPO_CUENTA], [TIPO_OPERACION], [GRUPO_CUENTA], [SUBGRUPO_CUENTA], [GRUPO_OPERACION], [FEC_PROCESO], [UDATE], [CUENTA_SSF], [DESCRIPCION_SSF], [NUMERO_PROCESO_SQL], [CLASIFICACION], [USUARIO_PROCESO], [ESTADO_REGISTRO] FROM [DWH_COMFENALCO].[Financiera].[DIM_CUENTA_CONTABLE]</code></li>
<li><code>CommandTimeout</code>: 30</li>
<li><code>AllowImplicitStringConversion</code>: true</li>
<li><code>TableOrViewName</code>: <code>"Financiera"."DIM_CUENTA_CONTABLE"</code></li>
<li><code>AccessMode</code>: 2</li>
</ul>
</li>
<li><strong>Conexión:</strong> <code>DWH_COMFENALCO</code></li>
<li><strong>Salidas:</strong><ul>
<li><code>Salida de origen de ADO NET</code>: Salida principal.</li>
<li><code>Salida de error de origen de ADO NET</code>: Salida de error.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Lookup</strong></p>
<ul>
<li><strong>Descripción:</strong> Realiza una búsqueda de valores en una tabla para unir columnas adicionales al flujo de datos.</li>
<li><strong>Propiedades:</strong><ul>
<li><code>SqlCommand</code>: <code>SELECT [ID_CUENTA], [CUENTA_NUMERO], [CUENTA], [CUENTA_HOMOLOGA], [DESCRIPCION], [TIPO_CUENTA], [TIPO_OPERACION], [GRUPO_CUENTA], [SUBGRUPO_CUENTA], [GRUPO_OPERACION], [FEC_PROCESO], [UDATE], [CUENTA_SSF], [DESCRIPCION_SSF], [NUMERO_PROCESO_SQL], [CLASIFICACION], [USUARIO_PROCESO], [ESTADO_REGISTRO] FROM [Transversal].[DIM_CUENTA_CONTABLE]</code></li>
<li><code>SqlCommandParam</code>: <code>select * from (SELECT [ID_CUENTA], [CUENTA_NUMERO], [CUENTA], [CUENTA_HOMOLOGA], [DESCRIPCION], [TIPO_CUENTA], [TIPO_OPERACION], [GRUPO_CUENTA], [SUBGRUPO_CUENTA], [GRUPO_OPERACION], [FEC_PROCESO], [UDATE], [CUENTA_SSF], [DESCRIPCION_SSF], [NUMERO_PROCESO_SQL], [CLASIFICACION], [USUARIO_PROCESO], [ESTADO_REGISTRO] FROM [Transversal].[DIM_CUENTA_CONTABLE]) [refTable] where [refTable].[ID_CUENTA] = ?</code></li>
<li><code>ConnectionType</code>: 0</li>
<li><code>CacheType</code>: 0</li>
<li><code>NoMatchBehavior</code>: 0</li>
<li><code>NoMatchCachePercentage</code>: 0</li>
<li><code>MaxMemoryUsage</code>: 25</li>
<li><code>MaxMemoryUsage64</code>: 25</li>
<li><code>ReferenceMetadataXml</code>: <code>&lt;referenceMetadata&gt;...&lt;/referenceMetadata&gt;</code></li>
<li><code>ParameterMap</code>: <code>#{Package\Cargar_DIM_CUENTA_CONTABLE\DIM_CUENTA_CONTABLE_ORIG.Outputs[Salida de origen de ADO NET].Columns[ID_CUENTA]};</code></li>
<li><code>DefaultCodePage</code>: 1252</li>
<li><code>TreatDuplicateKeysAsError</code>: false</li>
</ul>
</li>
<li><strong>Conexión:</strong> <code>DWH_COMFENALCO_Destino_OLEDB</code></li>
<li><strong>Entradas:</strong> <code>ID_CUENTA</code></li>
<li><strong>Salidas:</strong><ul>
<li><code>Lookup Match Output</code>: Salida para filas con coincidencias.</li>
<li><code>Lookup No Match Output</code>: Salida para filas sin coincidencias.</li>
<li><code>Lookup Error Output</code>: Salida de error.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>OLE DB Command</strong></p>
<ul>
<li><strong>Descripción:</strong> Ejecuta una instrucción SQL para cada fila en un flujo de datos.</li>
<li><strong>Propiedades:</strong><ul>
<li><code>CommandTimeout</code>: 0</li>
<li><code>SqlCommand</code>: <code>UPDATE [Transversal].[DIM_CUENTA_CONTABLE] SET [CUENTA_NUMERO] = ?, [CUENTA] = ?, [CUENTA_HOMOLOGA] = ?, [DESCRIPCION] = ?, [TIPO_CUENTA] = ?, [TIPO_OPERACION] = ?, [GRUPO_CUENTA] = ?, [SUBGRUPO_CUENTA] = ?, [GRUPO_OPERACION] = ?, [FEC_PROCESO] = ?, [UDATE] = ?, [CUENTA_SSF] = ?, [DESCRIPCION_SSF] = ?, [NUMERO_PROCESO_SQL] = ?, [CLASIFICACION] = ?, [USUARIO_PROCESO] = ?, [ESTADO_REGISTRO] = ? WHERE [ID_CUENTA] = ?</code></li>
<li><code>DefaultCodePage</code>: 1252</li>
</ul>
</li>
<li><strong>Conexión:</strong> <code>DWH_COMFENALCO_Destino_OLEDB</code></li>
<li><strong>Entradas:</strong> Columnas de entrada incluyen <code>CUENTA_NUMERO</code>, <code>CUENTA</code>, <code>CUENTA_HOMOLOGA</code>,      <code>DESCRIPCION</code>, <code>TIPO_CUENTA</code>, <code>TIPO_OPERACION</code>, <code>GRUPO_CUENTA</code>, <code>SUBGRUPO_CUENTA</code>, <code>GRUPO_OPERACION</code>, <code>FEC_PROCESO</code>, <code>UDATE</code>, <code>CUENTA_SSF</code>, <code>DESCRIPCION_SSF</code>, <code>NUMERO_PROCESO_SQL</code>, <code>CLASIFICACION</code>, <code>USUARIO_PROCESO</code>, <code>ESTADO_REGISTRO</code>, <code>ID_CUENTA</code>.</li>
<li><strong>Salidas:</strong><ul>
<li><code>OLE DB Command Output</code>: Salida principal.</li>
<li><code>OLE DB Command Error Output</code>: Salida de error.</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Rutas del Pipeline</strong></p>
<ul>
<li><code>Agregar</code>: Desde <code>Conditional Split.Outputs[Agregar]</code> hasta <code>Destino de ADO NET.Inputs[Entrada de destino de ADO NET]</code>.</li>
<li><code>Lookup Match Output</code>: Desde <code>Lookup.Outputs[Lookup Match Output]</code> hasta <code>Conditional Split.Inputs[Conditional Split Input]</code>.</li>
<li><code>Modificar</code>: Desde <code>Conditional Split.Outputs[Modificar]</code> hasta <code>OLE DB Command.Inputs[OLE DB Command Input]</code>.</li>
<li><code>Salida de origen de ADO NET</code>: Desde <code>DIM_CUENTA_CONTABLE_ORIG.Outputs[Salida de origen de ADO NET]</code> hasta <code>Lookup.Inputs[Lookup Input]</code>.</li>
</ul>
</li>
</ol>
<h4 id="diagrama-de-flujo-de-proceso-de-datos_1"><strong>Diagrama de flujo de proceso de datos</strong><a class="headerlink" href="#diagrama-de-flujo-de-proceso-de-datos_1" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant DIM_CUENTA_CONTABLE_ORIG
    participant Lookup
    participant Conditional_Split
    participant Destino_de_ADO_NET
    participant OLE_DB_Command

    DIM_CUENTA_CONTABLE_ORIG-&gt;&gt;Lookup: Salida de origen de ADO NET
    Lookup-&gt;&gt;Conditional_Split: Lookup Match Output
    Conditional_Split-&gt;&gt;Destino_de_ADO_NET: Agregar
    Conditional_Split-&gt;&gt;OLE_DB_Command: Modificar</code></pre>
<p>&lt;!-- ### Componente <strong><code>Cargar_DIM_UNIDAD, DIM_INFRAESTRUCTURA_CCF y DIM_CATEGORIAS</code></strong></p>
<h4 id="descripcion-general_1">Descripción General<a class="headerlink" href="#descripcion-general_1" title="Permanent link">&para;</a></h4>
<p>La tarea <code>Cargar_DIM_UNIDAD, DIM_INFRAESTRUCTURA_CCF y DIM_CATEGORIAS</code> es una tarea de ejecución de SQL en un paquete SSIS que se encarga de cargar datos en las dimensiones <code>DIM_UNIDAD</code>, <code>DIM_INFRAESTRUCTURA_CCF</code> y <code>DIM_CATEGORIAS</code>. Esta tarea realiza operaciones de eliminación, truncado e inserción de datos en las tablas correspondientes del Data Warehouse.</p>
<h4 id="detalles-de-la-tarea">Detalles de la Tarea<a class="headerlink" href="#detalles-de-la-tarea" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>ID de la Tarea</strong>: <code>{117A40D1-E1F3-4DF6-9457-B49F2D971A3B}</code></li>
<li><strong>Tipo de Tarea</strong>: <code>Microsoft.ExecuteSQLTask</code></li>
<li><strong>Descripción</strong>: Tarea Ejecutar SQL</li>
<li><strong>Conexión</strong>: <code>{57F24C4D-9B0A-4EBB-AE46-43F9B341582B}</code></li>
<li><strong>Declaraciones SQL</strong>:<ul>
<li>Eliminar restricciones de clave foránea en el esquema <code>Transversal</code>.</li>
<li>Truncar las tablas <code>DIM_UNIDAD</code>, <code>DIM_INFRAESTRUCTURA_CCF</code> y <code>DIM_CATEGORIAS</code>.</li>
<li>Insertar registros en las tablas <code>DIM_UNIDAD</code>, <code>DIM_INFRAESTRUCTURA_CCF</code> y <code>DIM_CATEGORIAS</code>.</li>
<li>Insertar un registro para el personal sin datos en la tabla <code>DIM_PERSONAL</code>.</li>
</ul>
</li>
</ul>
<h4 id="diagrama-de-secuencia-del-proceso-etl">Diagrama de Secuencia del Proceso ETL<a class="headerlink" href="#diagrama-de-secuencia-del-proceso-etl" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
  title Diagrama de Secuencia del Proceso ETL de Cargar_DIM_UNIDAD, DIM_INFRAESTRUCTURA_CCF y DIM_CATEGORIAS
  autonumber
  participant SSIS as Tarea SSIS
  participant SQL as Script SQL
  participant DWH as Data Warehouse

  SSIS-&gt;&gt;SQL: Ejecutar eliminación de restricciones de clave foránea
  SQL--&gt;&gt;SSIS: Confirmación de eliminación
  SSIS-&gt;&gt;SQL: Ejecutar truncado de tablas
  SQL--&gt;&gt;SSIS: Confirmación de truncado
  SSIS-&gt;&gt;SQL: Ejecutar inserción de registros en DIM_UNIDAD
  SQL--&gt;&gt;SSIS: Confirmación de inserción en DIM_UNIDAD
  SSIS-&gt;&gt;SQL: Ejecutar inserción de registros en DIM_INFRAESTRUCTURA_CCF
  SQL--&gt;&gt;SSIS: Confirmación de inserción en DIM_INFRAESTRUCTURA_CCF
  SSIS-&gt;&gt;SQL: Ejecutar inserción de registros en DIM_CATEGORIAS
  SQL--&gt;&gt;SSIS: Confirmación de inserción en DIM_CATEGORIAS
  SSIS-&gt;&gt;SQL: Ejecutar inserción de registro en DIM_PERSONAL
  SQL--&gt;&gt;SSIS: Confirmación de inserción en DIM_PERSONAL</code></pre>
<h4 id="codigo">Código<a class="headerlink" href="#codigo" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="n">USE</span><span class="w"> </span><span class="n">DWH_COMFENALCO</span><span class="p">;</span>
<span class="k">GO</span>
<span class="k">SET</span><span class="w"> </span><span class="n">ANSI_NULLS</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span><span class="w"> </span><span class="c1">-- Configura el manejo estándar de valores nulos.</span>
<span class="k">GO</span>
<span class="k">SET</span><span class="w"> </span><span class="n">QUOTED_IDENTIFIER</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span><span class="w"> </span><span class="c1">-- Permite usar comillas dobles para nombres de objetos.</span>
<span class="k">GO</span>

<span class="c1">-- Eliminar restricciones de clave foránea del esquema &#39;Transversal&#39;.</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="w"> </span><span class="n">NVARCHAR</span><span class="p">(</span><span class="k">MAX</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;ALTER TABLE &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">QUOTENAME</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">QUOTENAME</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; DROP CONSTRAINT &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">QUOTENAME</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;; &#39;</span><span class="w"> </span>
<span class="k">FROM</span><span class="w"> </span><span class="n">sys</span><span class="p">.</span><span class="n">foreign_keys</span><span class="w"> </span><span class="n">f</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">sys</span><span class="p">.</span><span class="n">tables</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">parent_object_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">object_id</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">sys</span><span class="p">.</span><span class="n">schemas</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">schema_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">schema_id</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Transversal&#39;</span><span class="p">;</span>
<span class="k">EXEC</span><span class="w"> </span><span class="n">sp_executesql</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="p">;</span>

<span class="c1">-- Limpiar las tablas mediante truncado para eliminar datos existentes.</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_UNIDAD</span><span class="p">];</span><span class="w"> </span><span class="c1">-- Tabla de unidades.</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_INFRAESTRUCTURA_CCF</span><span class="p">];</span><span class="w"> </span><span class="c1">-- Infraestructura CCF.</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_CATEGORIA</span><span class="p">];</span><span class="w"> </span><span class="c1">-- Categorías.</span>

<span class="c1">-- Insertar registros iniciales en la tabla DIM_UNIDAD.</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_UNIDAD</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">UNIDAD</span><span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;EDUCACIÓN FORMAL&#39;</span><span class="p">),</span><span class="w"> </span><span class="c1">-- Representa Educación Formal.</span>
<span class="w">       </span><span class="p">(</span><span class="s1">&#39;EDUCACIÓN TÉCNICA&#39;</span><span class="p">),</span><span class="w"> </span><span class="c1">-- Representa Educación Técnica.</span>
<span class="w">       </span><span class="p">(</span><span class="s1">&#39;EDUCACIÓN CONTINUA&#39;</span><span class="p">),</span><span class="w"> </span><span class="c1">-- Representa Educación Continua.</span>
<span class="w">       </span><span class="p">(</span><span class="s1">&#39;PROTECCIÓN SOCIAL&#39;</span><span class="p">),</span><span class="w"> </span><span class="c1">-- Representa Protección Social.</span>
<span class="w">       </span><span class="p">(</span><span class="s1">&#39;SIN UNIDAD&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">-- Valor predeterminado para datos sin unidad.</span>

<span class="c1">-- Insertar registros en DIM_INFRAESTRUCTURA_CCF con valores asociados a unidades específicas.</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_INFRAESTRUCTURA_CCF</span><span class="p">]</span><span class="w"> </span><span class="p">([</span><span class="n">COD_INFRAESTRUCTURA_CCF</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">DESCRIPCION</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">ID_UNIDAD</span><span class="p">])</span><span class="w"> </span><span class="k">VALUES</span>
<span class="p">(</span><span class="s1">&#39;CCF008-12-00001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Educación formal&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="c1">-- Educación formal asociada a ID 1.</span>
<span class="p">(</span><span class="s1">&#39;CCF008-13-00001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Educación para el trabajo&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="c1">-- Educación técnica asociada a ID 2.</span>
<span class="p">(</span><span class="s1">&#39;CCF008-15-00001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Desarrollo empresarial&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="c1">-- Desarrollo empresarial asociado a ID 3.</span>
<span class="p">(</span><span class="s1">&#39;CCF008-26-00001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Protección social&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span><span class="w"> </span><span class="c1">-- Protección social asociada a ID 4.</span>

<span class="c1">-- Insertar registros en DIM_CATEGORIA con las categorías disponibles.</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_CATEGORIA</span><span class="p">]</span><span class="w"> </span><span class="p">([</span><span class="n">COD_CATEGORIA</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">DESCRIPCION</span><span class="p">])</span><span class="w"> </span><span class="k">VALUES</span>
<span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Categoría A&#39;</span><span class="p">),</span><span class="w"> </span><span class="c1">-- Categoría A.</span>
<span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Categoría B&#39;</span><span class="p">),</span><span class="w"> </span><span class="c1">-- Categoría B.</span>
<span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Categoría C&#39;</span><span class="p">),</span><span class="w"> </span><span class="c1">-- Categoría C.</span>
<span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Categoría D&#39;</span><span class="p">),</span><span class="w"> </span><span class="c1">-- Categoría D.</span>
<span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Empresas&#39;</span><span class="p">),</span><span class="w"> </span><span class="c1">-- Categoría para empresas.</span>
<span class="p">(</span><span class="s1">&#39;6&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Fondos de Ley&#39;</span><span class="p">),</span><span class="w"> </span><span class="c1">-- Fondos de ley.</span>
<span class="p">(</span><span class="s1">&#39;10&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Convenios y Facultativos&#39;</span><span class="p">),</span><span class="w"> </span><span class="c1">-- Convenios.</span>
<span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Empresa no afiliada&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">-- Empresas no afiliadas.</span>

<span class="c1">-- Insertar un registro en la tabla DIM_PERSONAL para representar datos genéricos o no disponibles.</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_PERSONAL</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span><span class="w"> </span><span class="c1">-- Permite insertar valores en la columna IDENTITY.</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_PERSONAL</span><span class="p">]</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">[</span><span class="n">ID_PERSONAL</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">COD_PERSONA_UNIDAD</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">ID_UNIDAD</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">SERVICIO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">NOMBRE</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">TELEFONO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">CELULAR</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">CORREO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">DIRECCION</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">CIUDAD</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">TIPO_DOCUMENTO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">DOCUMENTO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">FECHA_NACIMIENTO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">GENERO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">HORAS_CONTRATADAS_MENSUAL</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">HORAS_CONTRATADAS_TOTALES</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">VALOR_TOTAL</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">TIPO_CONTRATACION</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">FECHA_INICIO_CONTRATACION</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">FECHA_FIN_CONTRATACION</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">CAUSA_TERMINACION_CONTRATO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">PREGRADO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">POSGRADO_ESPECIALIDAD</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">POSGRADO_MAESTRIA</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">POSGRADO_DOCTORADO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">NIVEL_INGLES</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">AREA</span><span class="p">]</span>
<span class="p">)</span><span class="w"> </span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="c1">-- ID predeterminado para datos genéricos.</span>
<span class="w">    </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="c1">-- Código genérico.</span>
<span class="w">    </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="c1">-- Unidad asociada a &quot;SIN UNIDAD&quot;.</span>
<span class="w">    </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="c1">-- Datos personales no disponibles.</span>
<span class="w">    </span><span class="s1">&#39;CC&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-1&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="c1">-- Documento y tipo predeterminado.</span>
<span class="w">    </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1900-01-01&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1900-01-01&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span>
<span class="p">);</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_PERSONAL</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span><span class="w"> </span><span class="c1">-- Finaliza la inserción de IDENTITY.</span>
<span class="k">GO</span>
<span class="o">```</span><span class="w"> </span><span class="c1">--&gt;</span>

<span class="o">###</span><span class="w"> </span><span class="n">Componente</span><span class="w"> </span><span class="o">**`</span><span class="n">Limpiar_DIM_UNIDADES_ORGANIZATIVAS</span><span class="o">`**</span>

<span class="o">####</span><span class="w"> </span><span class="n">Descripción</span><span class="w"> </span><span class="k">General</span>

<span class="n">La</span><span class="w"> </span><span class="n">tarea</span><span class="w"> </span><span class="o">`</span><span class="n">Limpiar_DIM_UNIDADES_ORGANIZATIVAS</span><span class="o">`</span><span class="w"> </span><span class="n">es</span><span class="w"> </span><span class="n">una</span><span class="w"> </span><span class="n">tarea</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">ejecución</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="k">SQL</span><span class="w"> </span><span class="n">en</span><span class="w"> </span><span class="n">un</span><span class="w"> </span><span class="n">paquete</span><span class="w"> </span><span class="n">SSIS</span><span class="w"> </span><span class="n">que</span><span class="w"> </span><span class="n">se</span><span class="w"> </span><span class="n">encarga</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">limpiar</span><span class="w"> </span><span class="n">la</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="o">`</span><span class="n">DIM_UNIDADES_ORGANIZATIVAS</span><span class="o">`</span><span class="w"> </span><span class="n">en</span><span class="w"> </span><span class="n">el</span><span class="w"> </span><span class="k">Data</span><span class="w"> </span><span class="n">Warehouse</span><span class="p">.</span><span class="w"> </span><span class="n">Esta</span><span class="w"> </span><span class="n">tarea</span><span class="w"> </span><span class="n">realiza</span><span class="w"> </span><span class="n">operaciones</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">eliminación</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">restricciones</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">clave</span><span class="w"> </span><span class="n">foránea</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">truncado</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">la</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="n">correspondiente</span><span class="p">.</span>

<span class="o">####</span><span class="w"> </span><span class="n">Detalles</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">la</span><span class="w"> </span><span class="n">Tarea</span>

<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">ID</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">la</span><span class="w"> </span><span class="n">Tarea</span><span class="o">**</span><span class="p">:</span><span class="w"> </span><span class="o">`</span><span class="err">{</span><span class="mi">047</span><span class="n">c1578</span><span class="o">-</span><span class="n">c938</span><span class="o">-</span><span class="mi">442</span><span class="n">e</span><span class="o">-</span><span class="mi">8</span><span class="n">b96</span><span class="o">-</span><span class="mi">1</span><span class="n">f6a3417d0a2</span><span class="err">}</span><span class="o">`</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">Tipo</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">Tarea</span><span class="o">**</span><span class="p">:</span><span class="w"> </span><span class="o">`</span><span class="n">Microsoft</span><span class="p">.</span><span class="n">ExecuteSQLTask</span><span class="o">`</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">Descripción</span><span class="o">**</span><span class="p">:</span><span class="w"> </span><span class="n">Tarea</span><span class="w"> </span><span class="n">Ejecutar</span><span class="w"> </span><span class="k">SQL</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">Conexión</span><span class="o">**</span><span class="p">:</span><span class="w"> </span><span class="o">`</span><span class="err">{</span><span class="mi">57</span><span class="n">F24C4D</span><span class="o">-</span><span class="mi">9</span><span class="n">B0A</span><span class="o">-</span><span class="mi">4</span><span class="n">EBB</span><span class="o">-</span><span class="n">AE46</span><span class="o">-</span><span class="mi">43</span><span class="n">F9B341582B</span><span class="err">}</span><span class="o">`</span>
<span class="o">-</span><span class="w"> </span><span class="o">**</span><span class="n">Declaraciones</span><span class="w"> </span><span class="k">SQL</span><span class="o">**</span><span class="p">:</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Eliminar</span><span class="w"> </span><span class="n">restricciones</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">clave</span><span class="w"> </span><span class="n">foránea</span><span class="w"> </span><span class="n">en</span><span class="w"> </span><span class="n">el</span><span class="w"> </span><span class="n">esquema</span><span class="w"> </span><span class="o">`</span><span class="n">Transversal</span><span class="o">`</span><span class="p">.</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="n">Truncar</span><span class="w"> </span><span class="n">la</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="o">`</span><span class="n">DIM_UNIDADES_ORGANIZATIVAS</span><span class="o">`</span><span class="p">.</span>

<span class="o">####</span><span class="w"> </span><span class="n">Diagrama</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">Secuencia</span><span class="w"> </span><span class="n">del</span><span class="w"> </span><span class="n">Proceso</span><span class="w"> </span><span class="n">ETL</span>

<span class="o">```</span><span class="n">mermaid</span>
<span class="n">sequenceDiagram</span>
<span class="w">  </span><span class="n">title</span><span class="w"> </span><span class="n">Diagrama</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">Secuencia</span><span class="w"> </span><span class="n">del</span><span class="w"> </span><span class="n">Proceso</span><span class="w"> </span><span class="n">ETL</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">Limpiar_DIM_UNIDADES_ORGANIZATIVAS</span>
<span class="w">  </span><span class="n">autonumber</span>
<span class="w">  </span><span class="n">participant</span><span class="w"> </span><span class="n">SSIS</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">Tarea</span><span class="w"> </span><span class="n">SSIS</span>
<span class="w">  </span><span class="n">participant</span><span class="w"> </span><span class="k">SQL</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">Script</span><span class="w"> </span><span class="k">SQL</span>
<span class="w">  </span><span class="n">participant</span><span class="w"> </span><span class="n">DWH</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">Data</span><span class="w"> </span><span class="n">Warehouse</span>

<span class="w">  </span><span class="n">SSIS</span><span class="o">-&gt;&gt;</span><span class="k">SQL</span><span class="p">:</span><span class="w"> </span><span class="n">Ejecutar</span><span class="w"> </span><span class="n">eliminación</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">restricciones</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">clave</span><span class="w"> </span><span class="n">foránea</span>
<span class="w">  </span><span class="k">SQL</span><span class="c1">--&gt;&gt;SSIS: Confirmación de eliminación</span>
<span class="w">  </span><span class="n">SSIS</span><span class="o">-&gt;&gt;</span><span class="k">SQL</span><span class="p">:</span><span class="w"> </span><span class="n">Ejecutar</span><span class="w"> </span><span class="n">truncado</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">tabla</span><span class="w"> </span><span class="n">DIM_UNIDADES_ORGANIZATIVAS</span>
<span class="w">  </span><span class="k">SQL</span><span class="c1">--&gt;&gt;SSIS: Confirmación de truncado</span>
</code></pre></div>
<h4 id="codigo-sql">Código SQL<a class="headerlink" href="#codigo-sql" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="n">USE</span><span class="w"> </span><span class="n">DWH_COMFENALCO</span><span class="p">;</span>
<span class="k">GO</span>
<span class="k">SET</span><span class="w"> </span><span class="n">ANSI_NULLS</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span>
<span class="k">GO</span>
<span class="k">SET</span><span class="w"> </span><span class="n">QUOTED_IDENTIFIER</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span>
<span class="k">GO</span>

<span class="c1">-- Eliminar restricciones de clave foránea</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="w"> </span><span class="n">NVARCHAR</span><span class="p">(</span><span class="k">MAX</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;ALTER TABLE &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">QUOTENAME</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">QUOTENAME</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; DROP CONSTRAINT &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">QUOTENAME</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;; &#39;</span><span class="w"> </span>
<span class="k">FROM</span><span class="w"> </span><span class="n">sys</span><span class="p">.</span><span class="n">foreign_keys</span><span class="w"> </span><span class="n">f</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">sys</span><span class="p">.</span><span class="n">tables</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">parent_object_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">object_id</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">sys</span><span class="p">.</span><span class="n">schemas</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">schema_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">schema_id</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Transversal&#39;</span><span class="p">;</span>
<span class="k">EXEC</span><span class="w"> </span><span class="n">sp_executesql</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="p">;</span>

<span class="c1">-- Truncar tabla DIM_UNIDADES_ORGANIZATIVAS</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_UNIDADES_ORGANIZATIVAS</span><span class="p">];</span>
</code></pre></div>
<h3 id="componente-cargar-valores-nulos-por-defecto-para-todos-los-esquemas">Componente <strong><code>Cargar Valores nulos por defecto para todos los esquemas</code></strong><a class="headerlink" href="#componente-cargar-valores-nulos-por-defecto-para-todos-los-esquemas" title="Permanent link">&para;</a></h3>
<p>El paquete SSIS <strong>"Cargar Valores nulos por defecto para todos los esquemas"</strong> se encarga de inicializar y estandarizar los datos en múltiples esquemas del Data Warehouse <code>DWH_COMFENALCO</code> mediante la ejecución de un proceso SQL. Este componente se encarga de eliminar restricciones, truncar tablas y cargar registros predeterminados (con valores nulos o -1) en diversas tablas de las áreas Transversal, Cedesarrollo, Protección y Colegio. La implementación de esta tarea garantiza que, en ausencia de datos válidos, se disponga de registros por defecto que faciliten las consultas y análisis posteriores en plataformas de inteligencia de negocios.</p>
<hr />
<h4 id="proposito-del-paquete_1">Propósito del Paquete<a class="headerlink" href="#proposito-del-paquete_1" title="Permanent link">&para;</a></h4>
<p>El objetivo principal del componente es:</p>
<ol>
<li><strong>Eliminar restricciones de clave foránea</strong> en el esquema <code>Transversal</code> para permitir la carga de datos sin conflictos.</li>
<li><strong>Truncar tablas</strong> en las áreas correspondientes para limpiar datos obsoletos o inconsistentes.</li>
<li><strong>Insertar registros por defecto</strong> en las dimensiones clave, utilizando valores nulos o identificadores especiales (como -1) para representar datos no disponibles o genéricos.</li>
<li><strong>Estandarizar la carga de información</strong> en las áreas Transversal, Cedesarrollo, Protección y Colegio, asegurando la integridad y consistencia de los datos en el Data Warehouse.</li>
</ol>
<hr />
<h4 id="descripcion-del-paquete_1">Descripción del Paquete<a class="headerlink" href="#descripcion-del-paquete_1" title="Permanent link">&para;</a></h4>
<p>La tarea se realiza a través de una <strong>Tarea Ejecutar SQL (Execute SQL Task)</strong> que contiene un bloque de código SQL con las siguientes operaciones:</p>
<ol>
<li>
<p><strong>Eliminación de restricciones de clave foránea</strong>:  </p>
<ul>
<li>Se genera y ejecuta un comando dinámico que elimina todas las restricciones de llave foránea en el esquema <code>Transversal</code>.</li>
</ul>
</li>
<li>
<p><strong>Truncado e inserción en la dimensión de Unidades</strong>:  </p>
<ul>
<li>Se trunca la tabla <code>DIM_UNIDAD</code> y se insertan registros que representan las diferentes unidades operativas: Educación Formal, Educación Técnica, Educación Continua, Protección Social y un valor por defecto ("SIN UNIDAD").</li>
</ul>
</li>
<li>
<p><strong>Cargar datos en DIM_INFRAESTRUCTURA_CCF</strong>:  </p>
<ul>
<li>Se trunca la tabla y se insertan registros que incluyen un valor por defecto (con código -1 y descripción 'SinDato') y registros reales asociados a cada unidad.</li>
</ul>
</li>
<li>
<p><strong>Cargar registros en DIM_CATEGORIA</strong>:  </p>
<ul>
<li>Se trunca la tabla <code>DIM_CATEGORIA</code> y se insertan categorías predefinidas, abarcando desde categorías estándar hasta aquellas para empresas y convenios.</li>
</ul>
</li>
<li>
<p><strong>Inicialización de la tabla DIM_PERSONAL</strong>:  </p>
<ul>
<li>Se trunca la tabla y se inserta un registro para el personal sin datos (con ID -1), permitiendo que exista un valor por defecto en situaciones donde no se disponga de información personal.</li>
</ul>
</li>
<li>
<p><strong>Carga de registros por defecto en DIM_TARIFAS_SERVICIOS</strong>:  </p>
<ul>
<li>Se trunca la tabla y se inserta un registro con ID_TARIFA -1, utilizando valores de ejemplo para los campos que definen el servicio, objeto, costo, tarifa, categoría, año y código de infraestructura.</li>
</ul>
</li>
<li>
<p><strong>Carga de registros en el esquema Cedesarrollo</strong>:  </p>
<ul>
<li>Se truncan las tablas DIM_PROGRAMA y DIM_PERIODO_ACADEMICO, insertándose un registro por defecto en cada una (con ID -1) para representar programas y periodos sin datos.</li>
</ul>
</li>
<li>
<p><strong>Carga de registros en el esquema Protección</strong>:  </p>
<ul>
<li>Se actualizan las tablas DIM_PROGRAMA, DIM_PREGUNTAS_EE_JEC, DIM_RESPUESTAS_EE_JEC, DIM_PREGUNTAS_EE_AIPI y DIM_RESPUESTAS_EE_AIPI, insertando registros predeterminados (con valores -1 y descripciones como 'PREGUNTA_ABIERTA' o 'RESPUESTA_PREGUNTA_ABIERTA') para manejar datos no disponibles.</li>
</ul>
</li>
<li>
<p><strong>Verificación e inserción en el esquema Colegio</strong>:  </p>
<ul>
<li>Se verifica la existencia de un registro por defecto en la tabla <code>DIM_POBLACION_MATRICULA</code>. Si no existe, se trunca la tabla y se inserta un registro con ID -1, que utiliza valores "N/A" y un mensaje descriptivo para representar a estudiantes sin cruce de datos.</li>
</ul>
</li>
</ol>
<hr />
<h4 id="tablas-y-columnas-clave_1">Tablas y Columnas Clave<a class="headerlink" href="#tablas-y-columnas-clave_1" title="Permanent link">&para;</a></h4>
<p>A continuación se enumeran algunas de las tablas afectadas y el propósito de los valores por defecto:</p>
<ol>
<li>
<p><strong>DIM_UNIDAD</strong>:</p>
<ul>
<li><strong>Columna</strong>: <code>UNIDAD</code></li>
<li><strong>Valores Insertados</strong>: 'EDUCACIÓN FORMAL', 'EDUCACIÓN TÉCNICA', 'EDUCACIÓN CONTINUA', 'PROTECCIÓN SOCIAL', 'SIN UNIDAD'</li>
</ul>
</li>
<li>
<p><strong>DIM_INFRAESTRUCTURA_CCF</strong>:</p>
<ul>
<li><strong>Columnas</strong>: <code>COD_INFRAESTRUCTURA_CCF</code>, <code>DESCRIPCION</code>, <code>ID_UNIDAD</code></li>
<li><strong>Valores Insertados</strong>: Incluye un registro por defecto con <code>'-1'</code>, 'SinDato', y 5, además de registros reales asociados a cada unidad.</li>
</ul>
</li>
<li>
<p><strong>DIM_CATEGORIA</strong>:</p>
<ul>
<li><strong>Columnas</strong>: <code>COD_CATEGORIA</code>, <code>DESCRIPCION</code></li>
<li><strong>Valores Insertados</strong>: '1' a '12' con descripciones como 'Categoría A', 'Categoría B', etc.</li>
</ul>
</li>
<li>
<p><strong>DIM_PERSONAL</strong>:</p>
<ul>
<li><strong>Columnas</strong>: Incluye <code>ID_PERSONAL</code>, <code>COD_PERSONA_UNIDAD</code>, <code>ID_UNIDAD</code>, entre otras.</li>
<li><strong>Valores Insertados</strong>: Un registro con <code>ID_PERSONAL = -1</code> para representar datos genéricos.</li>
</ul>
</li>
<li>
<p><strong>DIM_TARIFAS_SERVICIOS</strong>:</p>
<ul>
<li><strong>Columnas</strong>: Incluye <code>ID_TARIFA</code>, <code>COD_SERVICIO</code>, <code>CON_OBJETO_TARIFA</code>, <code>COS_UNITARIO_CONCEPTO</code>, <code>VAL_TARIFA</code>, <code>COD_CATEGORIA</code>, <code>ANIO_TARIFA</code>, <code>COD_INFRAESTRUCTURA_CCF</code></li>
<li><strong>Valores Insertados</strong>: Un registro con <code>ID_TARIFA = -1</code> que establece valores predeterminados para definir un servicio sin datos.</li>
</ul>
</li>
<li>
<p><strong>DIM_PROGRAMA (Cedesarrollo)</strong> y <strong>DIM_PERIODO_ACADEMICO (Cedesarrollo)</strong>:</p>
<ul>
<li><strong>Valores Insertados</strong>: Se insertan registros con <code>ID_PROGRAMA = -1</code> y <code>ID_PERIODO = -1</code> respectivamente, indicando ausencia de datos.</li>
</ul>
</li>
<li>
<p><strong>Tablas en Protección (DIM_PROGRAMA, DIM_PREGUNTAS_EE_JEC, DIM_RESPUESTAS_EE_JEC, DIM_PREGUNTAS_EE_AIPI, DIM_RESPUESTAS_EE_AIPI)</strong>:</p>
<ul>
<li><strong>Valores Insertados</strong>: Se insertan registros que utilizan el valor -1 para representar preguntas y respuestas predeterminadas.</li>
</ul>
</li>
<li>
<p><strong>DIM_POBLACION_MATRICULA (Colegio)</strong>:</p>
<ul>
<li><strong>Valores Insertados</strong>: Se inserta un registro con <code>ID_POBLACION_MATRICULA = -1</code> en caso de que no exista, utilizando valores "N/A" y una descripción para estudiantes sin cruce.</li>
</ul>
</li>
</ol>
<hr />
<h4 id="diagramas_1">Diagramas<a class="headerlink" href="#diagramas_1" title="Permanent link">&para;</a></h4>
<h5 id="diagrama-de-flujo-de-proceso-de-carga-de-valores-nulos-por-defecto">Diagrama de Flujo de Proceso de Carga de Valores Nulos por Defecto<a class="headerlink" href="#diagrama-de-flujo-de-proceso-de-carga-de-valores-nulos-por-defecto" title="Permanent link">&para;</a></h5>
<pre class="mermaid"><code>sequenceDiagram
    participant SQL_TASK as Tarea Ejecutar SQL
    participant Transversal as Esquema Transversal
    participant Cedesarrollo as Esquema Cedesarrollo
    participant Proteccion as Esquema Proteccion
    participant Colegio as Esquema Colegio

    SQL_TASK-&gt;&gt;Transversal: Eliminar restricciones y truncar tablas DIM_UNIDAD, DIM_INFRAESTRUCTURA_CCF, DIM_CATEGORIA y DIM_PERSONAL
    Transversal--&gt;&gt;SQL_TASK: Confirmación de eliminación y truncado
    SQL_TASK-&gt;&gt;Transversal: Insertar registros por defecto en DIM_UNIDAD, DIM_INFRAESTRUCTURA_CCF y DIM_CATEGORIA
    Transversal--&gt;&gt;SQL_TASK: Confirmación de inserción
    SQL_TASK-&gt;&gt;Transversal: Insertar registro por defecto en DIM_PERSONAL
    Transversal--&gt;&gt;SQL_TASK: Confirmación de inserción
    SQL_TASK-&gt;&gt;Transversal: Insertar registro por defecto en DIM_TARIFAS_SERVICIOS
    Transversal--&gt;&gt;SQL_TASK: Confirmación de inserción
    SQL_TASK-&gt;&gt;Cedesarrollo: Truncar e insertar registro por defecto en DIM_PROGRAMA y DIM_PERIODO_ACADEMICO
    Cedesarrollo--&gt;&gt;SQL_TASK: Confirmación de inserción
    SQL_TASK-&gt;&gt;Proteccion: Truncar e insertar registros predeterminados en DIM_PROGRAMA, DIM_PREGUNTAS_EE_JEC, DIM_RESPUESTAS_EE_JEC, DIM_PREGUNTAS_EE_AIPI y DIM_RESPUESTAS_EE_AIPI
    Proteccion--&gt;&gt;SQL_TASK: Confirmación de inserción
    SQL_TASK-&gt;&gt;Colegio: Verificar e insertar registro por defecto en DIM_POBLACION_MATRICULA
    Colegio--&gt;&gt;SQL_TASK: Confirmación de inserción</code></pre>
<h4 id="proposito"><strong>Propósito</strong>:<a class="headerlink" href="#proposito" title="Permanent link">&para;</a></h4>
<p>Este componente tiene como objetivo inicializar y estandarizar los datos en múltiples esquemas del Data Warehouse mediante la carga de valores predeterminados en caso de ausencia de información. Esto facilita la integración de datos y evita problemas en las consultas y análisis posteriores.</p>
<p><strong>Operaciones Principales</strong>:</p>
<ol>
<li>
<p><strong>Eliminación de Restricciones</strong>:  </p>
<ul>
<li>Genera y ejecuta un script dinámico para eliminar todas las restricciones de clave foránea en el esquema <code>Transversal</code>, permitiendo la inserción de datos sin conflictos.</li>
</ul>
</li>
<li>
<p><strong>Limpieza de Tablas</strong>:  </p>
<ul>
<li>Se truncan las tablas críticas en los esquemas involucrados (por ejemplo, <code>DIM_UNIDAD</code>, <code>DIM_INFRAESTRUCTURA_CCF</code>, <code>DIM_CATEGORIA</code>, <code>DIM_PERSONAL</code>, <code>DIM_TARIFAS_SERVICIOS</code>, entre otras) para asegurar que no existan datos obsoletos o inconsistentes.</li>
</ul>
</li>
<li>
<p><strong>Carga de Registros Predeterminados</strong>:  </p>
<ul>
<li>Inserta registros con valores especiales (usualmente -1 o 'N/A') en cada tabla para representar datos no disponibles.  </li>
<li>Se incluyen registros para áreas operativas como Transversal, Cedesarrollo, Protección y Colegio, garantizando que cada área disponga de un registro por defecto.</li>
</ul>
</li>
</ol>
<h4 id="codigo-sql_1">Código SQL<a class="headerlink" href="#codigo-sql_1" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="n">USE</span><span class="w"> </span><span class="n">DWH_COMFENALCO</span>
<span class="k">GO</span>
<span class="k">SET</span><span class="w"> </span><span class="n">ANSI_NULLS</span><span class="w"> </span><span class="k">ON</span>
<span class="k">GO</span>
<span class="k">SET</span><span class="w"> </span><span class="n">QUOTED_IDENTIFIER</span><span class="w"> </span><span class="k">ON</span>
<span class="k">GO</span>
<span class="c1">-- Eliminar restricciones de clave foránea</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="w"> </span><span class="n">NVARCHAR</span><span class="p">(</span><span class="k">MAX</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;ALTER TABLE &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">QUOTENAME</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">QUOTENAME</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; DROP CONSTRAINT &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">QUOTENAME</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;; &#39;</span><span class="w"> </span>
<span class="k">FROM</span><span class="w"> </span><span class="n">sys</span><span class="p">.</span><span class="n">foreign_keys</span><span class="w"> </span><span class="n">f</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">sys</span><span class="p">.</span><span class="n">tables</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">parent_object_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">object_id</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">sys</span><span class="p">.</span><span class="n">schemas</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">schema_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">schema_id</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Transversal&#39;</span><span class="p">;</span>
<span class="k">EXEC</span><span class="w"> </span><span class="n">sp_executesql</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="p">;</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_UNIDAD</span><span class="p">];</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_UNIDAD</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">UNIDAD</span><span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;EDUCACIÓN FORMAL&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;EDUCACIÓN TÉCNICA&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;EDUCACIÓN CONTINUA&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;PROTECCIÓN SOCIAL&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;SIN UNIDAD&#39;</span><span class="p">);</span>
<span class="c1">-- Insertar registros en DIM_INFRAESTRUCTURA</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_INFRAESTRUCTURA_CCF</span><span class="p">];</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_INFRAESTRUCTURA_CCF</span><span class="p">]</span><span class="w"> </span><span class="p">([</span><span class="n">COD_INFRAESTRUCTURA_CCF</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">DESCRIPCION</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">ID_UNIDAD</span><span class="p">])</span><span class="w"> </span><span class="k">VALUES</span>
<span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SinDato&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;CCF008-12-00001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Educación formal&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;CCF008-13-00001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Educación para el trabajo&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;CCF008-15-00001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Desarrollo empresarial&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;CCF008-26-00001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Protección social&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="c1">-- Insertar registros DIM_CATEGORIA</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_CATEGORIA</span><span class="p">];</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_CATEGORIA</span><span class="p">]</span><span class="w"> </span><span class="p">([</span><span class="n">COD_CATEGORIA</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">DESCRIPCION</span><span class="p">])</span><span class="w"> </span><span class="k">VALUES</span>
<span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Categoría A&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Categoría B&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Categoría C&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Categoría D&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Empresas&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;6&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Fondos de Ley&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;10&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Convenios y Facultativos&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Empresa no afiliada&#39;</span><span class="p">);</span>

<span class="c1">-- Insertar un registro para el personal sin datos</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_PERSONAL</span><span class="p">];</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_PERSONAL</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_PERSONAL</span><span class="p">]</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">[</span><span class="n">ID_PERSONAL</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">COD_PERSONA_UNIDAD</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">ID_UNIDAD</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">SERVICIO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">NOMBRE</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">TELEFONO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">CELULAR</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">CORREO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">DIRECCION</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">CIUDAD</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">TIPO_DOCUMENTO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">DOCUMENTO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">FECHA_NACIMIENTO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">GENERO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">HORAS_CONTRATADAS_MENSUAL</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">HORAS_CONTRATADAS_TOTALES</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">VALOR_TOTAL</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">TIPO_CONTRATACION</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">FECHA_INICIO_CONTRATACION</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">FECHA_FIN_CONTRATACION</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">CAUSA_TERMINACION_CONTRATO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">PREGRADO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">POSGRADO_ESPECIALIDAD</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">POSGRADO_MAESTRIA</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">POSGRADO_DOCTORADO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">NIVEL_INGLES</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">AREA</span><span class="p">]</span>
<span class="p">)</span><span class="w"> </span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="mi">5</span><span class="p">,</span>
<span class="w">    </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="s1">&#39;CC&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-1&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1900-01-01&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1900-01-01&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span>
<span class="p">);</span>

<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_PERSONAL</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span>
<span class="k">GO</span>

<span class="c1">-- Insertar registro con ID_TARIFA -1</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_TARIFAS_SERVICIOS</span><span class="p">]</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_TARIFAS_SERVICIOS</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_TARIFAS_SERVICIOS</span><span class="p">]</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">[</span><span class="n">ID_TARIFA</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">COD_SERVICIO</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">CON_OBJETO_TARIFA</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">COS_UNITARIO_CONCEPTO</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">VAL_TARIFA</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">COD_CATEGORIA</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">ANIO_TARIFA</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">COD_INFRAESTRUCTURA_CCF</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="c1">-- Ejemplo de servicio</span>
<span class="w">    </span><span class="s1">&#39;default object&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">-- Ejemplo de objeto</span>
<span class="w">    </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="c1">-- Ejemplo de costo unitario</span>
<span class="w">    </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="c1">-- Ejemplo de valor de tarifa</span>
<span class="w">    </span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">-- Debe coincidir con el valor en DIM_CATEGORIA</span>
<span class="w">    </span><span class="s1">&#39;2024&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">-- Ejemplo de año de tarifa</span>
<span class="w">    </span><span class="s1">&#39;-1&#39;</span><span class="w"> </span><span class="c1">-- Debe coincidir con el valor en DIM_INFRAESTRUCTURA_CCF</span>
<span class="p">);</span>

<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_TARIFAS_SERVICIOS</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span>

<span class="c1">-- Insertar registro con ID_PROGRAMA -1</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Cedesarrollo</span><span class="p">].[</span><span class="n">DIM_PROGRAMA</span><span class="p">]</span><span class="w"> </span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">Cedesarrollo</span><span class="p">].[</span><span class="n">DIM_PROGRAMA</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Cedesarrollo</span><span class="p">].[</span><span class="n">DIM_PROGRAMA</span><span class="p">]</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">[</span><span class="n">ID_PROGRAMA</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">PROGRAMA</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="s1">&#39;Sin Programa&#39;</span><span class="w"> </span><span class="c1">-- Ejemplo de nombre de programa</span>
<span class="p">);</span>

<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">Cedesarrollo</span><span class="p">].[</span><span class="n">DIM_PROGRAMA</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span>

<span class="c1">-- Insertar un registro para el periodo sin datos</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Cedesarrollo</span><span class="p">].[</span><span class="n">DIM_PERIODO_ACADEMICO</span><span class="p">];</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">Cedesarrollo</span><span class="p">].[</span><span class="n">DIM_PERIODO_ACADEMICO</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span>

<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Cedesarrollo</span><span class="p">].[</span><span class="n">DIM_PERIODO_ACADEMICO</span><span class="p">]</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">[</span><span class="n">ID_PERIODO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">ID_UNIDAD</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">PERIODO_ACADEMICO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">FECHA_INICIO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">FECHA_FIN</span><span class="p">]</span>
<span class="p">)</span><span class="w"> </span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="s1">&#39;Sin datos&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="k">NULL</span>
<span class="p">);</span>

<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">Cedesarrollo</span><span class="p">].[</span><span class="n">DIM_PERIODO_ACADEMICO</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span>
<span class="k">GO</span>

<span class="c1">-- Insertar registros de programas Proteccion</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PROGRAMA</span><span class="p">];</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PROGRAMA</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PROGRAMA</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">ID_PROGRAMA</span><span class="p">,</span><span class="n">PROGRAMA</span><span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;ADULTO_MAYOR&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;DISCAPACIDAD&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;JEC&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="s1">&#39;AIPI&#39;</span><span class="p">);</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PROGRAMA</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span>


<span class="c1">-- Insertar -1 para preguntas proteccion JEC</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PREGUNTAS_EE_JEC</span><span class="p">];</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PREGUNTAS_EE_JEC</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PREGUNTAS_EE_JEC</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">ID_PREGUNTA</span><span class="p">,</span><span class="n">PREGUNTA</span><span class="p">,</span><span class="n">ID_PROGRAMA</span><span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;PREGUNTA_ABIERTA&#39;</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PREGUNTAS_EE_JEC</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span>

<span class="c1">-- Insertar -1 para respuestas proteccion JEC</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_RESPUESTAS_EE_JEC</span><span class="p">];</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_RESPUESTAS_EE_JEC</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_RESPUESTAS_EE_JEC</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">ID_RESPUESTA</span><span class="p">,</span><span class="n">RESPUESTA</span><span class="p">,</span><span class="n">ID_PREGUNTA</span><span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;RESPUESTA_PREGUNTA_ABIERTA&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_RESPUESTAS_EE_JEC</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span>


<span class="c1">-- Insertar -1 para preguntas proteccion AIPI</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PREGUNTAS_EE_AIPI</span><span class="p">];</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PREGUNTAS_EE_AIPI</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PREGUNTAS_EE_AIPI</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">ID_PREGUNTA</span><span class="p">,</span><span class="n">PREGUNTA</span><span class="p">,</span><span class="n">ID_PROGRAMA</span><span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;PREGUNTA_ABIERTA&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">);</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PREGUNTAS_EE_AIPI</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span>


<span class="c1">-- Insertar -1 para respuestas proteccion AIPI</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_RESPUESTAS_EE_AIPI</span><span class="p">];</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_RESPUESTAS_EE_AIPI</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_RESPUESTAS_EE_AIPI</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">ID_RESPUESTA</span><span class="p">,</span><span class="n">RESPUESTA</span><span class="p">,</span><span class="n">ID_PREGUNTA</span><span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;RESPUESTA_PREGUNTA_ABIERTA&#39;</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>

<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_RESPUESTAS_EE_AIPI</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span><span class="w"> </span>



<span class="c1">-- Verificar si el registro ya existe</span>
<span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_POBLACION_MATRICULA</span><span class="p">]</span>
<span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">ID_POBLACION_MATRICULA</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="p">)</span>
<span class="k">BEGIN</span>
<span class="w">    </span><span class="c1">-- Activar IDENTITY_INSERT para la tabla</span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_POBLACION_MATRICULA</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span>

<span class="c1">-- Insertar el registro con ID_POBLACION_MATRICULA = -1 para colegio</span>
<span class="w">    </span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_POBLACION_MATRICULA</span><span class="p">]</span><span class="w"> </span>
<span class="w">    </span><span class="p">(</span>
<span class="w">        </span><span class="p">[</span><span class="n">ID_POBLACION_MATRICULA</span><span class="p">],</span>
<span class="w">        </span><span class="p">[</span><span class="n">PARTNER</span><span class="p">],</span>
<span class="w">        </span><span class="p">[</span><span class="n">TIPO_DOCUMENTO</span><span class="p">],</span>
<span class="w">        </span><span class="p">[</span><span class="n">DOCUMENTO</span><span class="p">],</span>
<span class="w">        </span><span class="p">[</span><span class="n">NOMBRE_COMPLETO</span><span class="p">],</span>
<span class="w">        </span><span class="p">[</span><span class="n">GENERO</span><span class="p">],</span>
<span class="w">        </span><span class="p">[</span><span class="n">DIRECCION</span><span class="p">],</span>
<span class="w">        </span><span class="p">[</span><span class="n">TELEFONO</span><span class="p">],</span>
<span class="w">        </span><span class="p">[</span><span class="n">CORREO</span><span class="p">],</span>
<span class="w">        </span><span class="p">[</span><span class="n">FECHA_NACIMIENTO</span><span class="p">]</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="k">VALUES</span><span class="w"> </span>
<span class="w">    </span><span class="p">(</span>
<span class="w">        </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">-- PARTNER</span>
<span class="w">        </span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">-- TIPO_DOCUMENTO</span>
<span class="w">        </span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">-- DOCUMENTO</span>
<span class="w">        </span><span class="s1">&#39;Estudiantes sin cruce&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">-- NOMBRE_COMPLETO</span>
<span class="w">        </span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">-- GENERO</span>
<span class="w">        </span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">-- DIRECCION</span>
<span class="w">        </span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">-- TELEFONO</span>
<span class="w">        </span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="w"> </span><span class="c1">-- CORREO</span>
<span class="w">        </span><span class="k">NULL</span><span class="w"> </span><span class="c1">-- FECHA_NACIMIENTO</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="c1">-- Desactivar IDENTITY_INSERT para la tabla</span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_POBLACION_MATRICULA</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span>
<span class="k">END</span>
</code></pre></div>
<h3 id="componente-cargar_dim_unidades_organizativas">Componente <strong><code>Cargar_DIM_UNIDADES_ORGANIZATIVAS</code></strong><a class="headerlink" href="#componente-cargar_dim_unidades_organizativas" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_2">Descripción General<a class="headerlink" href="#descripcion-general_2" title="Permanent link">&para;</a></h4>
<p>El componente <code>Cargar_DIM_UNIDADES_ORGANIZATIVAS</code> es una tarea de flujo de datos en un paquete SSIS que se encarga de cargar datos en la tabla <code>DIM_UNIDADES_ORGANIZATIVAS</code> en el Data Warehouse. Este componente realiza operaciones de extracción, transformación y carga (ETL) de alto rendimiento.</p>
<h4 id="detalles-del-componente">Detalles del Componente<a class="headerlink" href="#detalles-del-componente" title="Permanent link">&para;</a></h4>
<h5 id="propiedades-del-componente">Propiedades del Componente<a class="headerlink" href="#propiedades-del-componente" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Nombre del Componente</strong>: <code>Cargar_DIM_UNIDADES_ORGANIZATIVAS</code></li>
<li><strong>DTSID</strong>: <code>{2b52324e-63da-4f09-aadd-80b248ece527}</code></li>
<li><strong>Descripción</strong>: <code>Data Flow Task</code></li>
<li><strong>Tipo de Componente</strong>: <code>Microsoft.Pipeline</code></li>
</ul>
<h5 id="componentes-del-flujo-de-datos">Componentes del Flujo de Datos<a class="headerlink" href="#componentes-del-flujo-de-datos" title="Permanent link">&para;</a></h5>
<ol>
<li>
<p><strong>Origen de Datos ADO.NET (<code>DIM_UNIDADES_ORGANIZATIVAS_ORIG</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Consume datos de SQL Server, OLE DB, ODBC u Oracle mediante el correspondiente proveedor de datos de .NET Framework.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>SqlCommand</code>: 
  <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="p">[</span><span class="n">ID_CEBE</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">CEBE</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">DESCRIPCION_BREVE</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">DESCRIPCION_COMPLETA</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">DEPARTAMENTO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">AREA</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">SUBAREA</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">SEGMENTO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">DESCRIPCION_SEGMENTO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">CODIGO_SSF</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">NOMBRE_SSF</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">UDATE</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">NUMERO_PROCESO_SQL</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">FEC_PROCESO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">USUARIO_PROCESO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">GRUPO_CEBE</span><span class="p">],</span><span class="w"> </span>
<span class="k">CASE</span><span class="w"> </span>
<span class="w">    </span><span class="k">WHEN</span><span class="w"> </span><span class="p">[</span><span class="n">DEPARTAMENTO</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;EDUCACION FORMAL&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">WHEN</span><span class="w"> </span><span class="p">[</span><span class="n">DEPARTAMENTO</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;EDUCACION PARA EL TRABAJO&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="k">WHEN</span><span class="w"> </span><span class="p">[</span><span class="n">DEPARTAMENTO</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;DESARROLLO EMPRESARIAL&#39;</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">3</span>
<span class="w">    </span><span class="k">WHEN</span><span class="w"> </span><span class="p">[</span><span class="n">DEPARTAMENTO</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;PROGRAMAS Y CONVENIOS ESPECIALES&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="p">[</span><span class="n">AREA</span><span class="p">]</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Adulto Mayor&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Discapacidad&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Atencion integral a la Ninez&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Jornada Escolar Complementaria&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">4</span>
<span class="w">    </span><span class="k">ELSE</span><span class="w"> </span><span class="mi">5</span>
<span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">[</span><span class="n">ID_UNIDAD</span><span class="p">]</span>
<span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Financiera</span><span class="p">].[</span><span class="n">DIM_UNIDADES_ORGANIZATIVAS</span><span class="p">]</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">DEPARTAMENTO</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;EDUCACION FORMAL&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;EDUCACION PARA EL TRABAJO&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;DESARROLLO EMPRESARIAL&#39;</span><span class="p">)</span>
<span class="k">OR</span><span class="w"> </span><span class="p">(</span><span class="n">DEPARTAMENTO</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;PROGRAMAS Y CONVENIOS ESPECIALES&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">AREA</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;Adulto Mayor&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Discapacidad&#39;</span><span class="p">,</span><span class="s1">&#39;Atencion integral a la Ninez&#39;</span><span class="p">,</span><span class="s1">&#39;Jornada Escolar Complementaria&#39;</span><span class="p">))</span>
</code></pre></div></li>
<li><code>CommandTimeout</code>: <code>30</code></li>
<li><code>AllowImplicitStringConversion</code>: <code>true</code></li>
<li><code>TableOrViewName</code>: <code>"Financiera"."DIM_CUENTA_CONTABLE"</code></li>
<li><code>AccessMode</code>: <code>2</code></li>
</ul>
</li>
<li><strong>Conexiones</strong>:<ul>
<li><code>IDbConnection</code>: <code>Project.ConnectionManagers[DWH_COMFENALCO]</code></li>
</ul>
</li>
<li><strong>Columnas de Salida</strong>:
    <code>ID_CEBE</code>, <code>CEBE</code>, <code>DESCRIPCION_BREVE</code>, <code>DESCRIPCION_COMPLETA</code>, <code>DEPARTAMENTO</code>, <code>AREA</code>, <code>SUBAREA</code>, <code>SEGMENTO</code>, <code>DESCRIPCION_SEGMENTO</code>, <code>CODIGO_SSF</code>, <code>NOMBRE_SSF</code>, <code>UDATE</code>, <code>NUMERO_PROCESO_SQL</code>, <code>FEC_PROCESO</code>, <code>USUARIO_PROCESO</code>, <code>GRUPO_CEBE</code></li>
</ul>
</li>
<li>
<p><strong>Destino de Datos ADO.NET (<code>DIM_UNIDADES_ORGANIZATIVAS_DEST</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Carga datos en una base de datos compatible con ADO.NET que use una vista o tabla de base de datos.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>TableOrViewName</code>: <code>"Transversal"."DIM_UNIDADES_ORGANIZATIVAS"</code></li>
<li><code>BatchSize</code>: <code>0</code></li>
<li><code>CommandTimeout</code>: <code>30</code></li>
<li><code>UseBulkInsertWhenPossible</code>: <code>true</code></li>
</ul>
</li>
<li><strong>Conexiones</strong>:<ul>
<li><code>IDbConnection</code>: <code>Project.ConnectionManagers[DWH_COMFENALCO_Destino]</code></li>
</ul>
</li>
<li><strong>Columnas de Entrada</strong>:
    <code>ID_CEBE</code>, <code>CEBE</code>, <code>DESCRIPCION_BREVE</code>, <code>DESCRIPCION_COMPLETA</code>, <code>DEPARTAMENTO</code>, <code>AREA</code>, <code>SUBAREA</code>, <code>SEGMENTO</code>, <code>DESCRIPCION_SEGMENTO</code>, <code>CODIGO_SSF</code>, <code>NOMBRE_SSF</code>, <code>UDATE</code>, <code>NUMERO_PROCESO_SQL</code>, <code>FEC_PROCESO</code>, <code>USUARIO_PROCESO</code>, <code>GRUPO_CEBE</code></li>
</ul>
</li>
</ol>
<h3 id="componente-descargar_am-tra-08">Componente <strong><code>Descargar_AM-TRA-08</code></strong><a class="headerlink" href="#componente-descargar_am-tra-08" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_3">Descripción General<a class="headerlink" href="#descripcion-general_3" title="Permanent link">&para;</a></h4>
<p>El componente <code>Descargar_AM-TRA-08</code> es una tarea de ejecución de proceso en un paquete SSIS que se encarga de ejecutar un script Python para la conexión a SharePoint y la descarga de archivos manuales.</p>
<h4 id="detalles-del-componente_1">Detalles del Componente<a class="headerlink" href="#detalles-del-componente_1" title="Permanent link">&para;</a></h4>
<h5 id="propiedades-del-componente_1">Propiedades del Componente<a class="headerlink" href="#propiedades-del-componente_1" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Nombre del Componente</strong>: <code>Descargar_AM-TRA-08</code></li>
<li><strong>DTSID</strong>: <code>{16C2FBC1-E5C9-472A-BE1E-3575DAEF56C3}</code></li>
<li><strong>Descripción</strong>: <code>Tarea Ejecutar proceso</code></li>
<li><strong>Tipo de Componente</strong>: <code>Microsoft.ExecuteProcess</code></li>
</ul>
<h5 id="propiedades-de-la-conexion">Propiedades de la Conexión<a class="headerlink" href="#propiedades-de-la-conexion" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Executable</strong>: <code>@[$Project::Working_Directory]+ "COMFENALCO_EDUCACION\\01.Scripts\\Utils\\env\\Scripts\\python.exe"</code></li>
<li><strong>WorkingDirectory</strong>: <code>@[$Project::Working_Directory] +"COMFENALCO_EDUCACION\\01.Scripts\\03.Archivos_Manuales\\01.Transversal"</code></li>
</ul>
<h5 id="detalles-de-la-ejecucion">Detalles de la Ejecución<a class="headerlink" href="#detalles-de-la-ejecucion" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Executable</strong>: <code>\COMFENALCO_EDUCACION\01.Scripts\Utils\env\Scripts\python.exe</code></li>
<li><strong>Arguments</strong>: <code>01.SharePoint_Connection_AM-TRA-08.py</code></li>
<li><strong>WorkingDirectory</strong>: <code>\COMFENALCO_EDUCACION\01.Scripts\03.Archivos_Manuales\01.Transversal</code></li>
</ul>
<h5 id="diagrama-de-secuencia-del-proceso-etl_1">Diagrama de Secuencia del Proceso ETL<a class="headerlink" href="#diagrama-de-secuencia-del-proceso-etl_1" title="Permanent link">&para;</a></h5>
<pre class="mermaid"><code>sequenceDiagram
    title Diagrama de Secuencia del Proceso ETL - Descargar_AM-TRA-08
    autonumber
    participant SSIS as Tarea SSIS
    participant Script as Script Python
    participant SharePoint as SharePoint

    SSIS-&gt;&gt;Script: Ejecutar 01.SharePoint_Connection_AM-TRA-08.py
    Script-&gt;&gt;SharePoint: Conectar a SharePoint
    SharePoint--&gt;&gt;Script: Confirmación de conexión
    Script-&gt;&gt;SharePoint: Descargar archivos manuales
    SharePoint--&gt;&gt;Script: Confirmación de descarga
    Script--&gt;&gt;SSIS: Proceso completado</code></pre>
<h3 id="componente-procesar_dim_servicios">Componente <strong><code>Procesar_DIM_SERVICIOS</code></strong><a class="headerlink" href="#componente-procesar_dim_servicios" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_4">Descripción General<a class="headerlink" href="#descripcion-general_4" title="Permanent link">&para;</a></h4>
<p>El componente <code>Procesar_DIM_SERVICIOS</code> es una tarea de flujo de datos en un paquete SSIS que se encarga de procesar y cargar datos en la tabla <code>DIM_TARIFAS_SERVICIOS</code> en el Data Warehouse. Este componente realiza operaciones de extracción, transformación y carga (ETL) de alto rendimiento.</p>
<h4 id="detalles-del-componente_2">Detalles del Componente<a class="headerlink" href="#detalles-del-componente_2" title="Permanent link">&para;</a></h4>
<h5 id="propiedades-del-componente_2">Propiedades del Componente<a class="headerlink" href="#propiedades-del-componente_2" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Nombre del Componente</strong>: <code>Procesar_DIM_SERVICIOS</code></li>
<li><strong>DTSID</strong>: <code>{0EC61E46-C061-4440-8E8D-2704CC9AD0D4}</code></li>
<li><strong>Descripción</strong>: <code>Data Flow Task</code></li>
<li><strong>Tipo de Componente</strong>: <code>Microsoft.Pipeline</code></li>
</ul>
<h5 id="componentes-del-flujo-de-datos_1">Componentes del Flujo de Datos<a class="headerlink" href="#componentes-del-flujo-de-datos_1" title="Permanent link">&para;</a></h5>
<ol>
<li>
<p><strong>Fuente de Datos Excel (<code>AM-TRA-08_Manual_Tarifario</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Lee datos desde una hoja de Excel.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>CommandTimeout</code>: <code>0</code></li>
<li><code>OpenRowset</code>: <code>Sheet1$</code></li>
<li><code>AccessMode</code>: <code>0</code></li>
</ul>
</li>
<li><strong>Conexiones</strong>:<ul>
<li><code>OleDbConnection</code>: <code>Project.ConnectionManagers[Excel_Connection_Dim_Servicios]</code></li>
</ul>
</li>
<li><strong>Columnas de Salida</strong>:
    <code>ANIO_TARIFA</code>, <code>COD_INFRAESTRUCTURA_CCF</code>, <code>CON_OBJETO_TARIFA</code>, <code>COS_UNITARIO_CONCEPTO</code>, <code>COD_CATEGORIA</code>, <code>VAL_TARIFA</code>, <code>COD_SERVICIO</code></li>
</ul>
</li>
<li>
<p><strong>Conversión de Datos (<code>Verificar Tipos de Datos</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Convierte los tipos de datos de las columnas de entrada.</li>
<li><strong>Columnas de Entrada</strong>:
    <code>ANIO_TARIFA</code>, <code>COD_INFRAESTRUCTURA_CCF</code>, <code>CON_OBJETO_TARIFA</code>, <code>COS_UNITARIO_CONCEPTO</code>, <code>COD_CATEGORIA</code>, <code>VAL_TARIFA</code>, <code>COD_SERVICIO</code></li>
<li><strong>Columnas de Salida</strong>:
    <code>ANIO_TARIFA_v</code>, <code>COD_INFRAESTRUCTURA_CCF_v</code>, <code>CON_OBJETO_TARIFA_v</code>, <code>COS_UNITARIO_CONCEPTO_v</code>, <code>COD_CATEGORIA_v</code>, <code>VAL_TARIFA_v</code>, <code>COD_SERVICIO_v</code></li>
</ul>
</li>
<li>
<p><strong>Columna Derivada (<code>Crear ID_SERVICIO_AUXILIAR</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Crea una nueva columna <code>ID_TARIFA_AUXILIAR</code> concatenando varias columnas de entrada.</li>
<li><strong>Columnas de Entrada</strong>:<ul>
<li><code>ANIO_TARIFA_v</code></li>
<li><code>COD_INFRAESTRUCTURA_CCF_v</code></li>
<li><code>COD_SERVICIO_v</code></li>
<li><code>COD_CATEGORIA_v</code></li>
</ul>
</li>
<li><strong>Columnas de Salida</strong>:<ul>
<li><code>ID_TARIFA_AUXILIAR</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Búsqueda (<code>Lookup</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Realiza una búsqueda en la tabla <code>DIM_TARIFAS_SERVICIOS</code> para unir columnas adicionales al flujo de datos.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>SqlCommand</code>: <code>select * from [Transversal].[DIM_TARIFAS_SERVICIOS]</code></li>
<li><code>SqlCommandParam</code>: <code>select * from (select * from [Transversal].[DIM_TARIFAS_SERVICIOS]) [refTable] where [refTable].[ID_TARIFA_AUXILIAR] = ?</code></li>
</ul>
</li>
<li><strong>Conexiones</strong>:<ul>
<li><code>OleDbConnection</code>: <code>Project.ConnectionManagers[DWH_COMFENALCO_Destino_OLEDB]</code></li>
</ul>
</li>
<li><strong>Columnas de Entrada</strong>:<ul>
<li><code>ID_TARIFA_AUXILIAR</code></li>
</ul>
</li>
<li><strong>Columnas de Salida</strong>:<ul>
<li><code>COD_SERVICIO</code>, <code>CON_OBJETO_TARIFA</code>, <code>COS_UNITARIO_CONCEPTO</code>, <code>VAL_TARIFA</code>, <code>COD_CATEGORIA</code></li>
<li><code>ANIO_TARIFA</code>,  <code>COD_INFRAESTRUCTURA_CCF</code>, <code>ID_TARIFA</code>, <code>ID_TARIFA_AUXILIAR</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>División Condicional (<code>Conditional Split</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Divide las filas de datos en diferentes salidas según el contenido de los datos.</li>
<li><strong>Columnas de Entrada</strong>:<ul>
<li><code>ID_TARIFA_AUXILIAR</code></li>
</ul>
</li>
<li><strong>Salidas</strong>:<ul>
<li><code>Agregar</code>: Filas donde <code>ID_TARIFA_AUXILIAR</code> es nulo.</li>
<li><code>Sin Cambios</code>: Filas donde <code>ID_TARIFA_AUXILIAR</code> no es nulo.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Destino de Datos ADO.NET (<code>DIM_SERVICIOS_DEST</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Carga datos en la tabla <code>DIM_TARIFAS_SERVICIOS</code> en el Data Warehouse.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>TableOrViewName</code>: <code>"Transversal"."DIM_TARIFAS_SERVICIOS"</code></li>
<li><code>BatchSize</code>: <code>0</code></li>
<li><code>CommandTimeout</code>: <code>30</code></li>
<li><code>UseBulkInsertWhenPossible</code>: <code>true</code></li>
</ul>
</li>
<li><strong>Conexiones</strong>:<ul>
<li><code>IDbConnection</code>: <code>Project.ConnectionManagers[DWH_COMFENALCO_Destino]</code></li>
</ul>
</li>
<li><strong>Columnas de Entrada</strong>:
    <code>COD_SERVICIO_v</code>, <code>CON_OBJETO_TARIFA_v</code>, <code>COS_UNITARIO_CONCEPTO_v</code>, <code>VAL_TARIFA_v</code>, <code>COD_CATEGORIA_v</code>, <code>ANIO_TARIFA_v</code>, <code>COD_INFRAESTRUCTURA_CCF_v</code></li>
</ul>
</li>
</ol>
<h3 id="componente-cargar_dim_sedes">Componente <strong><code>Cargar_DIM_SEDES</code></strong><a class="headerlink" href="#componente-cargar_dim_sedes" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_5">Descripción General<a class="headerlink" href="#descripcion-general_5" title="Permanent link">&para;</a></h4>
<p>El componente <code>Cargar_DIM_SEDES</code> es una tarea de ejecución de SQL en un paquete SSIS que se encarga de truncar y cargar datos en la tabla <code>DIM_SEDES</code> en el Data Warehouse.</p>
<h4 id="detalles-del-componente_3">Detalles del Componente<a class="headerlink" href="#detalles-del-componente_3" title="Permanent link">&para;</a></h4>
<h5 id="propiedades-del-componente_3">Propiedades del Componente<a class="headerlink" href="#propiedades-del-componente_3" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Nombre del Componente</strong>: <code>Cargar_DIM_SEDES</code></li>
<li><strong>DTSID</strong>: <code>{fbd7f70d-08d3-4da5-a641-f28f431909b7}</code></li>
<li><strong>Descripción</strong>: <code>Tarea Ejecutar SQL</code></li>
<li><strong>Tipo de Componente</strong>: <code>Microsoft.ExecuteSQLTask</code></li>
</ul>
<h5 id="propiedades-de-la-conexion_1">Propiedades de la Conexión<a class="headerlink" href="#propiedades-de-la-conexion_1" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Connection</strong>: <code>{57F24C4D-9B0A-4EBB-AE46-43F9B341582B}</code></li>
<li><strong>Tipo de Conexión</strong>: <code>OLE DB</code></li>
</ul>
<h5 id="detalles-de-la-ejecucion_1">Detalles de la Ejecución<a class="headerlink" href="#detalles-de-la-ejecucion_1" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>SQL Statement</strong>:
  <div class="highlight"><pre><span></span><code><span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_SEDES</span><span class="p">];</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_SEDES</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">SEDE</span><span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;CEC&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;CEDESARROLLO&#39;</span><span class="p">);</span>
</code></pre></div></li>
</ul>
<h5 id="diagrama-de-secuencia-del-proceso-etl_2">Diagrama de Secuencia del Proceso ETL<a class="headerlink" href="#diagrama-de-secuencia-del-proceso-etl_2" title="Permanent link">&para;</a></h5>
<pre class="mermaid"><code>sequenceDiagram
    title Diagrama de Secuencia del Proceso ETL - Cargar_DIM_SEDES
    autonumber
    participant SSIS as Tarea SSIS
    participant SQL as Base de Datos SQL

    SSIS-&gt;&gt;SQL: TRUNCATE TABLE [DWH_COMFENALCO].[Transversal].[DIM_SEDES]
    SQL--&gt;&gt;SSIS: Confirmación de truncado
    SSIS-&gt;&gt;SQL: INSERT INTO [Transversal].[DIM_SEDES] (SEDE) VALUES ('CEC'), ('CEDESARROLLO')
    SQL--&gt;&gt;SSIS: Confirmación de inserción</code></pre>
<h5 id="descripcion-del-proceso">Descripción del Proceso<a class="headerlink" href="#descripcion-del-proceso" title="Permanent link">&para;</a></h5>
<ol>
<li><strong>Truncar Tabla</strong>: La tarea ejecuta una instrucción SQL para truncar la tabla <code>DIM_SEDES</code>, eliminando todos los registros existentes.</li>
<li><strong>Insertar Datos</strong>: La tarea ejecuta una instrucción SQL para insertar nuevos registros en la tabla <code>DIM_SEDES</code> con los valores <code>'CEC'</code> y <code>'CEDESARROLLO'</code>.</li>
</ol>
<p>Este proceso asegura que la tabla <code>DIM_SEDES</code> se actualice con los datos más recientes, eliminando cualquier dato anterior y cargando los nuevos valores especificados.</p>
<h3 id="componente-descargar_ep-tra-12">Componente <strong><code>Descargar_EP-TRA-12</code></strong><a class="headerlink" href="#componente-descargar_ep-tra-12" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_6">Descripción General<a class="headerlink" href="#descripcion-general_6" title="Permanent link">&para;</a></h4>
<p>El componente <code>Descargar_EP-TRA-12</code> es una tarea de ejecución de proceso en un paquete SSIS que se encarga de ejecutar un script Python para la conexión a SharePoint y la descarga de archivos manuales.</p>
<h4 id="detalles-del-componente_4">Detalles del Componente<a class="headerlink" href="#detalles-del-componente_4" title="Permanent link">&para;</a></h4>
<h5 id="propiedades-del-componente_4">Propiedades del Componente<a class="headerlink" href="#propiedades-del-componente_4" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Nombre del Componente</strong>: <code>Descargar_EP-TRA-12</code></li>
<li><strong>DTSID</strong>: <code>{56e49c08-d0c9-4678-8e9c-27288db94c3b}</code></li>
<li><strong>Descripción</strong>: <code>Tarea Ejecutar proceso</code></li>
<li><strong>Tipo de Componente</strong>: <code>Microsoft.ExecuteProcess</code></li>
</ul>
<h5 id="propiedades-de-la-conexion_2">Propiedades de la Conexión<a class="headerlink" href="#propiedades-de-la-conexion_2" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Executable</strong>: <code>@[$Project::Working_Directory]+"COMFENALCO_EDUCACION\\01.Scripts\\Utils\\env\\Scripts\\python.exe"</code></li>
<li><strong>WorkingDirectory</strong>: <code>@[$Project::Working_Directory]+"COMFENALCO_EDUCACION\\01.Scripts\\03.Archivos_Manuales\\01.Transversal"</code></li>
</ul>
<h5 id="detalles-de-la-ejecucion_2">Detalles de la Ejecución<a class="headerlink" href="#detalles-de-la-ejecucion_2" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Executable</strong>: <code>\COMFENALCO_EDUCACION\01.Scripts\Utils\env\Scripts\python.exe</code></li>
<li><strong>Arguments</strong>: <code>02.SharePoint_Connection_EP-TRA-12.py</code></li>
<li><strong>WorkingDirectory</strong>: <code>\COMFENALCO_EDUCACION\01.Scripts\03.Archivos_Manuales\01.Transversal</code></li>
</ul>
<h5 id="diagrama-de-secuencia-del-proceso-etl_3">Diagrama de Secuencia del Proceso ETL<a class="headerlink" href="#diagrama-de-secuencia-del-proceso-etl_3" title="Permanent link">&para;</a></h5>
<pre class="mermaid"><code>sequenceDiagram
    title Diagrama de Secuencia del Proceso ETL - Descargar_EP-TRA-12
    autonumber
    participant SSIS as Tarea SSIS
    participant Script as Script Python
    participant SharePoint as SharePoint

    SSIS-&gt;&gt;Script: Ejecutar 02.SharePoint_Connection_EP-TRA-12.py
    Script-&gt;&gt;SharePoint: Conectar a SharePoint
    SharePoint--&gt;&gt;Script: Confirmación de conexión
    Script-&gt;&gt;SharePoint: Descargar archivos manuales
    SharePoint--&gt;&gt;Script: Confirmación de descarga
    Script--&gt;&gt;SSIS: Proceso completado</code></pre>
<h5 id="descripcion-del-proceso_1">Descripción del Proceso<a class="headerlink" href="#descripcion-del-proceso_1" title="Permanent link">&para;</a></h5>
<ol>
<li><strong>Ejecutar Script Python</strong>: La tarea ejecuta el script <code>02.SharePoint_Connection_EP-TRA-12.py</code> utilizando el intérprete de Python especificado.</li>
<li><strong>Conectar a SharePoint</strong>: El script se conecta a SharePoint para acceder a los archivos manuales.</li>
<li><strong>Descargar Archivos</strong>: El script descarga los archivos manuales desde SharePoint al directorio de trabajo especificado.</li>
<li><strong>Confirmación de Descarga</strong>: El script confirma la descarga exitosa de los archivos y finaliza el proceso.</li>
</ol>
<h3 id="componente-procesar_dim_capacidad_fisica">Componente <strong><code>Procesar_DIM_CAPACIDAD_FISICA</code></strong><a class="headerlink" href="#componente-procesar_dim_capacidad_fisica" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_7">Descripción General<a class="headerlink" href="#descripcion-general_7" title="Permanent link">&para;</a></h4>
<p>El componente <code>Procesar_DIM_CAPACIDAD_FISICA</code> es una tarea de flujo de datos en un paquete SSIS que se encarga de procesar y cargar datos en la tabla <code>DIM_CAPACIDAD_FISICA</code> en el Data Warehouse. Este componente realiza operaciones de extracción, transformación y carga (ETL) de alto rendimiento.</p>
<h4 id="detalles-del-componente_5">Detalles del Componente<a class="headerlink" href="#detalles-del-componente_5" title="Permanent link">&para;</a></h4>
<h5 id="propiedades-del-componente_5">Propiedades del Componente<a class="headerlink" href="#propiedades-del-componente_5" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Nombre del Componente</strong>: <code>Procesar_DIM_CAPACIDAD_FISICA</code></li>
<li><strong>DTSID</strong>: <code>{592bbecc-5b7f-44ef-b177-462c29ca7233}</code></li>
<li><strong>Descripción</strong>: <code>Data Flow Task</code></li>
<li><strong>Tipo de Componente</strong>: <code>Microsoft.Pipeline</code></li>
</ul>
<h5 id="componentes-del-flujo-de-datos_2">Componentes del Flujo de Datos<a class="headerlink" href="#componentes-del-flujo-de-datos_2" title="Permanent link">&para;</a></h5>
<ol>
<li>
<p><strong>Fuente de Datos Excel (<code>EP-TRA-12_Capacidad Fisica</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Lee datos desde una hoja de Excel.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>CommandTimeout</code>: <code>0</code></li>
<li><code>OpenRowset</code>: <code>Sheet1$</code></li>
<li><code>AccessMode</code>: <code>0</code></li>
</ul>
</li>
<li><strong>Conexiones</strong>:<ul>
<li><code>OleDbConnection</code>: <code>Project.ConnectionManagers[Excel_Connection_Dim_Capacidad]</code></li>
</ul>
</li>
<li><strong>Columnas de Salida</strong>:
    <code>ID_SALON</code>, <code>CAPACIDAD</code>, <code>JORNADA</code>, <code>DESCRIPCION_ESPACIO</code>, <code>ID_UNIDAD</code>, <code>BLOQUE</code>, <code>GRUPO</code>, <code>ID_SEDE</code>, <code>SEDE</code>, <code>ESTADO</code>, <code>FECHA_ESTADO</code></li>
</ul>
</li>
<li>
<p><strong>Conversión de Datos (<code>Data Conversion</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Convierte los tipos de datos de las columnas de entrada.</li>
<li>
<p><strong>Columnas de Entrada</strong>:
    <code>ID_SALON</code>, <code>CAPACIDAD</code>, <code>JORNADA</code>, <code>DESCRIPCION_ESPACIO</code>, <code>ID_UNIDAD</code>, <code>BLOQUE</code>, <code>GRUPO</code>, <code>ID_SEDE</code>, <code>SEDE</code>, <code>ESTADO</code>, <code>FECHA_ESTADO</code></p>
</li>
<li>
<p><strong>Columnas de Salida</strong>:
    <code>Copy of ID_SALON</code>, <code>Copy of CAPACIDAD</code>, <code>Copy of JORNADA</code>, <code>Copy of DESCRIPCION_ESPACIO</code>, <code>Copy of ID_UNIDAD</code>, <code>Copy of BLOQUE</code>, <code>Copy of GRUPO</code>, <code>Copy of ID_SEDE</code>, <code>Copy of SEDE</code>, <code>Copy of ESTADO</code>, <code>Copy of FECHA_ESTADO</code></p>
</li>
</ul>
</li>
<li>
<p><strong>Columna Derivada (<code>Crear_ID_CAPACIDAD_AUXILIAR</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Crea una nueva columna <code>ID_CAPACIDAD_AUXILIAR</code> concatenando varias columnas de entrada.</li>
<li><strong>Columnas de Entrada</strong>:
    <code>Copy of ID_SALON</code>,  <code>Copy of JORNADA</code>, <code>Copy of ID_UNIDAD</code></li>
<li><strong>Columnas de Salida</strong>:
    <code>ID_CAPACIDAD_AUXILIAR</code></li>
</ul>
</li>
<li>
<p><strong>Búsqueda (<code>Lookup</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Realiza una búsqueda en la tabla <code>DIM_CAPACIDAD_FISICA</code> para unir columnas adicionales al flujo de datos.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>SqlCommand</code>: <code>select * from [Transversal].[DIM_CAPACIDAD_FISICA]</code></li>
<li><code>SqlCommandParam</code>: <code>select * from (select * from [Transversal].[DIM_CAPACIDAD_FISICA]) [refTable] where [refTable].[ID_CAPACIDAD_AUXILIAR] = ?</code></li>
</ul>
</li>
<li><strong>Conexiones</strong>:<ul>
<li><code>OleDbConnection</code>: <code>Project.ConnectionManagers[DWH_COMFENALCO_Destino_OLEDB]</code></li>
</ul>
</li>
<li><strong>Columnas de Entrada</strong>:
    <code>ID_CAPACIDAD_AUXILIAR</code></li>
<li><strong>Columnas de Salida</strong>:
    <code>ID_CAPACIDAD</code>, <code>ID_SALON</code>, <code>CAPACIDAD</code>, <code>DESCRIPCION_ESPACIO</code>, <code>JORNADA</code>, <code>BLOQUE</code>, <code>GRUPO</code>, <code>ID_UNIDAD</code>, <code>ID_SEDE</code>, <code>SEDE</code>, <code>ESTADO</code>, <code>FECHA_ESTADO</code>, <code>ID_CAPACIDAD_AUXILIAR</code></li>
</ul>
</li>
<li>
<p><strong>División Condicional (<code>Conditional Split</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Divide las filas de datos en diferentes salidas según el contenido de los datos.</li>
<li>
<p><strong>Columnas de Entrada</strong>:
    <code>ID_SALON</code>, <code>CAPACIDAD</code>, <code>JORNADA</code>, <code>DESCRIPCION_ESPACIO</code>, <code>ID_UNIDAD</code>, <code>BLOQUE</code>, <code>GRUPO</code>, <code>ID_SEDE</code>, <code>SEDE</code>, <code>ESTADO</code>, <code>FECHA_ESTADO</code>, <code>ID_CAPACIDAD</code></p>
</li>
<li>
<p><strong>Salidas</strong>:</p>
<ul>
<li><code>Agregar</code>: Filas donde <code>ID_CAPACIDAD</code> es nulo.</li>
<li><code>Modificar</code>: Filas donde hay diferencias entre las columnas de entrada y las columnas de búsqueda.</li>
<li><code>Sin Cambios</code>: Filas donde no hay diferencias.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Destino de Datos ADO.NET (<code>DIM_CAPACIDAD_FISICA_DEST</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Carga datos en la tabla <code>DIM_CAPACIDAD_FISICA</code> en el Data Warehouse.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>TableOrViewName</code>: <code>"Transversal"."DIM_CAPACIDAD_FISICA"</code></li>
<li><code>BatchSize</code>: <code>0</code></li>
<li><code>CommandTimeout</code>: <code>30</code></li>
<li><code>UseBulkInsertWhenPossible</code>: <code>true</code></li>
</ul>
</li>
<li><strong>Conexiones</strong>:<ul>
<li><code>IDbConnection</code>: <code>Project.ConnectionManagers[DWH_COMFENALCO_Destino]</code></li>
</ul>
</li>
<li><strong>Columnas de Entrada</strong>:
    <code>Copy of ID_SALON</code>, <code>Copy of CAPACIDAD</code>, <code>Copy of DESCRIPCION_ESPACIO</code>, <code>Copy of JORNADA</code>, <code>Copy of BLOQUE</code>, <code>Copy of GRUPO</code>, <code>Copy of ID_UNIDAD</code>, <code>Copy of ID_SEDE</code>, <code>Copy of SEDE</code>, <code>Copy of ESTADO</code>, <code>Copy of FECHA_ESTADO</code></li>
</ul>
</li>
<li>
<p><strong>Comando OLE DB (<code>OLE DB Command 1</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Ejecuta una instrucción SQL para cada fila en el flujo de datos.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>SqlCommand</code>: 
  <div class="highlight"><pre><span></span><code><span class="k">UPDATE</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_CAPACIDAD_FISICA</span><span class="p">]</span>
<span class="w">   </span><span class="k">SET</span><span class="w"> </span><span class="p">[</span><span class="n">ID_SALON</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
<span class="w">      </span><span class="p">,[</span><span class="n">CAPACIDAD</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
<span class="w">      </span><span class="p">,[</span><span class="n">DESCRIPCION_ESPACIO</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
<span class="w">      </span><span class="p">,[</span><span class="n">JORNADA</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
<span class="w">      </span><span class="p">,[</span><span class="n">BLOQUE</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
<span class="w">      </span><span class="p">,[</span><span class="n">GRUPO</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
<span class="w">      </span><span class="p">,[</span><span class="n">ID_UNIDAD</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
<span class="w">      </span><span class="p">,[</span><span class="n">ID_SEDE</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
<span class="w">      </span><span class="p">,[</span><span class="n">SEDE</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
<span class="w">      </span><span class="p">,[</span><span class="n">ESTADO</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
<span class="w">      </span><span class="p">,[</span><span class="n">FECHA_ESTADO</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
<span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">ID_CAPACIDAD</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">?</span>
</code></pre></div></li>
</ul>
</li>
<li><strong>Conexiones</strong>:<ul>
<li><code>OleDbConnection</code>: <code>Project.ConnectionManagers[DWH_COMFENALCO_Destino_OLEDB]</code></li>
</ul>
</li>
<li><strong>Columnas de Entrada</strong>:<ul>
<li><code>ID_SALON</code>, <code>CAPACIDAD</code>, <code>DESCRIPCION_ESPACIO</code>, <code>JORNADA</code>, <code>BLOQUE</code>, <code>GRUPO</code>, <code>ID_UNIDAD</code>, <code>ID_SEDE</code>, <code>SEDE</code>, <code>ESTADO</code>, <code>FECHA_ESTADO</code>, <code>ID_CAPACIDAD</code></li>
</ul>
</li>
</ul>
</li>
</ol>
<h5 id="diagrama-de-flujo-de-datos">Diagrama de Flujo de Datos<a class="headerlink" href="#diagrama-de-flujo-de-datos" title="Permanent link">&para;</a></h5>
<pre class="mermaid"><code>sequenceDiagram
    participant ExcelSource as EP-TRA-12_Capacidad Fisica
    participant DataConversion as Data Conversion
    participant DerivedColumn as Crear_ID_CAPACIDAD_AUXILIAR
    participant Lookup as Lookup
    participant ConditionalSplit as Conditional Split
    participant AdoNetDestination as DIM_CAPACIDAD_FISICA_DEST
    participant OleDbCommand as OLE DB Command 1

    ExcelSource -&gt;&gt; DataConversion: Excel Source Output
    DataConversion -&gt;&gt; DerivedColumn: Data Conversion Output
    DerivedColumn -&gt;&gt; Lookup: Derived Column Output
    Lookup -&gt;&gt; ConditionalSplit: Lookup Match Output
    ConditionalSplit -&gt;&gt; AdoNetDestination: Agregar
    ConditionalSplit -&gt;&gt; OleDbCommand: Modificar</code></pre>
<h3 id="componente-tabla-temporal-dim_estudiantes-educacion-continua-y-tecnica">Componente <strong><code>Tabla Temporal DIM_ESTUDIANTES Educación Continua y Técnica</code></strong><a class="headerlink" href="#componente-tabla-temporal-dim_estudiantes-educacion-continua-y-tecnica" title="Permanent link">&para;</a></h3>
<p>El paquete SSIS <strong>"Tabla Temporal DIM_ESTUDIANTES Educación Continua y Técnica"</strong> se encarga de gestionar flujos ETL que permiten consolidar, transformar y cargar datos temporales relacionados con los estudiantes de Educación Continua y Técnica. Este paquete se utiliza para integrar, depurar y unificar información proveniente de diversas fuentes (Excel, bases de datos, etc.) en una tabla temporal que sirve de staging para procesos posteriores en el Data Warehouse. La solución abarca desde la actualización de datos de egresados, inasistencias, matrículas y registros de estudiantes hasta la ejecución de procesos adicionales para descargar información complementaria.</p>
<hr />
<h4 id="proposito-del-paquete_2">Propósito del Paquete<a class="headerlink" href="#proposito-del-paquete_2" title="Permanent link">&para;</a></h4>
<p>El objetivo principal del paquete es:</p>
<ul>
<li><strong>Consolidar y Unificar Datos Temporales:</strong> Recopilar información de estudiantes procedente de diversas fuentes (Excel, bases de datos, etc.) y depositarla en una tabla temporal para facilitar su procesamiento posterior.</li>
<li><strong>Depurar y Transformar Datos:</strong> Aplicar conversiones, derivaciones y validaciones sobre los datos leídos para garantizar su integridad y calidad.</li>
<li><strong>Integrar Fuentes Adicionales:</strong> Ejecutar procesos externos (scripts en Python) para descargar información complementaria (egresados, matrículas, preinscritos, etc.) que permita actualizar y enriquecer la tabla temporal.</li>
<li><strong>Limpiar el Staging Area:</strong> Truncar la tabla temporal al inicio del proceso para evitar la acumulación de registros obsoletos.</li>
</ul>
<hr />
<h4 id="descripcion-del-paquete_2">Descripción del Paquete<a class="headerlink" href="#descripcion-del-paquete_2" title="Permanent link">&para;</a></h4>
<p>El paquete se compone de varios componentes que realizan operaciones ETL específicas:</p>
<ol>
<li>
<p><strong>Actualizar Tabla Temporal Egresados</strong>  </p>
<ul>
<li><strong>Tipo:</strong> Data Flow Task  </li>
<li><strong>Funcionalidad:</strong> Extrae datos desde una hoja de Excel (Fuente: "Egresados") para actualizar la información de egresados en la tabla temporal.  </li>
<li><strong>Conexión:</strong> Utiliza un administrador de conexiones para Excel.</li>
</ul>
</li>
<li>
<p><strong>Actualizar Tabla Temporal Inasistencias</strong>  </p>
<ul>
<li><strong>Tipo:</strong> Data Flow Task  </li>
<li><strong>Funcionalidad:</strong> Procesa información de inasistencias extraída desde Excel, aplicando transformaciones y derivaciones para adecuar los campos (como DOCUMENTO, TIPO_DOCUMENTO, ESTUDIANTE) y luego carga los datos en la tabla temporal.  </li>
<li><strong>Componentes clave:</strong> Excel Source, Transformación de Columnas (Derived Column) y ADO.NET Destination.</li>
</ul>
</li>
<li>
<p><strong>Actualizar Tabla Temporal Matrículas</strong>  </p>
<ul>
<li><strong>Tipo:</strong> Data Flow Task  </li>
<li><strong>Funcionalidad:</strong> Extrae datos de matrículas desde Excel para actualizar la información en la tabla temporal, incluyendo campos como TIPO_DOCUMENTO, DOCUMENTO_ESTUDIANTE y NOMBRE_ESTUDIANTE.  </li>
<li><strong>Conexión:</strong> Se conecta a Excel mediante un administrador de conexiones específico.</li>
</ul>
</li>
<li>
<p><strong>Actualizar Tabla Temporal Matrículas Emp</strong>  </p>
<ul>
<li><strong>Tipo:</strong> Data Flow Task  </li>
<li><strong>Funcionalidad:</strong> Similar al componente anterior, pero orientado a consolidar datos de matrículas empresariales (Emp), utilizando información de una fuente Excel y cargando la información en la tabla temporal.</li>
</ul>
</li>
<li>
<p><strong>dim_Estudiantes py</strong>  </p>
<ul>
<li><strong>Tipo:</strong> Execute Process Task  </li>
<li><strong>Funcionalidad:</strong> Ejecuta un script de Python (<code>dim_Estudiantes.py</code>) que procesa y consolida los datos de estudiantes a nivel general, utilizando un ejecutable de Python configurado mediante variables de proyecto.  </li>
<li><strong>Directorio de trabajo:</strong> Se configura para ejecutarse en la carpeta de utilidades.</li>
</ul>
</li>
<li>
<p><strong>Fuentes Adicionales de Estudiantes</strong>  </p>
<ul>
<li><strong>Tipo:</strong> Contenedor de secuencias (Sequence)  </li>
<li><strong>Funcionalidad:</strong> Agrupa varios procesos externos para complementar la información de estudiantes. Entre ellos se encuentran:  </li>
<li><strong>Tarea cede_Egresados_Graduados:</strong> Ejecuta un script de Python para descargar información de egresados y graduados desde una fuente definida (probablemente SharePoint o similar).  </li>
<li><strong>Tarea cede_Listado_Matriculas:</strong> Ejecuta un script de Python para descargar un listado de matrículas.  </li>
<li><strong>Tarea emp_Consolidado_inasistencias:</strong> Ejecuta un script de Python para consolidar inasistencias a nivel empresarial.  </li>
<li><strong>Tarea emp_Egresados_Graduados:</strong> Ejecuta un script para procesar datos de egresados en el ámbito empresarial.  </li>
<li><strong>Tarea emp_Listado_Matriculas:</strong> Ejecuta un script para descargar información del listado de matrículas empresariales.  </li>
<li><strong>Tarea emp_Preinscritos:</strong> Ejecuta un script para procesar los  preinscritos.  </li>
<li><strong>Tarea fact_graduados py:</strong> Ejecuta un script que procesa la información de graduados.</li>
</ul>
</li>
<li>
<p><strong>Actualizar Tabla Temporal Inscripciones</strong>  </p>
<ul>
<li><strong>Tipo:</strong> Data Flow Task  </li>
<li><strong>Funcionalidad:</strong> Procesa y consolida los datos de inscripciones, extrayéndolos de Excel, aplicando transformaciones y cargándolos en la tabla temporal.</li>
</ul>
</li>
<li>
<p><strong>Limpiar Tabla Temporal</strong>  </p>
<ul>
<li><strong>Tipo:</strong> Execute SQL Task  </li>
<li><strong>Funcionalidad:</strong> Ejecuta una instrucción SQL para truncar la tabla temporal <code>TMP_ESTUDIANTES_CEDESARROLLO</code>, asegurando que el proceso ETL comience sin datos previos y evite la duplicidad de registros.</li>
</ul>
</li>
</ol>
<hr />
<h4 id="diagramas_2">Diagramas<a class="headerlink" href="#diagramas_2" title="Permanent link">&para;</a></h4>
<h5 id="diagrama-de-flujo-de-proceso-etl">Diagrama de Flujo de Proceso ETL<a class="headerlink" href="#diagrama-de-flujo-de-proceso-etl" title="Permanent link">&para;</a></h5>
<pre class="mermaid"><code>sequenceDiagram
    participant Egresados as Actualizar Tabla Temporal Egresados
    participant Inasistencias as Actualizar Tabla Temporal Inasistencias
    participant Matriculas as Actualizar Tabla Temporal Matrículas
    participant MatriculasEmp as Actualizar Tabla Temporal Matrículas Emp
    participant DimEstudiantes as dim_Estudiantes py
    participant FuentesAdic as Fuentes adicionales de Estudiantes
    participant Inscripciones as Actualizar Tabla Temporal Inscripciones
    participant Limpiar as Limpiar Tabla Temporal

    Egresados-&gt;&gt;Inasistencias: Proceso de consolidado de egresados y inasistencias
    Inasistencias-&gt;&gt;Matriculas: Integración de datos de inasistencias y matrículas
    Matriculas-&gt;&gt;MatriculasEmp: Consolidación de matrículas empresariales
    MatriculasEmp-&gt;&gt;DimEstudiantes: Complemento de datos de estudiantes
    DimEstudiantes-&gt;&gt;FuentesAdic: Ejecución de procesos adicionales
    FuentesAdic-&gt;&gt;Inscripciones: Unificación de datos de inscripciones
    Inscripciones-&gt;&gt;Limpiar: Truncado y limpieza de la tabla temporal</code></pre>
<h4 id="diagrama-de-precedencia">Diagrama de Precedencia<a class="headerlink" href="#diagrama-de-precedencia" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant DimEst as dim_Estudiantes py
    participant Fuentes as Fuentes adicionales de Estudiantes
    participant Matriculas as Actualizar Tabla Temporal Matrículas
    participant Inscripciones as Actualizar Tabla Temporal Inscripciones
    participant Limpiar as Limpiar Tabla Temporal

    DimEst-&gt;&gt;Fuentes: Ejecutar procesos adicionales (egresados, preinscritos, etc.)
    Fuentes-&gt;&gt;Matriculas: Consolidar listado de matrículas
    Matriculas-&gt;&gt;Inscripciones: Actualizar inscripciones
    Inscripciones-&gt;&gt;Limpiar: Finalizar proceso con limpieza de la tabla temporal</code></pre>
<hr />
<h4 id="componentes-clave-del-proceso">Componentes Clave del Proceso<a class="headerlink" href="#componentes-clave-del-proceso" title="Permanent link">&para;</a></h4>
<h5 id="1-consolidacion-y-actualizacion-de-datos-temporales">1. Consolidación y Actualización de Datos Temporales<a class="headerlink" href="#1-consolidacion-y-actualizacion-de-datos-temporales" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p><strong>Actualización de Datos de Egresados e Inasistencias:</strong><br />
  Se extraen datos de fuentes Excel y se transforman para consolidar la información de egresados e inasistencias. Estos datos se integran en la tabla temporal para su posterior análisis.</p>
</li>
<li>
<p><strong>Actualización de Matrículas e Inscripciones:</strong><br />
  Se procesan registros de matrículas e inscripciones a través de múltiples Data Flow Tasks, que incluyen conversiones de datos y transformaciones derivadas para unificar la información.</p>
</li>
</ul>
<h5 id="2-ejecucion-de-procesos-externos-con-python">2. Ejecución de Procesos Externos con Python<a class="headerlink" href="#2-ejecucion-de-procesos-externos-con-python" title="Permanent link">&para;</a></h5>
<ul>
<li>
<p><strong>dim_Estudiantes py:</strong><br />
  Ejecuta un script de Python para procesar datos generales de estudiantes, sirviendo como punto de partida para la consolidación.</p>
</li>
<li>
<p><strong>Fuentes Adicionales de Estudiantes:</strong><br />
  Contiene múltiples tareas de proceso que descargan y actualizan información complementaria, como egresados, listado de matrículas, preinscritos y datos consolidados empresariales.</p>
</li>
</ul>
<h5 id="3-limpieza-del-area-de-staging">3. Limpieza del Área de Staging<a class="headerlink" href="#3-limpieza-del-area-de-staging" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Limpiar Tabla Temporal:</strong><br />
  Una tarea de SQL se encarga de truncar la tabla temporal <code>TMP_ESTUDIANTES_CEDESARROLLO</code>, garantizando un entorno limpio para cada ejecución del proceso ETL.</li>
</ul>
<hr />
<h4 id="codigo-sql_2">Código SQL<a class="headerlink" href="#codigo-sql_2" title="Permanent link">&para;</a></h4>
<p>El siguiente código SQL se utiliza en la tarea de "Cargar Valores nulos por defecto para todos los esquemas" para inicializar las dimensiones con registros predeterminados:</p>
<div class="highlight"><pre><span></span><code><span class="n">USE</span><span class="w"> </span><span class="n">DWH_COMFENALCO</span><span class="p">;</span>
<span class="k">GO</span>
<span class="k">SET</span><span class="w"> </span><span class="n">ANSI_NULLS</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span>
<span class="k">GO</span>
<span class="k">SET</span><span class="w"> </span><span class="n">QUOTED_IDENTIFIER</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span>
<span class="k">GO</span>

<span class="c1">-- Eliminar restricciones de clave foránea en el esquema Transversal</span>
<span class="k">DECLARE</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="w"> </span><span class="n">NVARCHAR</span><span class="p">(</span><span class="k">MAX</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">;</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="s1">&#39;ALTER TABLE &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">QUOTENAME</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">QUOTENAME</span><span class="p">(</span><span class="n">t</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="w"> </span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; DROP CONSTRAINT &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">QUOTENAME</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">name</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;; &#39;</span><span class="w"> </span>
<span class="k">FROM</span><span class="w"> </span><span class="n">sys</span><span class="p">.</span><span class="n">foreign_keys</span><span class="w"> </span><span class="n">f</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">sys</span><span class="p">.</span><span class="n">tables</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">f</span><span class="p">.</span><span class="n">parent_object_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">object_id</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span><span class="w"> </span><span class="n">sys</span><span class="p">.</span><span class="n">schemas</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">t</span><span class="p">.</span><span class="n">schema_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">schema_id</span>
<span class="k">WHERE</span><span class="w"> </span><span class="n">s</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Transversal&#39;</span><span class="p">;</span>
<span class="k">EXEC</span><span class="w"> </span><span class="n">sp_executesql</span><span class="w"> </span><span class="o">@</span><span class="k">sql</span><span class="p">;</span>

<span class="c1">-- Truncar y cargar datos en DIM_UNIDAD</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_UNIDAD</span><span class="p">];</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_UNIDAD</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">UNIDAD</span><span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;EDUCACIÓN FORMAL&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;EDUCACIÓN TÉCNICA&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;EDUCACIÓN CONTINUA&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;PROTECCIÓN SOCIAL&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;SIN UNIDAD&#39;</span><span class="p">);</span>

<span class="c1">-- Truncar y cargar datos en DIM_INFRAESTRUCTURA_CCF</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_INFRAESTRUCTURA_CCF</span><span class="p">];</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_INFRAESTRUCTURA_CCF</span><span class="p">]</span><span class="w"> </span><span class="p">([</span><span class="n">COD_INFRAESTRUCTURA_CCF</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">DESCRIPCION</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">ID_UNIDAD</span><span class="p">])</span><span class="w"> </span><span class="k">VALUES</span>
<span class="p">(</span><span class="s1">&#39;-1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SinDato&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;CCF008-12-00001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Educación formal&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;CCF008-13-00001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Educación para el trabajo&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;CCF008-15-00001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Desarrollo empresarial&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;CCF008-26-00001&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Protección social&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>

<span class="c1">-- Truncar y cargar datos en DIM_CATEGORIA</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_CATEGORIA</span><span class="p">];</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_CATEGORIA</span><span class="p">]</span><span class="w"> </span><span class="p">([</span><span class="n">COD_CATEGORIA</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">DESCRIPCION</span><span class="p">])</span><span class="w"> </span><span class="k">VALUES</span>
<span class="p">(</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Categoría A&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Categoría B&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Categoría C&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Categoría D&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Empresas&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;6&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Fondos de Ley&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;10&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Convenios y Facultativos&#39;</span><span class="p">),</span>
<span class="p">(</span><span class="s1">&#39;12&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Empresa no afiliada&#39;</span><span class="p">);</span>

<span class="c1">-- Truncar y cargar datos en DIM_PERSONAL</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_PERSONAL</span><span class="p">];</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_PERSONAL</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_PERSONAL</span><span class="p">]</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">[</span><span class="n">ID_PERSONAL</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">COD_PERSONA_UNIDAD</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">ID_UNIDAD</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">SERVICIO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">NOMBRE</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">TELEFONO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">CELULAR</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">CORREO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">DIRECCION</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">CIUDAD</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">TIPO_DOCUMENTO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">DOCUMENTO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">FECHA_NACIMIENTO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">GENERO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">HORAS_CONTRATADAS_MENSUAL</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">HORAS_CONTRATADAS_TOTALES</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">VALOR_TOTAL</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">TIPO_CONTRATACION</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">FECHA_INICIO_CONTRATACION</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">FECHA_FIN_CONTRATACION</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">CAUSA_TERMINACION_CONTRATO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">PREGRADO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">POSGRADO_ESPECIALIDAD</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">POSGRADO_MAESTRIA</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">POSGRADO_DOCTORADO</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">NIVEL_INGLES</span><span class="p">],</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">AREA</span><span class="p">]</span>
<span class="p">)</span><span class="w"> </span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="s1">&#39;CC&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-1&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1900-01-01&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1900-01-01&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">    </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span>
<span class="p">);</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_PERSONAL</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span>

<span class="c1">-- Truncar y cargar datos en DIM_TARIFAS_SERVICIOS</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_TARIFAS_SERVICIOS</span><span class="p">];</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_TARIFAS_SERVICIOS</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_TARIFAS_SERVICIOS</span><span class="p">]</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">[</span><span class="n">ID_TARIFA</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">COD_SERVICIO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">CON_OBJETO_TARIFA</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">COS_UNITARIO_CONCEPTO</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">VAL_TARIFA</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">COD_CATEGORIA</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">ANIO_TARIFA</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">COD_INFRAESTRUCTURA_CCF</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;default object&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;3&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2024&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-1&#39;</span>
<span class="p">);</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_TARIFAS_SERVICIOS</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span>

<span class="c1">-- Truncar y cargar datos en DIM_PROGRAMA (Cedesarrollo)</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Cedesarrollo</span><span class="p">].[</span><span class="n">DIM_PROGRAMA</span><span class="p">];</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">Cedesarrollo</span><span class="p">].[</span><span class="n">DIM_PROGRAMA</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Cedesarrollo</span><span class="p">].[</span><span class="n">DIM_PROGRAMA</span><span class="p">]</span><span class="w"> </span><span class="p">([</span><span class="n">ID_PROGRAMA</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">PROGRAMA</span><span class="p">])</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Sin Programa&#39;</span><span class="p">);</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">Cedesarrollo</span><span class="p">].[</span><span class="n">DIM_PROGRAMA</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span>

<span class="c1">-- Truncar y cargar datos en DIM_PERIODO_ACADEMICO (Cedesarrollo)</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Cedesarrollo</span><span class="p">].[</span><span class="n">DIM_PERIODO_ACADEMICO</span><span class="p">];</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">Cedesarrollo</span><span class="p">].[</span><span class="n">DIM_PERIODO_ACADEMICO</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Cedesarrollo</span><span class="p">].[</span><span class="n">DIM_PERIODO_ACADEMICO</span><span class="p">]</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="p">[</span><span class="n">ID_PERIODO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">ID_UNIDAD</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">PERIODO_ACADEMICO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">FECHA_INICIO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">FECHA_FIN</span><span class="p">]</span>
<span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Sin datos&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span>
<span class="p">);</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">Cedesarrollo</span><span class="p">].[</span><span class="n">DIM_PERIODO_ACADEMICO</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span>

<span class="c1">-- Truncar e insertar registros en las tablas de Protección</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PROGRAMA</span><span class="p">];</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PROGRAMA</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PROGRAMA</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">ID_PROGRAMA</span><span class="p">,</span><span class="w"> </span><span class="n">PROGRAMA</span><span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ADULTO_MAYOR&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;DISCAPACIDAD&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;JEC&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;AIPI&#39;</span><span class="p">);</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PROGRAMA</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span>

<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PREGUNTAS_EE_JEC</span><span class="p">];</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PREGUNTAS_EE_JEC</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PREGUNTAS_EE_JEC</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">ID_PREGUNTA</span><span class="p">,</span><span class="w"> </span><span class="n">PREGUNTA</span><span class="p">,</span><span class="w"> </span><span class="n">ID_PROGRAMA</span><span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PREGUNTA_ABIERTA&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PREGUNTAS_EE_JEC</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span>

<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_RESPUESTAS_EE_JEC</span><span class="p">];</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_RESPUESTAS_EE_JEC</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_RESPUESTAS_EE_JEC</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">ID_RESPUESTA</span><span class="p">,</span><span class="w"> </span><span class="n">RESPUESTA</span><span class="p">,</span><span class="w"> </span><span class="n">ID_PREGUNTA</span><span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;RESPUESTA_PREGUNTA_ABIERTA&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_RESPUESTAS_EE_JEC</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span>

<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PREGUNTAS_EE_AIPI</span><span class="p">];</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PREGUNTAS_EE_AIPI</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PREGUNTAS_EE_AIPI</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">ID_PREGUNTA</span><span class="p">,</span><span class="w"> </span><span class="n">PREGUNTA</span><span class="p">,</span><span class="w"> </span><span class="n">ID_PROGRAMA</span><span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PREGUNTA_ABIERTA&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_PREGUNTAS_EE_AIPI</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span>

<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_RESPUESTAS_EE_AIPI</span><span class="p">];</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_RESPUESTAS_EE_AIPI</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_RESPUESTAS_EE_AIPI</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">ID_RESPUESTA</span><span class="p">,</span><span class="w"> </span><span class="n">RESPUESTA</span><span class="p">,</span><span class="w"> </span><span class="n">ID_PREGUNTA</span><span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;RESPUESTA_PREGUNTA_ABIERTA&#39;</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Proteccion</span><span class="p">].[</span><span class="n">DIM_RESPUESTAS_EE_AIPI</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span>

<span class="c1">-- Verificar e insertar registro en DIM_POBLACION_MATRICULA (Colegio)</span>
<span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="mi">1</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_POBLACION_MATRICULA</span><span class="p">]</span>
<span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="p">[</span><span class="n">ID_POBLACION_MATRICULA</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span>
<span class="p">)</span>
<span class="k">BEGIN</span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_POBLACION_MATRICULA</span><span class="p">]</span><span class="w"> </span><span class="k">ON</span><span class="p">;</span>
<span class="w">    </span><span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_POBLACION_MATRICULA</span><span class="p">]</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="p">[</span><span class="n">ID_POBLACION_MATRICULA</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">PARTNER</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">TIPO_DOCUMENTO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">DOCUMENTO</span><span class="p">],</span>
<span class="w">        </span><span class="p">[</span><span class="n">NOMBRE_COMPLETO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">GENERO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">DIRECCION</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">TELEFONO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">CORREO</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="n">FECHA_NACIMIENTO</span><span class="p">]</span>
<span class="w">    </span><span class="p">)</span>
<span class="w">    </span><span class="k">VALUES</span><span class="w"> </span><span class="p">(</span>
<span class="w">        </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Estudiantes sin cruce&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">NULL</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">    </span><span class="k">SET</span><span class="w"> </span><span class="n">IDENTITY_INSERT</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Colegio</span><span class="p">].[</span><span class="n">DIM_POBLACION_MATRICULA</span><span class="p">]</span><span class="w"> </span><span class="k">OFF</span><span class="p">;</span>
<span class="k">END</span><span class="p">;</span>
<span class="k">GO</span>
</code></pre></div>
<h3 id="componende-agregar-registros-con-id-1-para-tablas-de-poblacion">Componende <strong><code>Agregar registros con ID -1 para tablas de población</code></strong><a class="headerlink" href="#componende-agregar-registros-con-id-1-para-tablas-de-poblacion" title="Permanent link">&para;</a></h3>
<h4 id="descripcion">Descripción<a class="headerlink" href="#descripcion" title="Permanent link">&para;</a></h4>
<p>Este proceso en la solución SSIS se encarga de agregar registros con el ID <code>-1</code> en las tablas de población. Este ID se utiliza para representar datos genéricos o no disponibles en las tablas de destino.</p>
<h4 id="detalles-del-proceso">Detalles del Proceso<a class="headerlink" href="#detalles-del-proceso" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>Truncar Tabla</strong>: Se ejecuta una instrucción SQL para truncar las tablas de población, eliminando todos los registros existentes.</li>
<li><strong>Insertar Datos</strong>: Se ejecuta una instrucción SQL para insertar nuevos registros en las tablas de población con el ID <code>-1</code>.</li>
</ol>
<h4 id="diagrama-de-secuencia-del-proceso-etl_4">Diagrama de Secuencia del Proceso ETL<a class="headerlink" href="#diagrama-de-secuencia-del-proceso-etl_4" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    title Diagrama de Secuencia del Proceso ETL - Agregar registros con ID -1 para tablas de población
    autonumber
    participant SSIS as Tarea SSIS
    participant SQL as Script SQL
    participant DWH as Data Warehouse

    SSIS-&gt;&gt;SQL: Ejecutar truncado de tablas de población
    SQL--&gt;&gt;SSIS: Confirmación de truncado
    SSIS-&gt;&gt;SQL: Insertar registros con ID -1 en tablas de población
    SQL--&gt;&gt;SSIS: Confirmación de inserción</code></pre>
<h4 id="codigo-sql_3">Código SQL<a class="headerlink" href="#codigo-sql_3" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">-- Truncar tablas de población</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_POBLACION</span><span class="p">];</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_ESTABLECIMIENTO_EDUCATIVO</span><span class="p">];</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_PROGRAMA</span><span class="p">];</span>
<span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">DWH_COMFENALCO</span><span class="p">].[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_CAMPOS_CARACT</span><span class="p">];</span>

<span class="c1">-- Insertar registros con ID -1</span>
<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_POBLACION</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">ID_POBLACION</span><span class="p">,</span><span class="w"> </span><span class="n">TIPO_DOCUMENTO</span><span class="p">,</span><span class="w"> </span><span class="n">DOCUMENTO</span><span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">);</span>

<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_ESTABLECIMIENTO_EDUCATIVO</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">ID_ESTABLECIMIENTO_EDUCATIVO</span><span class="p">,</span><span class="w"> </span><span class="n">NOMBRE_ESTABLECIMIENTO</span><span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">);</span>

<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_PROGRAMA</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">ID_PROGRAMA</span><span class="p">,</span><span class="w"> </span><span class="n">PROGRAMA</span><span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">);</span>

<span class="k">INSERT</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_CAMPOS_CARACT</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="n">ID_PREGUNTA</span><span class="p">,</span><span class="w"> </span><span class="n">PREGUNTA</span><span class="p">)</span>
<span class="k">VALUES</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;N/A&#39;</span><span class="p">);</span>
</code></pre></div>
<h3 id="componente-vaciar-tabla-temporal-de-poblacion-educacion">Componente <strong><code>Vaciar tabla temporal de Poblacion Educacion</code></strong><a class="headerlink" href="#componente-vaciar-tabla-temporal-de-poblacion-educacion" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_8">Descripción General<a class="headerlink" href="#descripcion-general_8" title="Permanent link">&para;</a></h4>
<p>La tarea <code>Vaciar tabla temporal de Poblacion Educacion</code> es una tarea de ejecución de SQL en un paquete SSIS que se encarga de vaciar la tabla temporal <code>TMP_POBLACION_EDUCACION</code> en el Data Warehouse. Esta tarea realiza una operación de truncado en la tabla correspondiente.</p>
<h4 id="detalles-de-la-tarea_1">Detalles de la Tarea<a class="headerlink" href="#detalles-de-la-tarea_1" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>ID de la Tarea</strong>: <code>{C1C8514E-6B9D-448B-B2C4-085047066756}</code></li>
<li><strong>Tipo de Tarea</strong>: <code>Microsoft.ExecuteSQLTask</code></li>
<li><strong>Descripción</strong>: Tarea Ejecutar SQL</li>
<li><strong>Conexión</strong>: <code>{878C9AA8-681C-4799-9C30-34C49CD01857}</code></li>
<li><strong>Declaración SQL</strong>:<ul>
<li>Truncar la tabla <code>TMP_POBLACION_EDUCACION</code> en el esquema <code>Transversal</code>.</li>
</ul>
</li>
</ul>
<h4 id="diagrama-de-secuencia-del-proceso-etl_5">Diagrama de Secuencia del Proceso ETL<a class="headerlink" href="#diagrama-de-secuencia-del-proceso-etl_5" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
  title Diagrama de Secuencia del Proceso ETL de Vaciar tabla temporal de Poblacion Educacion
  autonumber
  participant SSIS as Tarea SSIS
  participant SQL as Script SQL
  participant DWH as Data Warehouse

  SSIS-&gt;&gt;SQL: Ejecutar truncado de tabla TMP_POBLACION_EDUCACION
  SQL--&gt;&gt;SSIS: Confirmación de truncado</code></pre>
<h4 id="codigo-sql_4">Código SQL<a class="headerlink" href="#codigo-sql_4" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="k">TRUNCATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">TMP_POBLACION_EDUCACION</span><span class="p">];</span>
</code></pre></div>
<h3 id="componente-procesar-poblacion-prs">Componente <strong><code>Procesar Poblacion PRS</code></strong><a class="headerlink" href="#componente-procesar-poblacion-prs" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_9">Descripción General<a class="headerlink" href="#descripcion-general_9" title="Permanent link">&para;</a></h4>
<p>La tarea <code>Procesar Poblacion PRS</code> es una tarea de ejecución de proceso en un paquete SSIS que se encarga de ejecutar un script Python para procesar la población PRS. Esta tarea utiliza el ejecutable de Python y un script específico para realizar el procesamiento.</p>
<h4 id="detalles-de-la-tarea_2">Detalles de la Tarea<a class="headerlink" href="#detalles-de-la-tarea_2" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>ID de la Tarea</strong>: <code>{7f11d36d-f826-44f0-8b89-e04825763509}</code></li>
<li><strong>Tipo de Tarea</strong>: <code>Microsoft.ExecuteProcess</code></li>
<li><strong>Descripción</strong>: Tarea Ejecutar proceso</li>
<li><strong>Conexión</strong>: No aplica (ejecución de proceso)</li>
<li><strong>Propiedades del Componente</strong>:<ul>
<li><strong>Executable</strong>: <code>@[$Project::Working_Directory]+"COMFENALCO_EDUCACION\\01.Scripts\\Utils\\env\\Scripts\\python.exe"</code></li>
<li><strong>WorkingDirectory</strong>: <code>@[$Project::Working_Directory]+"COMFENALCO_EDUCACION\\01.Scripts\\03.Archivos_Manuales\\01.Transversal"</code></li>
</ul>
</li>
</ul>
<h4 id="detalles-de-la-ejecucion_3">Detalles de la Ejecución<a class="headerlink" href="#detalles-de-la-ejecucion_3" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Executable</strong>: <code>\COMFENALCO_EDUCACION\01.Scripts\Utils\env\Scripts\python.exe</code></li>
<li><strong>Arguments</strong>: <code>03.PoblacionProteccion.py</code></li>
<li><strong>WorkingDirectory</strong>: <code>\COMFENALCO_EDUCACION\01.Scripts\03.Archivos_Manuales\01.Transversal</code></li>
</ul>
<h4 id="diagrama-de-secuencia-del-proceso-etl_6">Diagrama de Secuencia del Proceso ETL<a class="headerlink" href="#diagrama-de-secuencia-del-proceso-etl_6" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
  title Diagrama de Secuencia del Proceso ETL de Procesar Poblacion PRS
  autonumber
  participant SSIS as Tarea SSIS
  participant Python as Script Python
  participant FileSystem as Sistema de Archivos

  SSIS-&gt;&gt;Python: Ejecutar script 03.PoblacionProteccion.py
  Python--&gt;&gt;FileSystem: Leer y procesar datos
  FileSystem--&gt;&gt;Python: Datos procesados
  Python--&gt;&gt;SSIS: Confirmación de ejecución</code></pre>
<h3 id="componente-identificar-poblacion-educacion">Componente <strong><code>Identificar Poblacion Educación</code></strong><a class="headerlink" href="#componente-identificar-poblacion-educacion" title="Permanent link">&para;</a></h3>
<p>El paquete SSIS <strong>"Identificar Población Educación"</strong> está diseñado para procesar y cargar datos relacionados con la población educativa. Este proceso ETL consolida información proveniente de diversas fuentes, como bases de datos y archivos Excel, para generar un conjunto de datos limpio y estandarizado en el área de staging. La solución permite identificar y unir registros de estudiantes utilizando transformaciones, conversiones y búsquedas, facilitando la integración y análisis de la información en el Data Warehouse.</p>
<hr />
<h4 id="proposito-del-paquete_3">Propósito del Paquete<a class="headerlink" href="#proposito-del-paquete_3" title="Permanent link">&para;</a></h4>
<p>El objetivo principal del paquete es:</p>
<ul>
<li><strong>Extraer y Unificar Datos:</strong> Recopilar información sobre la población educativa desde distintas fuentes (por ejemplo, registros de inscripciones en el colegio y datos adicionales en archivos Excel).</li>
<li><strong>Transformar y Estandarizar Información:</strong> Aplicar conversiones de datos y crear columnas derivadas para asegurar la consistencia y calidad de la información.</li>
<li><strong>Realizar Búsquedas y Combinar Datos:</strong> Utilizar transformaciones de Lookup y Merge para integrar y asociar datos provenientes de diferentes orígenes.</li>
<li><strong>Cargar la Información en el Área de Staging:</strong> Depositar los datos consolidados en la tabla temporal <code>TMP_POBLACION_EDUCACION</code> para su uso posterior en el Data Warehouse.</li>
</ul>
<hr />
<h4 id="descripcion-del-paquete_3">Descripción del Paquete<a class="headerlink" href="#descripcion-del-paquete_3" title="Permanent link">&para;</a></h4>
<p>El proceso ETL de "Identificar Población Educación" se compone de varios pasos:</p>
<ol>
<li>
<p><strong>Extracción de Datos:</strong></p>
<ul>
<li>Se obtienen datos de dos fuentes principales:</li>
<li><strong>Origen de ADO NET:</strong> Extrae datos de la tabla <code>DIM_POBLACION_MATRICULA</code> del colegio, obteniendo columnas como <code>TIPO_DOCUMENTO</code> y <code>DOCUMENTO</code>.</li>
<li><strong>Población PRS:</strong> Extrae información desde un archivo Excel para complementar los datos de población.</li>
</ul>
</li>
<li>
<p><strong>Transformación y Conversión:</strong></p>
<ul>
<li><strong>Data Conversion:</strong> Se aplican dos transformaciones de datos para convertir los tipos de datos de las columnas de entrada (por ejemplo, <code>TIPO_DOCUMENTO</code> y <code>DOCUMENTO</code>) y generar versiones copiadas con longitudes y formatos requeridos.</li>
<li><strong>Derived Column:</strong> Se utiliza para crear una nueva columna (como la conversión o ajuste de valores nulos) mediante expresiones que aplican funciones como REPLACENULL.</li>
</ul>
</li>
<li>
<p><strong>Unión y Combinación de Datos:</strong></p>
<ul>
<li><strong>Lookup:</strong> Se utiliza para buscar y unir información adicional de la tabla de referencia <code>DIM_TIPO_DOCUMENTO</code>, asignando identificadores como <code>ID_TIPODOC_AFILIADO</code> y las siglas correspondientes.</li>
<li><strong>Merge:</strong> Se combinan los datos provenientes de la fuente de ADO NET y de la fuente Excel (Población PRS) para unificar la información en un flujo ordenado.</li>
<li><strong>Sort:</strong> Se aplican transformaciones de ordenación para asegurar que los flujos de datos estén correctamente ordenados antes de ser combinados.</li>
</ul>
</li>
<li>
<p><strong>Carga en el Área de Staging:</strong></p>
<ul>
<li>Los datos resultantes se cargan en la tabla temporal <code>TMP_POBLACION_EDUCACION</code> del esquema Transversal, utilizando un destino ADO NET.</li>
<li>Además, se envían registros erróneos a un archivo plano para su revisión y  depuración.</li>
</ul>
</li>
</ol>
<hr />
<h4 id="componentes-clave-del-proceso_1">Componentes Clave del Proceso<a class="headerlink" href="#componentes-clave-del-proceso_1" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Data Conversion y Data Conversion 1:</strong><br />
   Se utilizan para convertir y formatear las columnas <code>TIPO_DOCUMENTO</code> y <code>DOCUMENTO</code> de las fuentes de datos. La primera transformación opera sobre datos provenientes de un flujo combinado (Merge Output), y la segunda se encarga de convertir datos extraídos directamente del origen ADO NET.</p>
</li>
<li>
<p><strong>Derived Column:</strong><br />
   Crea nuevas columnas a partir de las existentes, aplicando funciones que aseguran que los valores nulos se reemplacen por valores por defecto (por ejemplo, utilizando la función REPLACENULL).</p>
</li>
<li>
<p><strong>Lookup:</strong><br />
   Realiza una búsqueda en la tabla de referencia <code>DIM_TIPO_DOCUMENTO</code> para asociar a cada registro el <code>ID_TIPODOC_AFILIADO</code> correspondiente, basándose en el valor convertido de <code>TIPO_DOCUMENTO</code>.</p>
</li>
<li>
<p><strong>Merge y Sort:</strong><br />
   Se utilizan transformaciones de ordenación y fusión para combinar los datos de las diferentes fuentes (origen ADO NET y Excel) en un flujo único, asegurando la integridad del ordenamiento para la posterior unión.</p>
</li>
<li>
<p><strong>Origen de ADO NET (Estudiantes Colegio):</strong><br />
   Extrae los datos clave de la población educativa directamente de la base de datos del colegio, sirviendo de referencia principal para la identificación de registros.</p>
</li>
<li>
<p><strong>Flat File Destination:</strong><br />
   Permite la escritura de los registros que generen errores durante las transformaciones, facilitando la auditoría y depuración de la información.</p>
</li>
<li>
<p><strong>Población Educación (Stage Area):</strong><br />
   Carga el flujo de datos resultante en la tabla temporal <code>TMP_POBLACION_EDUCACION</code>, que servirá de base para los procesos posteriores de integración en el Data Warehouse.</p>
</li>
</ol>
<hr />
<h4 id="diagramas_3">Diagramas<a class="headerlink" href="#diagramas_3" title="Permanent link">&para;</a></h4>
<h5 id="diagrama-de-flujo-de-datos_1">Diagrama de Flujo de Datos<a class="headerlink" href="#diagrama-de-flujo-de-datos_1" title="Permanent link">&para;</a></h5>
<pre class="mermaid"><code>sequenceDiagram
    participant ADO as Origen de ADO NET
    participant Excel as Población PRS
    participant DC as Data Conversion
    participant DC1 as Data Conversion 1
    participant DerCol as Derived Column
    participant Lookup as Lookup
    participant Sort as Sort
    participant Sort1 as Sort 1
    participant Sort2 as Sort 2
    participant Merge as Merge
    participant Merge1 as Merge 1
    participant Stage as Poblacion Educacion (Stage Area)
    participant Flat as Flat File Destination

    ADO-&gt;&gt;DC1: Extraer datos de DIM_POBLACION_MATRICULA
    Excel-&gt;&gt;Sort2: Extraer datos desde Excel
    DC-&gt;&gt;Lookup: Convertir y formatear columnas (TIPO_DOCUMENTO, DOCUMENTO)
    DC1-&gt;&gt;Sort1: Convertir datos del origen ADO NET
    Sort1-&gt;&gt;Merge: Ordenar datos del origen ADO NET
    Sort2-&gt;&gt;Merge1: Ordenar datos de Excel
    Merge-&gt;&gt;Merge1: Fusionar flujos ordenados
    Merge1-&gt;&gt;DerCol: Aplicar columna derivada para reemplazar nulos
    DerCol-&gt;&gt;Stage: Cargar datos en TMP_POBLACION_EDUCACION
    DC-&gt;&gt;Flat: Enviar filas con error a archivo plano</code></pre>
<h5 id="diagrama-de-precedencia_1">Diagrama de Precedencia<a class="headerlink" href="#diagrama-de-precedencia_1" title="Permanent link">&para;</a></h5>
<pre class="mermaid"><code>sequenceDiagram
    participant ADO as Estudiantes Colegio (Origen ADO NET)
    participant Excel as Población PRS (Excel)
    participant Conv as Data Conversion
    participant Conv1 as Data Conversion 1
    participant Look as Lookup
    participant M1 as Merge 1
    participant Flat as Flat File Destination
    participant Stage as Poblacion Educacion (Stage Area)

    ADO-&gt;&gt;Conv1: Extraer y convertir datos del origen ADO NET
    Excel-&gt;&gt;Conv: Extraer y convertir datos de Excel
    Conv-&gt;&gt;Look: Enviar datos convertidos al Lookup
    Look-&gt;&gt;M1: Combinar datos mediante Merge
    M1-&gt;&gt;Stage: Cargar datos consolidados en el área de staging
    Conv-&gt;&gt;Flat: Redirigir registros con error a archivo plano</code></pre>
<h3 id="componente-procesar-dim_beneficiarios">Componente <strong><code>Procesar DIM_BENEFICIARIOS</code></strong><a class="headerlink" href="#componente-procesar-dim_beneficiarios" title="Permanent link">&para;</a></h3>
<p>El paquete SSIS <strong>"Procesar DIM_BENEFICIARIOS"</strong> se encarga de la extracción, transformación y carga (ETL) de datos relacionados con los beneficiarios en el Data Warehouse. Este proceso se centra en consolidar y actualizar la dimensión de beneficiarios en el esquema Transversal, asegurando que la información sea precisa y esté estandarizada para su análisis y toma de decisiones.</p>
<hr />
<h4 id="proposito-del-paquete_4">Propósito del Paquete<a class="headerlink" href="#proposito-del-paquete_4" title="Permanent link">&para;</a></h4>
<p>El objetivo principal del proceso es:</p>
<ul>
<li><strong>Extraer y Unificar Datos:</strong> Recopilar información sobre beneficiarios desde diversas fuentes, incluyendo datos provenientes del área de staging donde se almacenan los registros temporales.</li>
<li><strong>Transformar y Estandarizar la Información:</strong> Aplicar conversiones de datos y transformar los valores para garantizar la consistencia de la dimensión, incluyendo el formateo de tipos de datos y la integración de identificadores clave.</li>
<li><strong>Cargar la Información en la Dimensión:</strong> Insertar o actualizar los registros en la tabla <code>DIM_BENEFICIARIOS</code> dentro del esquema Transversal, asegurando la integridad y calidad de los datos.</li>
<li><strong>Manejar Errores:</strong> Redirigir cualquier fila que genere error durante la transformación a un destino de error para su posterior análisis y depuración.</li>
</ul>
<hr />
<h4 id="descripcion-del-proceso_2">Descripción del Proceso<a class="headerlink" href="#descripcion-del-proceso_2" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Extracción de Datos:</strong></p>
<ul>
<li><strong>Origen de Datos Temporal:</strong> Se extraen datos desde la tabla temporal en el área de staging (<code>TMP POBLACION EDUCACION</code>), la cual contiene registros de beneficiarios identificados a partir de procesos previos.</li>
<li><strong>Origen de Datos Adicional:</strong> Se utiliza el componente "Estudiantes Colegio" para obtener información complementaria desde la base de datos del colegio, la cual incluye columnas clave como <code>TIPO_DOCUMENTO</code> y <code>DOCUMENTO</code>.</li>
</ul>
</li>
<li>
<p><strong>Transformación de Datos:</strong></p>
<ul>
<li><strong>Conversión de Datos:</strong><br />
 Se aplican dos transformaciones de Data Conversion para convertir los valores de columnas críticas (por ejemplo, <code>TIPO_DOCUMENTO</code> y <code>DOCUMENTO</code>) al formato y longitud requeridos.  </li>
<li>La primera transformación crea copias de las columnas con la longitud adecuada para facilitar las operaciones de Lookup y Merge.</li>
<li>
<p>La segunda transformación, aplicada directamente sobre el flujo de datos extraído, garantiza que los datos sean consistentes.</p>
</li>
<li>
<p><strong>Lookup:</strong><br />
 Se utiliza una transformación Lookup para unir los datos del flujo con la tabla de referencia <code>DIM_TIPO_DOCUMENTO</code>. Esta unión permite asignar a cada registro el <code>ID_TIPODOC_AFILIADO</code> y las siglas correspondientes a partir de la columna <code>COD_TIPO_DOCUMENTO</code>, facilitando la identificación y categorización de los beneficiarios.</p>
</li>
<li>
<p><strong>Fusión (Merge):</strong><br />
 Las transformaciones Sort y Merge se utilizan para combinar y ordenar los registros provenientes de las diversas fuentes. Este paso asegura que el flujo final de datos esté correctamente ordenado y listo para la carga.</p>
</li>
</ul>
</li>
<li>
<p><strong>Carga de Datos en la Dimensión:</strong></p>
<ul>
<li>
<p><strong>Destino ADO.NET:</strong><br />
 Los datos transformados se cargan en la tabla <code>DIM_BENEFICIARIOS</code> ubicada en el esquema Transversal del Data Warehouse. La configuración del destino ADO.NET permite la inserción masiva, optimizando el rendimiento del proceso.</p>
</li>
<li>
<p><strong>Manejo de Errores:</strong><br />
 Se definen salidas de error que capturan cualquier fila que no cumpla con las conversiones o validaciones establecidas, permitiendo que los errores sean redirigidos a un destino específico para su análisis.</p>
</li>
</ul>
</li>
<li>
<p><strong>Integración Final:</strong></p>
<ul>
<li>Los registros actualizados y/o nuevos se integran en la dimensión <code>DIM_BENEFICIARIOS</code>, lo cual facilita la realización de análisis sobre la población de beneficiarios y su impacto en las operaciones de la organización.</li>
</ul>
</li>
</ol>
<hr />
<h4 id="componentes-clave-del-proceso_2">Componentes Clave del Proceso<a class="headerlink" href="#componentes-clave-del-proceso_2" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Destino de ADO NET:</strong><br />
   Utiliza un componente ADO.NET para cargar los datos finales en la tabla <code>"Transversal"."DIM_BENEFICIARIOS"</code>, configurado con propiedades que optimizan la inserción masiva (BatchSize = 0, CommandTimeout = 30, UseBulkInsertWhenPossible = true).</p>
</li>
<li>
<p><strong>Transformaciones de Data Conversion:</strong><br />
   Dos transformaciones de Data Conversion se aplican para asegurar que las columnas <code>TIPO_DOCUMENTO</code> y <code>DOCUMENTO</code> tengan el formato correcto para su posterior procesamiento. La primera transformación trabaja sobre datos combinados, mientras que la segunda opera sobre datos provenientes directamente del origen.</p>
</li>
<li>
<p><strong>Transformación Lookup:</strong><br />
   Realiza la unión entre el flujo de datos y la tabla de referencia <code>DIM_TIPO_DOCUMENTO</code>, permitiendo obtener el <code>ID_TIPODOC_AFILIADO</code> y las siglas de tipo de documento para cada registro.</p>
</li>
<li>
<p><strong>Componentes de Sort y Merge:</strong><br />
   Se utilizan para ordenar y combinar registros provenientes de diferentes orígenes, asegurando que la fusión de datos se realice de forma coherente y ordenada.</p>
</li>
<li>
<p><strong>Origen de ADO NET (TMP POBLACION EDUCACION):</strong><br />
   Extrae los datos de la tabla temporal donde se consolidaron previamente los registros de beneficiarios, sirviendo de base para identificar los registros nuevos o faltantes en la dimensión.</p>
</li>
<li>
<p><strong>Destino de Error:</strong><br />
   Los errores detectados durante la conversión y transformación se redirigen a una salida de error, permitiendo su revisión y corrección sin interrumpir el proceso principal.</p>
</li>
</ol>
<h4 id="diagramas_4">Diagramas<a class="headerlink" href="#diagramas_4" title="Permanent link">&para;</a></h4>
<h5 id="diagrama-de-flujo-de-datos_2">Diagrama de Flujo de Datos<a class="headerlink" href="#diagrama-de-flujo-de-datos_2" title="Permanent link">&para;</a></h5>
<pre class="mermaid"><code>sequenceDiagram
    participant TMP as TMP POBLACION EDUCACION (Origen)
    participant ADO as Estudiantes Colegio (Origen ADO NET)
    participant DC as Data Conversion
    participant DC1 as Data Conversion 1
    participant Lookup as Lookup
    participant Sort as Sort
    participant Sort1 as Sort 1
    participant Sort2 as Sort 2
    participant Merge as Merge
    participant Stage as Destino de ADO NET (DIM_BENEFICIARIOS)
    participant Error as Salida de error de destino de ADO NET

    TMP-&gt;&gt;DC1: Extrae datos de TMP POBLACION EDUCACION
    ADO-&gt;&gt;DC: Extrae datos de Estudiantes Colegio
    DC-&gt;&gt;Lookup: Convierte y formatea columnas (TIPO_DOCUMENTO, DOCUMENTO)
    DC1-&gt;&gt;Sort1: Convierte datos del origen TMP
    Sort1-&gt;&gt;Merge: Ordena datos del origen TMP
    Sort2-&gt;&gt;Merge: Ordena datos de Excel (Población PRS)
    Merge-&gt;&gt;Lookup: Combina flujos de datos para Lookup
    Lookup-&gt;&gt;Stage: Carga datos en DIM_BENEFICIARIOS
    DC-&gt;&gt;Error: Redirige filas con errores</code></pre>
<h5 id="diagrama-de-precedencia_2">Diagrama de Precedencia<a class="headerlink" href="#diagrama-de-precedencia_2" title="Permanent link">&para;</a></h5>
<pre class="mermaid"><code>sequenceDiagram
    participant Origen as TMP POBLACION EDUCACION
    participant ADO as Estudiantes Colegio
    participant Conv as Data Conversion
    participant Look as Lookup
    participant Merge as Merge
    participant Destino as Destino de ADO NET (DIM_BENEFICIARIOS)

    Origen-&gt;&gt;Conv: Extraer y convertir datos desde TMP
    ADO-&gt;&gt;Conv: Extraer datos complementarios desde ADO NET
    Conv-&gt;&gt;Look: Enviar datos convertidos al Lookup
    Look-&gt;&gt;Merge: Unir datos con referencia de DIM_TIPO_DOCUMENTO
    Merge-&gt;&gt;Destino: Cargar registros consolidados en DIM_BENEFICIARIOS</code></pre>
<h3 id="componente-procesar-dim_beneficiarios-por-bp">Componente <strong><code>Procesar DIM_BENEFICIARIOS por BP</code></strong><a class="headerlink" href="#componente-procesar-dim_beneficiarios-por-bp" title="Permanent link">&para;</a></h3>
<p>Este flujo de datos de SSIS se encarga de extraer y procesar información de la población de matrícula del Colegio para identificar beneficiarios asociados a un determinado “BP” (Business Partner). El objetivo es detectar registros nuevos que no se encuentren en la dimensión de beneficiarios transversal y, a partir de esa comparación, enriquecer la información utilizando datos de las áreas de Aportes y Afiliados.</p>
<hr />
<h4 id="proposito-del-flujo">Propósito del Flujo<a class="headerlink" href="#proposito-del-flujo" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong>Identificar Beneficiarios Nuevos:</strong><br />
  Se extraen los registros de la población de matrícula del Colegio y se comparan con la dimensión de beneficiarios existente. Se identifican aquellos registros que aún no han sido cargados en la dimensión.</p>
</li>
<li>
<p><strong>Integrar Información de Aportes:</strong><br />
  Se realiza una unión con los datos provenientes de la dimensión de beneficiarios del área de Aportes (DIM_BENEFICIARIOS de Aportes) y la información de afiliados para complementar la información del beneficiario.</p>
</li>
<li>
<p><strong>Cargar la Dimensión Transversal:</strong><br />
  Finalmente, se cargan los registros resultantes en la dimensión de beneficiarios del esquema Transversal, asegurando la actualización y consistencia de la información.</p>
</li>
</ul>
<hr />
<h4 id="descripcion-del-proceso_3">Descripción del Proceso<a class="headerlink" href="#descripcion-del-proceso_3" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>Extracción de Datos – Origen DIM POBLACION MATRICULA Colegio:</strong><br />
   Se utiliza un componente de origen ADO.NET que ejecuta una consulta SQL con múltiples CTEs (Common Table Expressions).  <ul>
<li><strong>CTE PobMatricula:</strong> Extrae la columna <code>PARTNER</code> desde la tabla <code>[DIM_POBLACION_MATRICULA]</code> del Colegio.  </li>
<li><strong>CTE Beneficiarios:</strong> Extrae todos los registros existentes en la dimensión de beneficiarios transversal.  </li>
<li><strong>CTE BenNuevos:</strong> Selecciona los registros de la población de matrícula que no tienen correspondencia en la dimensión de beneficiarios.  </li>
<li><strong>CTEs BENEFICIARIOS2 y AFILIADOS:</strong> Extraen información desde las dimensiones de Aportes y Afiliados, respectivamente, considerando únicamente registros activos (con <code>ESTADOREGISTRO = 'CURRENT'</code> y condiciones específicas en <code>TIPO_APORTANTE</code> y <code>EMPRESA_PRINCIPAL</code>).  </li>
<li><strong>CTE LastLookUp:</strong> Realiza la unión entre la información de Aportes y Afiliados para obtener los registros completos de beneficiarios.</li>
</ul>
</li>
</ol>
<p>La consulta final realiza una unión (LEFT JOIN) entre los registros identificados como nuevos y la información consolidada en LastLookUp, filtrando aquellos que tengan un <code>ID_BENEFICIARIO</code> válido.</p>
<ol>
<li>
<p><strong>Salida del Origen:</strong><br />
   Los datos extraídos contienen columnas clave como:</p>
<ul>
<li><code>ID_BENEFICIARIO</code></li>
<li><code>PARTNER</code></li>
<li><code>TITULAR</code></li>
<li><code>ID_TIPO_DOCUMENTO</code></li>
<li><code>COD_TIPO_DOCUMENTO</code></li>
<li><code>TIPO_DOCUMENTO</code></li>
<li><code>NUMERO_DOCUMENTO</code></li>
<li><code>NOMBRE_COMPLETO</code></li>
<li><code>PRIMER_APELLIDO</code></li>
<li><code>SEGUNDO_APELLIDO</code></li>
<li><code>PRIMER_NOMBRE</code></li>
<li><code>SEGUNDO_NOMBRE</code></li>
<li><code>ID_PARENTESCO</code></li>
<li><code>PARENTESCO</code></li>
<li><code>FECHA_AFILIACION</code></li>
<li><code>FECHA_RETIRO</code></li>
<li><code>ID_GENERO</code></li>
<li><code>GENERO</code></li>
<li><code>ID_NIVEL_EDUCATIVO</code></li>
<li><code>NIVEL_EDUCATIVO</code></li>
<li><code>ID_ESTADO_CIVIL</code></li>
<li><code>ESTADO_CIVIL</code></li>
<li><code>DISCAPACIDAD</code></li>
<li><code>FECHA_NACIMIENTO</code></li>
<li><code>DIRECCION</code></li>
<li><code>TELEFONO</code></li>
<li><code>BARRIO</code></li>
<li><code>ESTRATO</code></li>
<li><code>ID_CIUDAD</code></li>
<li><code>ID_AREA_GEOGRAFICA</code></li>
<li><code>AREA_GEOGRAFICA</code></li>
<li><code>FEC_CREACION</code></li>
<li><code>USUARIO_PROCESO</code></li>
<li><code>FEC_ACTUALIZACION</code></li>
</ul>
</li>
<li>
<p><strong>Carga en la Dimensión – DIM_BENEFICIARIOS Transversal:</strong><br />
   Los datos procesados se envían al destino ADO.NET configurado para insertar (o actualizar) los registros en la tabla <code>"Transversal"."DIM_BENEFICIARIOS"</code>. Se utilizan configuraciones que optimizan la inserción masiva (BatchSize = 0, CommandTimeout = 30, UseBulkInsertWhenPossible = true).</p>
</li>
<li>
<p><strong>Manejo de Errores:</strong><br />
   Cualquier fila que genere error en el proceso de carga se redirige a una salida de error para su posterior análisis, asegurando que el flujo principal no se detenga por datos inválidos.</p>
</li>
</ol>
<hr />
<h4 id="diagrama-de-flujo-de-datos_3">Diagrama de Flujo de Datos<a class="headerlink" href="#diagrama-de-flujo-de-datos_3" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    participant Origen as DIM POBLACION MATRICULA Colegio (Origen ADO.NET)
    participant Transform as Proceso SQL con CTEs (BenNuevos, LastLookUp)
    participant Salida as Salida de Origen de ADO.NET
    participant Destino as DIM_BENEFICIARIOS Transversal (Destino ADO.NET)
    participant Error as Salida de Error de Origen de ADO.NET

    Origen-&gt;&gt;Transform: Ejecuta consulta SQL con CTEs
    Transform-&gt;&gt;Salida: Devuelve registros nuevos identificados
    Salida-&gt;&gt;Destino: Carga registros en DIM_BENEFICIARIOS Transversal
    Salida-&gt;&gt;Error: Redirige filas con errores</code></pre>
<h5 id="componente-procesar_dim_afiliados">Componente <strong><code>Procesar_DIM_AFILIADOS</code></strong><a class="headerlink" href="#componente-procesar_dim_afiliados" title="Permanent link">&para;</a></h5>
<h6 id="descripcion-general_10">Descripción General<a class="headerlink" href="#descripcion-general_10" title="Permanent link">&para;</a></h6>
<p>El componente <code>Procesar_DIM_AFILIADOS</code> es una tarea de flujo de datos en un paquete SSIS que se encarga de procesar y cargar datos en la tabla <code>DIM_AFILIADOS</code> en el Data Warehouse. Este componente realiza operaciones de extracción, transformación y carga (ETL) de alto rendimiento.</p>
<h4 id="detalles-del-componente_6">Detalles del Componente<a class="headerlink" href="#detalles-del-componente_6" title="Permanent link">&para;</a></h4>
<h5 id="propiedades-del-componente_6">Propiedades del Componente<a class="headerlink" href="#propiedades-del-componente_6" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Nombre del Componente</strong>: <code>Procesar_DIM_AFILIADOS</code></li>
<li><strong>DTSID</strong>: <code>{UNIQUE-DTSID}</code></li>
<li><strong>Descripción</strong>: <code>Data Flow Task</code></li>
<li><strong>Tipo de Componente</strong>: <code>Microsoft.Pipeline</code></li>
</ul>
<h6 id="propiedades-de-la-conexion_3">Propiedades de la Conexión<a class="headerlink" href="#propiedades-de-la-conexion_3" title="Permanent link">&para;</a></h6>
<ul>
<li><strong>Administrador de Conexiones</strong>: <code>Excel_Connection_Dim_Afiliados</code></li>
<li><strong>Tipo de Conexión</strong>: <code>OLE DB</code></li>
</ul>
<h6 id="propiedades-de-la-tabla-de-destino">Propiedades de la Tabla de Destino<a class="headerlink" href="#propiedades-de-la-tabla-de-destino" title="Permanent link">&para;</a></h6>
<ul>
<li><strong>Nombre de la Tabla</strong>: <code>"Transversal"."DIM_AFILIADOS"</code></li>
<li><strong>Batch Size</strong>: <code>0</code></li>
<li><strong>Command Timeout</strong>: <code>30</code></li>
<li><strong>Use Bulk Insert When Possible</strong>: <code>true</code></li>
</ul>
<h6 id="columnas-de-entrada">Columnas de Entrada<a class="headerlink" href="#columnas-de-entrada" title="Permanent link">&para;</a></h6>
<ul>
<li><code>ID_AFILIADO</code></li>
<li><code>NOMBRE</code></li>
<li><code>APELLIDO</code></li>
<li><code>TIPO_DOCUMENTO</code></li>
<li><code>NUMERO_DOCUMENTO</code></li>
<li><code>FECHA_NACIMIENTO</code></li>
<li><code>GENERO</code></li>
<li><code>ESTADO_CIVIL</code></li>
<li><code>DIRECCION</code></li>
<li><code>CIUDAD</code></li>
<li><code>TELEFONO</code></li>
<li><code>EMAIL</code></li>
</ul>
<h5 id="diagrama-de-secuencia-del-proceso-etl_7">Diagrama de Secuencia del Proceso ETL<a class="headerlink" href="#diagrama-de-secuencia-del-proceso-etl_7" title="Permanent link">&para;</a></h5>
<pre class="mermaid"><code>sequenceDiagram
    title Diagrama de Secuencia del Proceso ETL - Procesar_DIM_AFILIADOS
    autonumber
    participant SSIS as Tarea SSIS
    participant Excel as Fuente de Datos Excel
    participant DWH as Data Warehouse

    SSIS-&gt;&gt;Excel: Leer datos de `Sheet1$`
    Excel--&gt;&gt;SSIS: Retornar datos leídos
    SSIS-&gt;&gt;SSIS: Convertir datos
    SSIS-&gt;&gt;SSIS: Crear columna derivada `ID_AFILIADO_AUXILIAR`
    SSIS-&gt;&gt;DWH: Realizar búsqueda en `DIM_AFILIADOS`
    DWH--&gt;&gt;SSIS: Retornar resultados de búsqueda
    SSIS-&gt;&gt;SSIS: Dividir datos en `Agregar` y `Modificar`
    SSIS-&gt;&gt;DWH: Cargar datos en tabla `DIM_AFILIADOS`
    DWH--&gt;&gt;SSIS: Confirmación de carga exitosa</code></pre>
<h5 id="componentes-del-flujo-de-datos_3">Componentes del Flujo de Datos<a class="headerlink" href="#componentes-del-flujo-de-datos_3" title="Permanent link">&para;</a></h5>
<ol>
<li>
<p><strong>Fuente de Datos Excel (<code>Sheet1$</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Lee datos desde una hoja de Excel.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>OpenRowset</code>: <code>Sheet1$</code></li>
<li><code>CommandTimeout</code>: <code>0</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Conversión de Datos (<code>Data Conversion</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Verifica y convierte los tipos de datos de las columnas de entrada.</li>
</ul>
</li>
<li>
<p><strong>Columna Derivada (<code>Crear ID_AFILIADO_AUXILIAR</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Crea una nueva columna <code>ID_AFILIADO_AUXILIAR</code> concatenando varias columnas de entrada.</li>
</ul>
</li>
<li>
<p><strong>Búsqueda (<code>Lookup</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Realiza una búsqueda en la tabla <code>DIM_AFILIADOS</code> para unir columnas adicionales al flujo de datos.</li>
</ul>
</li>
<li>
<p><strong>División Condicional (<code>Conditional Split</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Divide las filas de datos en diferentes salidas según el contenido de los datos.</li>
</ul>
</li>
<li>
<p><strong>Destino ADO.NET (<code>DIM_AFILIADOS_DEST</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Carga datos en la tabla <code>DIM_AFILIADOS</code> en el Data Warehouse.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>TableOrViewName</code>: <code>"Transversal"."DIM_AFILIADOS"</code></li>
<li><code>BatchSize</code>: <code>0</code></li>
<li><code>CommandTimeout</code>: <code>30</code></li>
<li><code>UseBulkInsertWhenPossible</code>: <code>true</code></li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="componente-procesar-dim_afiliados">Componente <strong><code>Procesar DIM_AFILIADOS</code></strong><a class="headerlink" href="#componente-procesar-dim_afiliados" title="Permanent link">&para;</a></h3>
<p>Corresponde a un flujo de datos dentro del paquete SSIS diseñado para procesar la dimensión de afiliados. El flujo extrae información relevante desde una fuente de datos en la zona de staging (TMP POBLACION EDUCACION) y la transforma para finalmente cargarla en la tabla destino <code>"Transversal"."DIM_AFILIADOS"</code> en el Data Warehouse de destino.</p>
<hr />
<h4 id="componentes-principales">Componentes Principales<a class="headerlink" href="#componentes-principales" title="Permanent link">&para;</a></h4>
<h5 id="1-componente-origen-tmp-poblacion-educacion">1. Componente Origen: <strong>TMP POBLACION EDUCACION</strong><a class="headerlink" href="#1-componente-origen-tmp-poblacion-educacion" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Función:</strong><br />
  Utiliza un adaptador DataReader para conectarse a la base de datos de staging (STAGE_AREA) y ejecutar una consulta SQL compleja que utiliza múltiples CTEs (Common Table Expressions).  </li>
<li>
<p><strong>Proceso de la Consulta:</strong>  </p>
<ul>
<li><strong>PobEducacion:</strong> Extrae datos de la tabla temporal <code>[TMP_POBLACION_EDUCACION]</code>, seleccionando columnas como <code>TIPO_DOCUMENTO_SIGLAS</code>, <code>DOCUMENTO</code> y <code>ID_TIPO_DOCUMENTO</code>.  </li>
<li><strong>AFILIADOS:</strong> Obtiene la información actual de afiliados desde la dimensión <code>[DIM_AFILIADOS]</code> del esquema Transversal, filtrando por registros con <code>ESTADOREGISTRO = 'CURRENT'</code> y que tengan <code>EMPRESA_PRINCIPAL = 'X'</code>.  </li>
<li><strong>afiliadoNuevos:</strong> Identifica registros nuevos comparando la información extraída de la zona de staging con la existente en <code>[DIM_AFILIADOS]</code>, utilizando una operación LEFT JOIN.  </li>
<li><strong>EMPRESASCaja y AFILIADOSCaja:</strong> Se extrae información desde las dimensiones de Aportes para relacionar a los afiliados con las empresas correspondientes.  </li>
<li><strong>AFILIADOS_CON_EMPRESA y AfiliadosCajaIdEmpresa:</strong> Se realiza una unión y se selecciona la última coincidencia (utilizando ROW_NUMBER) para garantizar que cada afiliado quede asociado a un único <code>ID_EMPRESA</code>.</li>
<li><strong>Consulta Final:</strong><br />
  Se efectúa un LEFT JOIN entre los registros nuevos (<code>afiliadoNuevos</code>) y la información consolidada de afiliados con empresa (<code>AfiliadosCajaIdEmpresa</code>), filtrando aquellos registros que tienen un <code>ID_AFILIADO</code> válido.</li>
</ul>
</li>
<li>
<p><strong>Conexión:</strong><br />
  Se utiliza un administrador de conexiones externo apuntando al ambiente <code>STAGE_AREA</code>.</p>
</li>
</ul>
<h5 id="2-componente-destino-destino-de-ado-net">2. Componente Destino: <strong>Destino de ADO NET</strong><a class="headerlink" href="#2-componente-destino-destino-de-ado-net" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Función:</strong><br />
  Este componente carga los datos procesados en la tabla destino <code>"Transversal"."DIM_AFILIADOS"</code> del Data Warehouse.</li>
<li><strong>Configuración Clave:</strong>  <ul>
<li><strong>TableOrViewName:</strong> <code>"Transversal"."DIM_AFILIADOS"</code>  </li>
<li><strong>BatchSize:</strong> 0 (utiliza el tamaño del búfer interno de SSIS)  </li>
<li><strong>CommandTimeout:</strong> 30 segundos  </li>
<li><strong>UseBulkInsertWhenPossible:</strong> true (mejora el rendimiento al usar inserción masiva)</li>
</ul>
</li>
<li><strong>Conexión:</strong><br />
  Se conecta a través de un administrador de conexiones configurado con <code>DWH_COMFENALCO_Destino</code>.</li>
</ul>
<h5 id="3-flujo-de-conexion">3. Flujo de Conexión<a class="headerlink" href="#3-flujo-de-conexion" title="Permanent link">&para;</a></h5>
<p>El flujo conecta el origen (TMP POBLACION EDUCACION) con el destino (DIM_AFILIADOS Transversal) mediante una ruta de datos:</p>
<pre class="mermaid"><code>sequenceDiagram
    participant Origen as TMP POBLACION EDUCACION (Origen ADO.NET)
    participant Destino as DIM_AFILIADOS Transversal (Destino ADO.NET)

    Origen -&gt;&gt; Destino: Transfiere datos procesados para cargar en la dimensión</code></pre>
<hr />
<h4 id="proceso-general">Proceso General<a class="headerlink" href="#proceso-general" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Extracción de Datos:</strong><br />
   La consulta SQL del componente origen ejecuta múltiples CTEs para:</p>
<ul>
<li>Extraer datos de la zona de staging.</li>
<li>Comparar y detectar registros nuevos de afiliados.</li>
<li>Relacionar la información con datos de empresas y afiliados desde áreas de aportes.</li>
</ul>
</li>
<li>
<p><strong>Transformación de Datos:</strong><br />
    Los registros nuevos son identificados a partir de la ausencia de coincidencias en la dimensión actual. Se aplican transformaciones y validaciones implícitas para asegurar la calidad de los datos.</p>
</li>
<li>
<p><strong>Carga de Datos:</strong><br />
    Los datos resultantes se envían al componente destino, que inserta la información en la tabla <code>"Transversal"."DIM_AFILIADOS"</code>, utilizando configuraciones optimizadas para cargas masivas.</p>
</li>
<li>
<p><strong>Manejo de Errores:</strong><br />
    Cualquier fila que genere error en la extracción o transformación se redirige a una salida de error, permitiendo el análisis y corrección sin detener el flujo principal.</p>
</li>
</ol>
<h3 id="procesar-dim-afiliados-desde-beneficiarios">Procesar <strong><code>DIM AFILIADOS desde BENEFICIARIOS</code></strong><a class="headerlink" href="#procesar-dim-afiliados-desde-beneficiarios" title="Permanent link">&para;</a></h3>
<p>Este nodo un <strong>Data Flow Task</strong> dentro del paquete SSIS, cuyo objetivo es procesar y actualizar la dimensión de afiliados a partir de datos provenientes de beneficiarios. Los datos se extraen a través de una consulta SQL compleja que utiliza varias CTEs para identificar los registros de beneficiarios que aún no se encuentran en la dimensión de afiliados y, posteriormente, se cargan en la tabla destino <code>"Transversal"."DIM_AFILIADOS"</code>.</p>
<hr />
<h4 id="componentes-clave">Componentes Clave<a class="headerlink" href="#componentes-clave" title="Permanent link">&para;</a></h4>
<h5 id="1-origen-transversal_dim_beneficiarios">1. <strong>Origen: TRANSVERSAL_DIM_BENEFICIARIOS</strong><a class="headerlink" href="#1-origen-transversal_dim_beneficiarios" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Función:</strong><br />
  Este componente extrae datos usando un adaptador ADO.NET (DataReaderSource) que ejecuta una consulta SQL.  </li>
<li>
<p><strong>Consulta SQL:</strong><br />
    La consulta utiliza varias CTEs para:</p>
<ul>
<li>Seleccionar los <code>ID_AFILIADO</code> únicos de la tabla <code>[DIM_BENEFICIARIOS]</code> en el esquema Transversal.</li>
<li>Compararlos con los <code>ID_AFILIADO</code> ya presentes en la tabla <code>[DIM_AFILIADOS]</code> del mismo esquema.</li>
<li>Identificar los registros que están en beneficiarios pero faltan en la dimensión de afiliados.</li>
<li>Además, se unen con las dimensiones de empresas y se filtran por registros actuales (por ejemplo, donde <code>[ESTADOREGISTRO] = 'CURRENT'</code>) y por la condición de empresa principal.</li>
<li>Se asigna un número de fila (rn) para seleccionar el registro final por cada afiliado.</li>
</ul>
</li>
<li>
<p><strong>Conexión:</strong><br />
  Utiliza el administrador de conexiones configurado con <code>DWH_COMFENALCO_Destino</code>.</p>
</li>
<li>
<p><strong>Salida:</strong><br />
  La salida (Salida de origen de ADO NET) expone columnas relevantes, incluyendo:</p>
<ul>
<li><code>ID_AFILIADO</code></li>
<li><code>PARTNER</code></li>
<li><code>ID_TIPO_DOCUMENTO</code>, <code>COD_TIPO_DOCUMENTO</code>, <code>TIPO_DOCUMENTO</code></li>
<li><code>NUMERO_DOCUMENTO</code></li>
<li><code>NOMBRE_COMPLETO</code></li>
<li><code>PRIMER_APELLIDO</code>, <code>SEGUNDO_APELLIDO</code>, <code>PRIMER_NOMBRE</code>, <code>SEGUNDO_NOMBRE</code></li>
<li>Y otros campos relacionados con la afiliación, características demográficas, estado civil, ocupación, entre otros.</li>
</ul>
</li>
</ul>
<p>Además, se genera la columna <code>rn</code> para identificar el registro principal en caso de múltiples coincidencias.</p>
<h5 id="2-destino-destino-de-ado-net">2. <strong>Destino: Destino de ADO NET</strong><a class="headerlink" href="#2-destino-destino-de-ado-net" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Función:</strong><br />
  Este componente se encarga de cargar los datos procesados en la tabla destino <code>"Transversal"."DIM_AFILIADOS"</code>.</li>
<li><strong>Configuración Importante:</strong>  <ul>
<li><strong>TableOrViewName:</strong> <code>"Transversal"."DIM_AFILIADOS"</code></li>
<li><strong>BatchSize:</strong> 0 (lo que indica que se usará el tamaño del búfer interno de SSIS)</li>
<li><strong>CommandTimeout:</strong> 30 segundos</li>
<li><strong>UseBulkInsertWhenPossible:</strong> true (habilita la inserción masiva para mejorar el rendimiento)</li>
</ul>
</li>
<li><strong>Conexión:</strong><br />
  Se conecta a través del administrador de conexiones <code>DWH_COMFENALCO_Destino</code>.</li>
</ul>
<h5 id="3-flujo-de-datos">3. <strong>Flujo de Datos</strong><a class="headerlink" href="#3-flujo-de-datos" title="Permanent link">&para;</a></h5>
<p>El flujo de datos conecta la salida del componente de origen (TRANSVERSAL_DIM_BENEFICIARIOS) con la entrada del componente destino (Destino de ADO NET). Esto garantiza que los registros identificados se transfieran y se inserten en la tabla de afiliados.</p>
<pre class="mermaid"><code>sequenceDiagram
    participant Origen as TRANSVERSAL_DIM_BENEFICIARIOS (Salida de origen de ADO NET)
    participant Destino as Destino de ADO NET (Entrada de destino de ADO NET)

    Origen -&gt;&gt; Destino: Transfiere los datos para actualizar DIM_AFILIADOS</code></pre>
<hr />
<h4 id="proceso-general_1">Proceso General<a class="headerlink" href="#proceso-general_1" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Extracción:</strong>  </p>
<ul>
<li>La consulta SQL del componente origen extrae los <code>ID_AFILIADO</code> de la dimensión de beneficiarios que no se encuentran en la dimensión de afiliados.</li>
<li>Se realizan uniones y se filtra la información para garantizar la calidad de los datos (por ejemplo, considerando solo registros actuales y los de empresa principal).</li>
</ul>
</li>
<li>
<p><strong>Transformación:</strong>  </p>
<ul>
<li>Se realiza la asignación de un número de fila (<code>rn</code>) para seleccionar el registro final en caso de múltiples coincidencias para un mismo afiliado.</li>
<li>La consulta prepara los datos para ser consistentes con el esquema de la tabla destino, convirtiendo tipos de datos y asegurando la integridad de la información.</li>
</ul>
</li>
<li>
<p><strong>Carga:</strong>  </p>
<ul>
<li>El componente destino recibe los datos y los inserta en la tabla <code>"Transversal"."DIM_AFILIADOS"</code>, utilizando Bulk Insert cuando sea posible para mejorar el rendimiento.</li>
<li>En caso de errores, los registros problemáticos se redirigen a una salida de  error, permitiendo el análisis posterior sin detener el flujo completo.</li>
</ul>
</li>
</ol>
<h3 id="componente-procesar-dim_empresas">Componente <strong><code>Procesar DIM_EMPRESAS</code></strong><a class="headerlink" href="#componente-procesar-dim_empresas" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_11">Descripción General<a class="headerlink" href="#descripcion-general_11" title="Permanent link">&para;</a></h4>
<p>El componente <code>Procesar_DIM_EMPRESAS</code> es una tarea de flujo de datos en un paquete SSIS que se encarga de procesar y cargar datos en la tabla <code>DIM_EMPRESAS</code> en el Data Warehouse. Este componente realiza operaciones de extracción, transformación y carga (ETL) de alto rendimiento.</p>
<h4 id="detalles-del-componente_7">Detalles del Componente<a class="headerlink" href="#detalles-del-componente_7" title="Permanent link">&para;</a></h4>
<h5 id="propiedades-del-componente_7">Propiedades del Componente<a class="headerlink" href="#propiedades-del-componente_7" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Nombre del Componente</strong>: <code>Procesar_DIM_EMPRESAS</code></li>
<li><strong>DTSID</strong>: <code>{DTSID_DEL_COMPONENTE}</code></li>
<li><strong>Descripción</strong>: <code>Data Flow Task</code></li>
<li><strong>Tipo de Componente</strong>: <code>Microsoft.Pipeline</code></li>
</ul>
<h5 id="propiedades-de-la-conexion_4">Propiedades de la Conexión<a class="headerlink" href="#propiedades-de-la-conexion_4" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Administrador de Conexiones</strong>: <code>Excel_Connection_Dim_Empresas</code></li>
<li><strong>Tipo de Conexión</strong>: <code>OLE DB</code></li>
</ul>
<h5 id="propiedades-de-la-tabla-de-destino_1">Propiedades de la Tabla de Destino<a class="headerlink" href="#propiedades-de-la-tabla-de-destino_1" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Nombre de la Tabla</strong>: <code>"Transversal"."DIM_EMPRESAS"</code></li>
<li><strong>Batch Size</strong>: <code>0</code></li>
<li><strong>Command Timeout</strong>: <code>30</code></li>
<li><strong>Use Bulk Insert When Possible</strong>: <code>true</code></li>
</ul>
<h4 id="diagrama-de-secuencia-del-proceso-etl_8">Diagrama de Secuencia del Proceso ETL<a class="headerlink" href="#diagrama-de-secuencia-del-proceso-etl_8" title="Permanent link">&para;</a></h4>
<pre class="mermaid"><code>sequenceDiagram
    title Diagrama de Secuencia del Proceso ETL - Procesar_DIM_EMPRESAS
    autonumber
    participant SSIS as Tarea SSIS
    participant Excel as Fuente de Datos Excel
    participant DWH as Data Warehouse

    SSIS-&gt;&gt;Excel: Leer datos de `Sheet1$`
    Excel--&gt;&gt;SSIS: Retornar datos leídos
    SSIS-&gt;&gt;SSIS: Verificar tipos de datos
    SSIS-&gt;&gt;SSIS: Crear columna derivada `ID_EMPRESA_AUXILIAR`
    SSIS-&gt;&gt;DWH: Realizar búsqueda en `DIM_EMPRESAS`
    DWH--&gt;&gt;SSIS: Retornar resultados de búsqueda
    SSIS-&gt;&gt;SSIS: Dividir datos en `Agregar` y `Modificar`
    SSIS-&gt;&gt;DWH: Cargar datos en tabla `DIM_EMPRESAS`
    DWH--&gt;&gt;SSIS: Confirmación de carga exitosa</code></pre>
<h3 id="componente-procesar-dim_empresas-desde-afiliados">Componente <strong><code>Procesar DIM_EMPRESAS desde AFILIADOS</code></strong><a class="headerlink" href="#componente-procesar-dim_empresas-desde-afiliados" title="Permanent link">&para;</a></h3>
<p>Flujo de datos (Data Flow Task) dentro del paquete SSIS cuyo objetivo es procesar información relacionada con empresas a partir de datos provenientes de afiliados. La información se extrae de una fuente (un componente de origen basado en ADO.NET que ejecuta una consulta SQL) y se carga en la tabla destino <code>"Transversal"."DIM_EMPRESAS"</code> en el Data Warehouse de destino.</p>
<h4 id="componentes-clave_1">Componentes Clave<a class="headerlink" href="#componentes-clave_1" title="Permanent link">&para;</a></h4>
<h5 id="1-origen-transversal-dim-afiliados">1. Origen: TRANSVERSAL DIM AFILIADOS<a class="headerlink" href="#1-origen-transversal-dim-afiliados" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Función:</strong><br />
  Este componente extrae datos utilizando un adaptador ADO.NET (DataReaderSource) que ejecuta una consulta SQL.  </li>
<li>
<p><strong>Consulta SQL:</strong><br />
    La consulta utiliza CTEs (Common Table Expressions) para:</p>
<ul>
<li>Seleccionar de la dimensión de afiliados (<code>[DIM_AFILIADOS]</code>) del esquema Transversal.</li>
<li>Identificar los <code>ID_EMPRESA</code> que están presentes en la dimensión de afiliados pero que no se encuentran en la dimensión de empresas actual (<code>[DIM_EMPRESAS]</code>).</li>
<li>Luego, se hace un LEFT JOIN con la tabla <code>[DIM_EMPRESAS]</code> del esquema Aportes, filtrando registros actuales (<code>ESTADOREGISTRO = 'CURRENT'</code>).</li>
</ul>
</li>
<li>
<p><strong>Conexión:</strong><br />
  Se utiliza un administrador de conexiones configurado con <code>DWH_COMFENALCO_Destino</code>.</p>
</li>
<li>
<p><strong>Salida:</strong><br />
  El componente expone una salida de datos (Salida de origen de ADO NET) con columnas relevantes como <code>ID_EMPRESA</code>, <code>PARTNER</code>, <code>ID_TIPO_DOCUMENTO</code>, <code>COD_TIPO_DOCUMENTO</code>, <code>TIPO_DOCUMENTO</code>, <code>DOCUMENTO</code>, <code>RAZON_SOCIAL</code>, <code>ID_ESTADO</code>, <code>ESTADO</code>, entre otras, que se utilizarán en la carga final.</p>
</li>
</ul>
<h5 id="2-destino-destino-de-ado-net_1">2. Destino: Destino de ADO NET<a class="headerlink" href="#2-destino-destino-de-ado-net_1" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Función:</strong><br />
  Este componente carga los datos procesados en la tabla destino <code>"Transversal"."DIM_EMPRESAS"</code>.  </li>
<li>
<p><strong>Configuración Importante:</strong>  </p>
<ul>
<li><strong>TableOrViewName:</strong> <code>"Transversal"."DIM_EMPRESAS"</code></li>
<li><strong>BatchSize:</strong> 0 (utiliza el tamaño del búfer interno de SSIS)</li>
<li><strong>CommandTimeout:</strong> 30 segundos</li>
<li><strong>UseBulkInsertWhenPossible:</strong> true (habilita la inserción masiva para mejorar el rendimiento)</li>
</ul>
</li>
<li>
<p><strong>Conexión:</strong><br />
  Utiliza el administrador de conexiones <code>DWH_COMFENALCO_Destino</code>.</p>
</li>
</ul>
<h5 id="3-flujo-de-datos_1">3. Flujo de Datos<a class="headerlink" href="#3-flujo-de-datos_1" title="Permanent link">&para;</a></h5>
<p>El flujo de datos conecta la salida del componente de origen (TRANSVERSAL DIM AFILIADOS) con la entrada del componente destino (Destino de ADO NET), de manera que los datos extraídos y transformados se inserten en la tabla <code>"Transversal"."DIM_EMPRESAS"</code>.</p>
<pre class="mermaid"><code>sequenceDiagram
    participant Origen as TRANSVERSAL DIM AFILIADOS (Salida de origen de ADO NET)
    participant Destino as Destino de ADO NET (Entrada de destino de ADO NET)

    Origen -&gt;&gt; Destino: Transfiere los datos para cargar en DIM_EMPRESAS</code></pre>
<hr />
<h4 id="proceso-general_2">Proceso General<a class="headerlink" href="#proceso-general_2" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Extracción:</strong>  </p>
<ul>
<li>Se ejecuta la consulta SQL del componente origen que identifica los <code>ID_EMPRESA</code> presentes en la dimensión de afiliados y que aún no existen en la dimensión de empresas.  </li>
<li>La consulta se apoya en CTEs para estructurar y filtrar los datos, garantizando que sólo se seleccionen empresas relevantes que deben ser cargadas.</li>
</ul>
</li>
<li>
<p><strong>Transformación:</strong>  </p>
<ul>
<li>Los datos extraídos se transforman implícitamente a través de la configuración del flujo, garantizando la correcta conversión de tipos (por ejemplo, cadenas, enteros y marcas de tiempo).</li>
</ul>
</li>
<li>
<p><strong>Carga:</strong>  </p>
<ul>
<li>El componente destino recibe los datos y los inserta en la tabla <code>"Transversal"."DIM_EMPRESAS"</code>.  </li>
<li>La opción de Bulk Insert está activada para optimizar el rendimiento de la carga masiva.</li>
</ul>
</li>
<li>
<p><strong>Manejo de Errores:</strong>  </p>
<ul>
<li>Cualquier error durante la carga se redirige a una salida de error (Salida de error de destino de ADO NET), lo que permite analizar y corregir problemas sin detener el flujo completo.</li>
</ul>
</li>
</ol>
<h3 id="componente-procesar_dim_aportante_no_afiliado">Componente <strong><code>Procesar_DIM_APORTANTE_NO_AFILIADO</code></strong><a class="headerlink" href="#componente-procesar_dim_aportante_no_afiliado" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_12">Descripción General<a class="headerlink" href="#descripcion-general_12" title="Permanent link">&para;</a></h4>
<p>El componente <code>Procesar_DIM_APORTANTE_NO_AFILIADO</code> es una tarea de flujo de datos en un paquete SSIS que se encarga de procesar y cargar datos en la tabla <code>DIM_APORTANTE_NO_AFILIADO</code> en el Data Warehouse. Este componente realiza operaciones de extracción, transformación y carga (ETL) de alto rendimiento.</p>
<h4 id="detalles-del-componente_8">Detalles del Componente<a class="headerlink" href="#detalles-del-componente_8" title="Permanent link">&para;</a></h4>
<h5 id="propiedades-del-componente_8">Propiedades del Componente<a class="headerlink" href="#propiedades-del-componente_8" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Nombre del Componente</strong>: <code>Procesar_DIM_APORTANTE_NO_AFILIADO</code></li>
<li><strong>DTSID</strong>: <code>{DTSID_DEL_COMPONENTE}</code></li>
<li><strong>Descripción</strong>: <code>Data Flow Task</code></li>
<li><strong>Tipo de Componente</strong>: <code>Microsoft.Pipeline</code></li>
</ul>
<h5 id="propiedades-de-la-conexion_5">Propiedades de la Conexión<a class="headerlink" href="#propiedades-de-la-conexion_5" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Administrador de Conexiones</strong>: <code>Excel_Connection_Dim_Aportante</code></li>
<li><strong>Tipo de Conexión</strong>: <code>OLE DB</code></li>
</ul>
<h5 id="propiedades-de-la-tabla-de-destino_2">Propiedades de la Tabla de Destino<a class="headerlink" href="#propiedades-de-la-tabla-de-destino_2" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Nombre de la Tabla</strong>: <code>"Transversal"."DIM_APORTANTE_NO_AFILIADO"</code></li>
<li><strong>Batch Size</strong>: <code>0</code></li>
<li><strong>Command Timeout</strong>: <code>30</code></li>
<li><strong>Use Bulk Insert When Possible</strong>: <code>true</code></li>
</ul>
<h5 id="columnas-de-entrada_1">Columnas de Entrada<a class="headerlink" href="#columnas-de-entrada_1" title="Permanent link">&para;</a></h5>
<ul>
<li><code>ID_APORTANTE</code></li>
<li><code>NOMBRE_APORTANTE</code></li>
<li><code>TIPO_APORTANTE</code></li>
<li><code>FECHA_REGISTRO</code></li>
<li><code>ESTADO</code></li>
</ul>
<h5 id="diagrama-de-secuencia-del-proceso-etl_9">Diagrama de Secuencia del Proceso ETL<a class="headerlink" href="#diagrama-de-secuencia-del-proceso-etl_9" title="Permanent link">&para;</a></h5>
<pre class="mermaid"><code>sequenceDiagram
    title Diagrama de Secuencia del Proceso ETL - Procesar_DIM_APORTANTE_NO_AFILIADO
    autonumber
    participant SSIS as Tarea SSIS
    participant Excel as Fuente de Datos Excel
    participant DWH as Data Warehouse

    SSIS-&gt;&gt;Excel: Leer datos de `Sheet1$`
    Excel--&gt;&gt;SSIS: Retornar datos leídos
    SSIS-&gt;&gt;SSIS: Convertir datos
    SSIS-&gt;&gt;SSIS: Crear columna derivada `ID_APORTANTE_AUXILIAR`
    SSIS-&gt;&gt;DWH: Realizar búsqueda en `DIM_APORTANTE_NO_AFILIADO`
    DWH--&gt;&gt;SSIS: Retornar resultados de búsqueda
    SSIS-&gt;&gt;SSIS: Dividir datos en `Agregar` y `Modificar`
    SSIS-&gt;&gt;DWH: Cargar datos en tabla `DIM_APORTANTE_NO_AFILIADO`
    DWH--&gt;&gt;SSIS: Confirmación de carga exitosa</code></pre>
<h5 id="componentes-del-flujo-de-datos_4">Componentes del Flujo de Datos<a class="headerlink" href="#componentes-del-flujo-de-datos_4" title="Permanent link">&para;</a></h5>
<ol>
<li>
<p><strong>Fuente de Datos Excel (<code>Sheet1$</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Lee datos desde una hoja de Excel.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>OpenRowset</code>: <code>Sheet1$</code></li>
<li><code>CommandTimeout</code>: <code>0</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Conversión de Datos (<code>Data Conversion</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Convierte los tipos de datos de las columnas de entrada.</li>
</ul>
</li>
<li>
<p><strong>Columna Derivada (<code>Crear_ID_APORTANTE_AUXILIAR</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Crea una nueva columna <code>ID_APORTANTE_AUXILIAR</code> concatenando varias columnas de entrada.</li>
</ul>
</li>
<li>
<p><strong>Búsqueda (<code>Lookup</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Realiza una búsqueda en la tabla <code>DIM_APORTANTE_NO_AFILIADO</code> para unir columnas adicionales al flujo de datos.</li>
</ul>
</li>
<li>
<p><strong>División Condicional (<code>Conditional Split</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Divide las filas de datos en diferentes salidas según el contenido de los datos.</li>
</ul>
</li>
<li>
<p><strong>Destino ADO.NET (<code>DIM_APORTANTE_NO_AFILIADO_DEST</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Carga datos en la tabla <code>DIM_APORTANTE_NO_AFILIADO</code> en el Data Warehouse.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>TableOrViewName</code>: <code>"Transversal"."DIM_APORTANTE_NO_AFILIADO"</code></li>
<li><code>BatchSize</code>: <code>0</code></li>
<li><code>CommandTimeout</code>: <code>30</code></li>
<li><code>UseBulkInsertWhenPossible</code>: <code>true</code></li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="componente-descargar_ep-tra-05">Componente <strong><code>Descargar_EP-TRA-05</code></strong><a class="headerlink" href="#componente-descargar_ep-tra-05" title="Permanent link">&para;</a></h3>
<h4 id="descripcion-general_13">Descripción General<a class="headerlink" href="#descripcion-general_13" title="Permanent link">&para;</a></h4>
<p>El componente <code>Descargar_EP-TRA-05</code> es una tarea de ejecución de proceso en un paquete SSIS que se encarga de ejecutar un script de Python para descargar archivos desde SharePoint. Este componente utiliza la tarea <code>Execute Process</code> para ejecutar el script.</p>
<h4 id="detalles-del-componente_9">Detalles del Componente<a class="headerlink" href="#detalles-del-componente_9" title="Permanent link">&para;</a></h4>
<h5 id="propiedades-del-componente_9">Propiedades del Componente<a class="headerlink" href="#propiedades-del-componente_9" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Nombre del Componente</strong>: <code>Descargar_EP-TRA-05</code></li>
<li><strong>DTSID</strong>: <code>{769c3094-28c7-44e9-9e36-9e9bc371b279}</code></li>
<li><strong>Descripción</strong>: <code>Tarea Ejecutar proceso</code></li>
<li><strong>Tipo de Componente</strong>: <code>Microsoft.ExecuteProcess</code></li>
<li><strong>TaskContact</strong>: <code>Execute Process Task;Microsoft Corporation; SQL Server 2022; © 2022 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1</code></li>
</ul>
<h5 id="propiedades-del-proceso">Propiedades del Proceso<a class="headerlink" href="#propiedades-del-proceso" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Executable</strong>: <code>@[$Project::Working_Directory]+"COMFENALCO_EDUCACION\\01.Scripts\\Utils\\env\\Scripts\\python.exe"</code></li>
<li><strong>WorkingDirectory</strong>: <code>@[$Project::Working_Directory]+"COMFENALCO_EDUCACION\\01.Scripts\\03.Archivos_Manuales\\01.Transversal"</code></li>
<li><strong>Arguments</strong>: <code>04.SharePoint_Connection_EP-TRA-05.py</code></li>
</ul>
<h5 id="diagrama-de-secuencia-del-proceso">Diagrama de Secuencia del Proceso<a class="headerlink" href="#diagrama-de-secuencia-del-proceso" title="Permanent link">&para;</a></h5>
<pre class="mermaid"><code>sequenceDiagram
    title Diagrama de Secuencia del Proceso - Descargar_EP-TRA-05
    autonumber
    participant SSIS as Tarea SSIS
    participant Python as Script de Python
    participant SharePoint as Servidor SharePoint

    SSIS-&gt;&gt;Python: Ejecutar script `04.SharePoint_Connection_EP-TRA-05.py`
    Python--&gt;&gt;SharePoint: Conectar a SharePoint
    SharePoint--&gt;&gt;Python: Confirmar conexión
    Python-&gt;&gt;SharePoint: Descargar archivos
    SharePoint--&gt;&gt;Python: Retornar archivos descargados
    Python--&gt;&gt;SSIS: Confirmar finalización del proceso</code></pre>
<h5 id="componentes-del-proceso">Componentes del Proceso<a class="headerlink" href="#componentes-del-proceso" title="Permanent link">&para;</a></h5>
<ol>
<li>
<p><strong>Tarea Ejecutar Proceso (<code>Descargar_EP-TRA-05</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Ejecuta un script de Python para descargar archivos desde SharePoint.</li>
<li><strong>Propiedades</strong>:<ul>
<li><code>Executable</code>: <code>@[$Project::Working_Directory]+"COMFENALCO_EDUCACION\\01.Scripts\\Utils\\env\\Scripts\\python.exe"</code></li>
<li><code>WorkingDirectory</code>: <code>@[$Project::Working_Directory]+"COMFENALCO_EDUCACION\\01.Scripts\\03.Archivos_Manuales\\01.Transversal"</code></li>
<li><code>Arguments</code>: <code>04.SharePoint_Connection_EP-TRA-05.py</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Script de Python (<code>04.SharePoint_Connection_EP-TRA-05.py</code>)</strong></p>
<ul>
<li><strong>Descripción</strong>: Script que se conecta a SharePoint y descarga los archivos necesarios.</li>
</ul>
</li>
<li>
<p><strong>Servidor SharePoint</strong></p>
<ul>
<li><strong>Descripción</strong>: Servidor desde el cual se descargan los archivos.</li>
</ul>
</li>
</ol>
<h3 id="componente-procesar_dim_personal">Componente <strong><code>Procesar_DIM_PERSONAL</code></strong><a class="headerlink" href="#componente-procesar_dim_personal" title="Permanent link">&para;</a></h3>
<p>Este <em>Data Flow Task</em> dentro del paquete SSIS está diseñado para procesar la dimensión del personal. El flujo de datos extrae información de una fuente Excel, la transforma a través de conversiones y derivaciones, y la enriquece mediante una operación de búsqueda (<em>Lookup</em>), para finalmente cargar los datos transformados en la tabla destino <code>"Transversal"."DIM_PERSONAL"</code>.</p>
<hr />
<h4 id="componentes-principales_1">Componentes Principales<a class="headerlink" href="#componentes-principales_1" title="Permanent link">&para;</a></h4>
<h5 id="1-excel-source-leer-ep-tra-05">1. <strong>Excel Source – Leer EP-TRA-05</strong><a class="headerlink" href="#1-excel-source-leer-ep-tra-05" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Función:</strong><br />
  Extrae datos desde un archivo Excel (hoja "Sheet1$").  </li>
<li><strong>Columnas Extraídas:</strong><br />
  Incluye columnas como <code>COD_PERSONA_UNIDAD</code>, <code>TIPO_DOCUMENTO</code>, <code>DOCUMENTO</code>, <code>NOMBRE</code>, <code>TELEFONO</code>, <code>CELULAR</code>, <code>CORREO</code>, <code>DIRECCION</code>, <code>CIUDAD</code>, <code>FECHA_NACIMIENTO</code>, <code>GENERO</code>, <code>ID_UNIDAD</code>, <code>SERVICIO</code>, <code>AREA</code>, <code>TIPO_CONTRATACION</code>, <code>FECHA_INICIO_CONTRATACION</code>, <code>FECHA_FIN_CONTRATACION</code>, entre otras.</li>
</ul>
<hr />
<h5 id="2-data-conversion">2. <strong>Data Conversion</strong><a class="headerlink" href="#2-data-conversion" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Función:</strong><br />
  Convierte los datos extraídos del Excel a los tipos requeridos para las siguientes transformaciones.  </li>
<li><strong>Ejemplos de Conversiones:</strong>  </li>
<li>Convierte cadenas de texto a cadenas con longitudes ajustadas (por ejemplo, <code>COD_PERSONA_UNIDAD</code> a 40 caracteres).  </li>
<li>Convierte fechas almacenadas como cadenas a tipo <code>date</code>.</li>
</ul>
<hr />
<h5 id="3-crear-id_personal_auxiliar-derived-column">3. <strong>Crear ID_PERSONAL_AUXILIAR (Derived Column)</strong><a class="headerlink" href="#3-crear-id_personal_auxiliar-derived-column" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Función:</strong><br />
  Crea una columna derivada denominada <code>ID_PERSONAL_AUXILIAR</code>.  </li>
<li><strong>Lógica de la Expresión:</strong><br />
  Concatena la columna <code>COD_PERSONA_UNIDAD</code> y <code>ID_UNIDAD</code>, separadas por un guion bajo, para formar un identificador único que se utilizará en la comparación y enriquecimiento posterior.</li>
</ul>
<blockquote>
<p><strong>Expresión:</strong><br />
<code>COD_PERSONA_UNIDAD + "_" + (DT_WSTR,10)ID_UNIDAD</code></p>
</blockquote>
<hr />
<h5 id="4-lookup">4. <strong>Lookup</strong><a class="headerlink" href="#4-lookup" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Función:</strong><br />
  Realiza una búsqueda en la tabla de referencia <code>[Transversal].[DIM_PERSONAL]</code> para obtener columnas adicionales, en este caso, para obtener el campo <code>ID_PERSONAL_AUXILIAR</code>.  </li>
<li><strong>Consulta SQL de Referencia:</strong><br />
  <div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">COD_PERSONA_UNIDAD</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">ID_UNIDAD</span><span class="p">],</span>
<span class="w">    </span><span class="p">[</span><span class="n">COD_PERSONA_UNIDAD</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">CAST</span><span class="p">([</span><span class="n">ID_UNIDAD</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="p">[</span><span class="n">ID_PERSONAL_AUXILIAR</span><span class="p">]</span>
<span class="k">FROM</span><span class="w"> </span>
<span class="w">    </span><span class="p">[</span><span class="n">Transversal</span><span class="p">].[</span><span class="n">DIM_PERSONAL</span><span class="p">];</span>
</code></pre></div></li>
<li><strong>Parámetro de Unión:</strong><br />
  Se utiliza el resultado generado en el componente derivado (<code>ID_PERSONAL_AUXILIAR</code>) para comparar con la columna correspondiente del conjunto de referencia.  </li>
<li><strong>Salidas del Lookup:</strong>  </li>
<li><strong>Lookup Match Output:</strong> Registros donde se encuentra la coincidencia en la referencia.  </li>
<li><strong>Lookup No Match Output:</strong> Registros sin coincidencia (en este flujo, estos datos se redirigen para la evaluación en el <em>Conditional Split</em>).</li>
</ul>
<hr />
<h5 id="5-conditional-split">5. <strong>Conditional Split</strong><a class="headerlink" href="#5-conditional-split" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Función:</strong><br />
  Divide el flujo de datos en dos rutas basándose en una condición.</li>
<li><strong>Condición Especificada ("Agregar"):</strong><br />
  La condición evalúa si el valor de <code>ID_PERSONAL_AUXILIAR</code> obtenido del Lookup es <em>nulo</em> y si el campo <code>Copy of DOCUMENTO</code> (resultado del Data Conversion) <strong>no</strong> es nulo:<blockquote>
<p><strong>Expresión (versión con nombres de columna):</strong><br />
<code>ISNULL(Lookup.ID_PERSONAL_AUXILIAR) &amp;&amp; !ISNULL([Copy of DOCUMENTO])</code></p>
</blockquote>
</li>
<li><strong>Salidas:</strong>  </li>
<li><strong>Agregar:</strong> Registros que cumplen la condición y que, por lo tanto, deben ser tratados como nuevos registros para agregarlos a la dimensión.</li>
<li><strong>Sin Cambios (Default):</strong> Registros que no cumplen la condición de agregación.</li>
<li><strong>Conditional Split Error Output:</strong> Manejo de errores.</li>
</ul>
<hr />
<h5 id="6-destino-de-ado-net">6. <strong>Destino de ADO NET</strong><a class="headerlink" href="#6-destino-de-ado-net" title="Permanent link">&para;</a></h5>
<ul>
<li><strong>Función:</strong><br />
  Carga los datos transformados y filtrados en la tabla destino <code>"Transversal"."DIM_PERSONAL"</code>.</li>
<li><strong>Configuración Clave:</strong>  </li>
<li><strong>TableOrViewName:</strong> <code>"Transversal"."DIM_PERSONAL"</code>  </li>
<li><strong>BatchSize:</strong> 0 (usa el tamaño del búfer interno de SSIS)  </li>
<li><strong>CommandTimeout:</strong> 30 segundos  </li>
<li><strong>UseBulkInsertWhenPossible:</strong> true (para mejorar el rendimiento en inserciones masivas)  </li>
<li><strong>Conexión:</strong><br />
  Utiliza un administrador de conexiones configurado (<code>DWH_COMFENALCO_Destino</code>).</li>
</ul>
<hr />
<h4 id="flujo-general-del-proceso">Flujo General del Proceso<a class="headerlink" href="#flujo-general-del-proceso" title="Permanent link">&para;</a></h4>
<ol>
<li>
<p><strong>Extracción de Datos:</strong><br />
   Los datos se leen desde un archivo Excel mediante el componente <em>Excel Source</em>.</p>
</li>
<li>
<p><strong>Conversión y Transformación:</strong><br />
   Se aplican conversiones de datos (Data Conversion) y se crea un identificador único (<code>ID_PERSONAL_AUXILIAR</code>) mediante el componente <em>Derived Column</em>.</p>
</li>
<li>
<p><strong>Enriquecimiento con Lookup:</strong><br />
   El componente <em>Lookup</em> compara el <code>ID_PERSONAL_AUXILIAR</code> generado con la referencia de la dimensión existente para identificar registros nuevos o sin cambios.</p>
</li>
<li>
<p><strong>División Condicional:</strong><br />
   Mediante el <em>Conditional Split</em>, se enrutan los registros a la salida "Agregar" para aquellos registros nuevos (donde no se encontró coincidencia en la tabla de referencia) y "Sin Cambios" para los registros ya existentes.</p>
</li>
<li>
<p><strong>Carga de Datos:</strong><br />
   Finalmente, los registros identificados para agregación se cargan en la tabla <code>"Transversal"."DIM_PERSONAL"</code> a través del componente de destino ADO.NET.</p>
</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../../assets/mkdocs_pagetree_plugin.js"></script>
      
        <script src="../../js/init_mermaid.js"></script>
      
    
  </body>
</html>